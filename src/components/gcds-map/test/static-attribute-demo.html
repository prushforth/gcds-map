<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>GCDS Map Static Attribute Demo</title>
    <script type="module" src="/build/gcds-map.esm.js"></script>
    <style> 
      body {
        font-family: Arial, sans-serif;
        margin: 20px;
      }
      
      .demo-container {
        border: 1px solid #ccc;
        margin: 20px 0;
        padding: 20px;
      }
      
      gcds-map {
        width: 400px;
        height: 300px;
        border: 2px solid #333;
        display: block;
        margin: 10px 0;
      }
      
      button {
        margin: 5px;
        padding: 10px 15px;
        font-size: 14px;
      }
      
      .static-map {
        border-color: #d73527 !important;
      }
      
      .interactive-map {
        border-color: #28a745 !important;
      }
    </style>
  </head>
  <body>
    <h1>GCDS Map Static Attribute Demo</h1>
    
    <p>This demo shows how the <code>static</code> attribute can be used to disable map interactions.</p>
    
    <div class="demo-container">
      <h2>Test 1: Property Assignment</h2>
      <p><strong>Interactive Map (static=false):</strong> You can pan, zoom, and interact with this map.</p>
      <gcds-map id="map1" class="interactive-map" projection="CBMTILE" zoom="2" lat="45.398043" lon="-75.70683" controls>
        <map-layer label="CBMT" src="https://geoappext.nrcan.gc.ca/arcgis/rest/services/BaseMaps/CBMT3978/MapServer/" type="mapml"></map-layer>
      </gcds-map>
      
      <button onclick="toggleStatic('map1')">Toggle Static Mode</button>
      <button onclick="checkStatus('map1')">Check Status</button>
      
      <p id="status1">Status: Interactive</p>
    </div>
    
    <div class="demo-container">
      <h2>Test 2: HTML Attribute</h2>
      <p><strong>Static Map (static attribute set):</strong> This map has interactions disabled.</p>
      <gcds-map id="map2" class="static-map" static projection="CBMTILE" zoom="2" lat="45.398043" lon="-75.70683" controls>
        <map-layer label="CBMT" src="https://geoappext.nrcan.gc.ca/arcgis/rest/services/BaseMaps/CBMT3978/MapServer/" type="mapml"></map-layer>
      </gcds-map>
      
      <button onclick="removeStaticAttribute('map2')">Remove Static Attribute</button>
      <button onclick="addStaticAttribute('map2')">Add Static Attribute</button>
      
      <p id="status2">Status: Static</p>
    </div>

    <div class="demo-container">
      <h2>Test 3: Dynamic Control</h2>
      <p>Test both property and attribute assignment methods:</p>
      <gcds-map id="map3" class="interactive-map" projection="CBMTILE" zoom="2" lat="45.398043" lon="-75.70683" controls>
        <map-layer label="CBMT" src="https://geoappext.nrcan.gc.ca/arcgis/rest/services/BaseMaps/CBMT3978/MapServer/" type="mapml"></map-layer>
      </gcds-map>
      
      <button onclick="setStaticProperty('map3', true)">Set static=true (property)</button>
      <button onclick="setStaticProperty('map3', false)">Set static=false (property)</button>
      <button onclick="setStaticAttribute('map3', true)">Set static="" (attribute)</button>
      <button onclick="setStaticAttribute('map3', false)">Remove static (attribute)</button>
      
      <p id="status3">Status: Interactive</p>
    </div>

    <script>
      function toggleStatic(mapId) {
        const map = document.getElementById(mapId);
        map.static = !map.static;
        updateMapClass(mapId);
        checkStatus(mapId);
      }
      
      function removeStaticAttribute(mapId) {
        const map = document.getElementById(mapId);
        map.removeAttribute('static');
        updateMapClass(mapId);
        checkStatus(mapId);
      }
      
      function addStaticAttribute(mapId) {
        const map = document.getElementById(mapId);
        map.setAttribute('static', '');
        updateMapClass(mapId);
        checkStatus(mapId);
      }
      
      function setStaticProperty(mapId, value) {
        const map = document.getElementById(mapId);
        map.static = value;
        updateMapClass(mapId);
        checkStatus(mapId);
      }
      
      function setStaticAttribute(mapId, value) {
        const map = document.getElementById(mapId);
        if (value) {
          map.setAttribute('static', '');
        } else {
          map.removeAttribute('static');
        }
        updateMapClass(mapId);
        checkStatus(mapId);
      }
      
      function updateMapClass(mapId) {
        const map = document.getElementById(mapId);
        if (map.static) {
          map.classList.remove('interactive-map');
          map.classList.add('static-map');
        } else {
          map.classList.remove('static-map');
          map.classList.add('interactive-map');
        }
      }
      
      function checkStatus(mapId) {
        const map = document.getElementById(mapId);
        const statusEl = document.getElementById('status' + mapId.slice(-1));
        
        // Wait for map to be ready
        setTimeout(() => {
          try {
            const hasAttribute = map.hasAttribute('static');
            const propertyValue = map.static;
            const isDraggingEnabled = map._map && map._map.dragging._enabled;
            
            statusEl.innerHTML = `
              Status: ${propertyValue ? 'Static' : 'Interactive'}<br>
              HTML attribute: ${hasAttribute ? 'present' : 'absent'}<br>
              Property value: ${propertyValue}<br>
              Dragging enabled: ${isDraggingEnabled}
            `;
          } catch (e) {
            statusEl.innerHTML = `Status: Map not ready yet (${e.message})`;
          }
        }, 100);
      }
      
      // Initialize status display
      setTimeout(() => {
        checkStatus('map1');
        checkStatus('map2');  
        checkStatus('map3');
      }, 1000);
    </script>
  </body>
</html>