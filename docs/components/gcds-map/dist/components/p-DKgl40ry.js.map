{"file":"p-DKgl40ry.js","mappings":"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","names":["GridLayer","DomUtil","bounds","point"],"sources":["src/components/utils/mapml/layers/MapTileLayer.js"],"sourcesContent":["import { GridLayer, DomUtil, point, bounds } from 'leaflet';\nimport { Util } from '../Util.js';\n\n/**\n * Leaflet layer for handling map-tile elements\n * Extends GridLayer to create tiles based on map-tile elements\n *\n * Similar in intent to MapFeatureLayer, which is a receiver for\n * map-feature elements' leaflet layer object\n *\n * This layer will be inserted into the LayerGroup hosted by the <map-link> or\n * <map-layer> immediately after creation, so that its index within the _layers array of\n * that LayerGroup will be equal to its z-index within the LayerGroup's container\n *\n * <map-tile row=\"10\" col=\"12\" src=\"url1\"></map-tile>  LayerGroup._layers[0] <- each *set* of adjacent tiles\n * <map-tile row=\"11\" col=\"12\" src=\"url2\"></map-tile>  LayerGroup._layers[0] <- is a *single* MapTileLayer\n * <map-extent units=\"OSMTILE\" checked hidden> LayerGroup._layers[1] *each* <map-extent> is a LayerGroup of Templated*Layer.js\n * <map-feature id=\"a\"> LayerGroup._layers[2] <- each *set* of adjacent features\n * <map-feature id=\"b\"> LayerGroup._layers[2] <- is a single MapFeatureLayer FeatureGroup\n * <map-tile row=\"10\" col=\"12\" src=\"url3\"></map-tile>  LayerGroup._layers[3]\n * <map-tile row=\"11\" col=\"12\" src=\"url4\"></map-tile>  LayerGroup._layers[3]\n * <map-feature id=\"c\"> LayerGroup._layers[4]\n * <map-feature id=\"d\"> LayerGroup._layers[4]\n * and so on\n */\nexport var MapTileLayer = GridLayer.extend({\n  initialize: function (options) {\n    GridLayer.prototype.initialize.call(this, options);\n    this._mapTiles = options.mapTiles || [];\n    this._tileMap = {};\n    this._pendingTiles = {};\n    this._buildTileMap();\n    this._container = DomUtil.create('div', 'leaflet-layer');\n    if (options.zIndex) {\n      this._container.style.zIndex = options.zIndex;\n    }\n    DomUtil.addClass(this._container, 'mapml-static-tile-container');\n    // Store bounds for visibility checks\n    //    this.layerBounds = this._computeLayerBounds();\n    //    this.zoomBounds = this._computeZoomBounds();\n  },\n\n  getEvents: function () {\n    const events = GridLayer.prototype.getEvents\n      ? GridLayer.prototype.getEvents.call(this)\n      : {};\n\n    // Add our custom zoom change handler\n    events.zoomend = this._handleZoomChange;\n\n    return events;\n  },\n  onAdd: function (map) {\n    this.options.pane.appendChild(this._container);\n    // Call the parent method\n    GridLayer.prototype.onAdd.call(this, map);\n  },\n  onRemove: function (map) {\n    // Clean up pending tiles\n    this._pendingTiles = {};\n    // remove _container from the dom, but don't delete it\n    DomUtil.remove(this._container);\n  },\n  setZIndex: function (zIndex) {\n    this.options.zIndex = zIndex;\n    this._updateZIndex();\n\n    return this;\n  },\n  _updateZIndex: function () {\n    if (\n      this._container &&\n      this.options.zIndex !== undefined &&\n      this.options.zIndex !== null\n    ) {\n      this._container.style.zIndex = this.options.zIndex;\n    }\n  },\n\n  _handleZoomChange: function () {\n    // this is necessary for CBMTILE in particular, I think because\n    // Leaflet relies on Web Mercator powers of 2 inter-zoom tile relations\n    // to calculate what tiles to clean up/remove.  CBMTILE doesn't have that\n    // relationship between zoom levels /tiles.\n    //\n    // Force removal of all tiles that don't match current zoom\n    const currentZoom = this._map.getZoom();\n\n    for (const key in this._tiles) {\n      const coords = this._keyToTileCoords(key);\n      if (coords.z !== currentZoom) {\n        this._removeTile(key);\n      }\n    }\n  },\n  /**\n   * Adds a map-tile element to the layer\n   * @param {HTMLTileElement} mapTile - The map-tile element to add\n   */\n  addMapTile: function (mapTile) {\n    if (!this._mapTiles.includes(mapTile)) {\n      this._mapTiles.push(mapTile);\n      this._addToTileMap(mapTile);\n      this._updateBounds();\n      if (this._map) {\n        this.redraw();\n      }\n    }\n  },\n\n  /**\n   * Removes a map-tile element from the layer\n   * @param {HTMLTileElement} mapTile - The map-tile element to remove\n   */\n  removeMapTile: function (mapTile) {\n    const index = this._mapTiles.indexOf(mapTile);\n    if (index !== -1) {\n      this._mapTiles.splice(index, 1);\n      this._removeFromTileMap(mapTile);\n      this._updateBounds();\n      if (this._map) {\n        this.redraw();\n      }\n    }\n  },\n\n  /**\n   * Removes a map-tile element from the layer using specific coordinates\n   * Used when tile coordinates have changed and we need to remove based on old coordinates\n   * @param {HTMLTileElement} mapTile - The map-tile element to remove\n   * @param {Object} coords - The coordinates to use for removal {col, row, zoom}\n   */\n  removeMapTileAt: function (mapTile, coords) {\n    const index = this._mapTiles.indexOf(mapTile);\n    if (index !== -1) {\n      this._mapTiles.splice(index, 1);\n      this._removeFromTileMapAt(coords);\n      // Clean up bidirectional links using current tile reference\n      if (mapTile._tileDiv) {\n        mapTile._tileDiv._mapTile = null;\n        mapTile._tileDiv = null;\n      }\n      this._updateBounds();\n      if (this._map) {\n        this.redraw();\n      }\n    }\n  },\n\n  /**\n   * Checks if the layer is currently visible on the map\n   * @returns {boolean} - True if the layer is visible, false otherwise\n   */\n  isVisible: function () {\n    if (!this._map) return false;\n    if (!this.layerBounds) this._updateBounds();\n    // approach copied/refactored from MapFeatureLayer\n    let map = this._map,\n      mapZoom = map.getZoom(),\n      zoomBounds = this.zoomBounds,\n      layerBounds = this.layerBounds,\n      withinZoom =\n        mapZoom <= zoomBounds.maxZoom && mapZoom >= zoomBounds.minZoom;\n    return (\n      withinZoom &&\n      this._mapTiles &&\n      layerBounds &&\n      layerBounds.overlaps(\n        Util.pixelToPCRSBounds(\n          map.getPixelBounds(),\n          mapZoom,\n          map.options.projection\n        )\n      )\n    );\n  },\n\n  /**\n   * Overrides GridLayer createTile to use map-tile elements\n   * @param {Object} coords - Tile coordinates\n   * @param {Function} done - Callback to be called when the tile is ready, with error and tile element params\n   * @returns {HTMLElement} - The created tile element\n   */\n  createTile: function (coords, done) {\n    const tileKey = this._tileCoordsToKey(coords);\n    const tileSize = this.getTileSize();\n\n    // Create container element\n    const tileElement = document.createElement('div');\n    tileElement.setAttribute('col', coords.x);\n    tileElement.setAttribute('row', coords.y);\n    tileElement.setAttribute('zoom', coords.z);\n    DomUtil.addClass(tileElement, 'leaflet-tile');\n\n    // Set size\n    tileElement.style.width = tileSize.x + 'px';\n    tileElement.style.height = tileSize.y + 'px';\n\n    // Find matching tile in our map\n    const matchingTile = this._tileMap[tileKey];\n\n    if (matchingTile) {\n      // Create an image element with the src from the matching map-tile\n      const img = document.createElement('img');\n      img.src = matchingTile.src;\n      img.width = tileSize.x;\n      img.height = tileSize.y;\n      img.alt = '';\n      img.setAttribute('role', 'presentation');\n      // bidirectional link map-tile element and rendered div\n      tileElement._mapTile = matchingTile;\n      matchingTile._tileDiv = tileElement;\n\n      tileElement.appendChild(img);\n\n      // Add the loaded class manually to ensure tile is visible\n      DomUtil.addClass(tileElement, 'leaflet-tile-loaded');\n\n      // Call the done callback to signal that the tile is ready\n      done(null, tileElement);\n    } else {\n      // The tile might be added later, register a pending tile\n      if (!this._pendingTiles) {\n        this._pendingTiles = {};\n      }\n\n      // Store the tile element and done callback for later update\n      this._pendingTiles[tileKey] = {\n        element: tileElement,\n        done: done\n      };\n\n      // Don't call done yet - we'll call it when the map-tile is added\n    }\n\n    return tileElement;\n  },\n\n  /**\n   * Builds the tile map from the current map-tile elements\n   * @private\n   */\n  _buildTileMap: function () {\n    this._tileMap = {};\n    for (const mapTile of this._mapTiles) {\n      this._addToTileMap(mapTile);\n    }\n  },\n\n  /**\n   * Adds a map-tile element to the tile map\n   * @param {HTMLTileElement} mapTile - The map-tile element to add\n   * @private\n   */\n  _addToTileMap: function (mapTile) {\n    const tileKey = `${mapTile.col}:${mapTile.row}:${mapTile.zoom}`;\n    this._tileMap[tileKey] = mapTile;\n\n    // Check if this tile was requested but not available at that time\n    if (this._pendingTiles && this._pendingTiles[tileKey]) {\n      const pendingTile = this._pendingTiles[tileKey];\n      const tileElement = pendingTile.element;\n      const doneCallback = pendingTile.done;\n\n      // Create and append the image to the tile\n      const tileSize = this.getTileSize();\n      const img = document.createElement('img');\n      img.src = mapTile.src;\n      img.width = tileSize.x;\n      img.height = tileSize.y;\n      img.alt = '';\n      img.setAttribute('role', 'presentation');\n\n      // bidirectional link map-tile element and rendered div\n      tileElement._mapTile = mapTile;\n      mapTile._tileDiv = tileElement;\n\n      tileElement.appendChild(img);\n\n      // Add the loaded class manually to ensure tile is visible\n      DomUtil.addClass(tileElement, 'leaflet-tile-loaded');\n\n      // Call the done callback to signal that the tile is now ready\n      if (doneCallback) {\n        doneCallback(null, tileElement);\n      }\n\n      // Remove from pending tiles\n      delete this._pendingTiles[tileKey];\n    }\n  },\n  /**\n   * Removes a map-tile element from the tile map\n   * @param {HTMLTileElement} mapTile - The map-tile element to remove\n   * @private\n   */\n  _removeFromTileMap: function (mapTile) {\n    const tileKey = `${mapTile.col}:${mapTile.row}:${mapTile.zoom}`;\n    delete this._tileMap[tileKey];\n\n    // Clean up bidirectional links\n    if (mapTile._tileDiv) {\n      mapTile._tileDiv._mapTile = null;\n      mapTile._tileDiv = null;\n    }\n\n    // Also remove from pending tiles if it exists there\n    if (this._pendingTiles && this._pendingTiles[tileKey]) {\n      delete this._pendingTiles[tileKey];\n    }\n  },\n\n  /**\n   * Removes a tile from the tile map using specific coordinates\n   * @param {Object} coords - The coordinates {col, row, zoom}\n   * @private\n   */\n  _removeFromTileMapAt: function (coords) {\n    const tileKey = `${coords.col}:${coords.row}:${coords.zoom}`;\n    delete this._tileMap[tileKey];\n\n    // Also remove from pending tiles if it exists there\n    if (this._pendingTiles && this._pendingTiles[tileKey]) {\n      delete this._pendingTiles[tileKey];\n    }\n  },\n\n  /**\n   * Updates layer bounds when tiles are added or removed\n   * @private\n   */\n  _updateBounds: function () {\n    this.layerBounds = this._computeLayerBounds();\n    this.zoomBounds = this._computeZoomBounds();\n  },\n\n  /**\n   * Computes the layer bounds from all map-tile elements\n   * @returns {L.Bounds} - The computed layer bounds\n   * @private\n   */\n  _computeLayerBounds: function () {\n    if (this._mapTiles.length === 0) {\n      return bounds([0, 0], [0, 0]);\n    }\n\n    const tilesByZoom = {};\n    const projection = this.options.projection;\n    const tileSize = M[projection].options.crs.tile.bounds.max.x;\n\n    // Group tiles by zoom\n    for (const mapTile of this._mapTiles) {\n      const zoom = mapTile.zoom;\n\n      if (!tilesByZoom[zoom]) {\n        tilesByZoom[zoom] = [];\n      }\n\n      tilesByZoom[zoom].push({\n        x: mapTile.col,\n        y: mapTile.row,\n        z: zoom\n      });\n    }\n\n    // Calculate bounds for each zoom level\n    const layerBoundsByZoom = {};\n    for (const zoom in tilesByZoom) {\n      const tiles = tilesByZoom[zoom];\n      let pixelBounds = null;\n\n      for (const tile of tiles) {\n        const pixelX = tile.x * tileSize;\n        const pixelY = tile.y * tileSize;\n\n        if (!pixelBounds) {\n          pixelBounds = bounds(\n            point(pixelX, pixelY),\n            point(pixelX + tileSize, pixelY + tileSize)\n          );\n        } else {\n          pixelBounds.extend(point(pixelX, pixelY));\n          pixelBounds.extend(point(pixelX + tileSize, pixelY + tileSize));\n        }\n      }\n\n      if (pixelBounds) {\n        layerBoundsByZoom[zoom] = Util.pixelToPCRSBounds(\n          pixelBounds,\n          parseInt(zoom),\n          projection\n        );\n      }\n    }\n\n    // Combine all zoom level bounds\n    let combinedBounds = null;\n    for (const zoom in layerBoundsByZoom) {\n      if (!combinedBounds) {\n        // makes a clone of the bounds, including methods\n        combinedBounds = layerBoundsByZoom[zoom].pad(0);\n      } else {\n        combinedBounds.extend(layerBoundsByZoom[zoom].min);\n        combinedBounds.extend(layerBoundsByZoom[zoom].max);\n      }\n    }\n\n    return combinedBounds || bounds([0, 0], [0, 0]);\n  },\n\n  /**\n   * Computes zoom bounds from all map-tile elements\n   * @returns {Object} - The computed zoom bounds\n   * @private\n   */\n  _computeZoomBounds: function () {\n    const result = {\n      minZoom: Infinity,\n      maxZoom: -Infinity,\n      minNativeZoom: Infinity,\n      maxNativeZoom: -Infinity\n    };\n\n    if (this._mapTiles.length === 0) {\n      return {\n        minZoom: 0,\n        maxZoom: 22,\n        minNativeZoom: 0,\n        maxNativeZoom: 22\n      };\n    }\n\n    // Find min/max zoom from map-tile elements\n    for (const mapTile of this._mapTiles) {\n      const zoom = mapTile.zoom;\n      result.minNativeZoom = Math.min(result.minNativeZoom, zoom);\n      result.maxNativeZoom = Math.max(result.maxNativeZoom, zoom);\n    }\n\n    // Set min/max zoom based on native zoom\n    result.minZoom = result.minNativeZoom;\n    result.maxZoom = result.maxNativeZoom;\n\n    return result;\n  }\n});\n\nexport var mapTileLayer = function (options) {\n  return new MapTileLayer(options);\n};\n"],"version":3}