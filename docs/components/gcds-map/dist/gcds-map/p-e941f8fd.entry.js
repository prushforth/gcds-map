import{l as t,U as e,M as i,F as s,r,a as n}from"./p-PZrWUcjo.js";import"./p-C8xJJwPc.js";import{r as a}from"./p-EYVT9Efh.js";import{g as o}from"./p-B85MJLTf.js";var l=t.ImageOverlay.extend({initialize:function(e,i,s,r,n,a){this._container=n;this._url=e;this._location=i;this._size=t.point(s);this._angle=r;t.setOptions(this,a)},getEvents:function(){var t={viewreset:this._reset};if(this._zoomAnimated&&this._step<=1){t.zoomanim=this._animateZoom}return t},onAdd:function(e){this.on({load:this._onImageLoad});if(!this._image){this._initImage()}if(this.options.interactive){t.DomUtil.addClass(this._image,"leaflet-interactive");this.addInteractiveTarget(this._image)}this._container.appendChild(this._image);this._reset()},onRemove:function(){t.DomUtil.remove(this._image);if(this.options.interactive){this.removeInteractiveTarget(this._image)}},_onImageLoad:function(){if(!this._image){return}this._image.loaded=+new Date;this._updateOpacity()},_animateZoom:function(e){var i=this._map.getZoomScale(e.zoom),s=this._map.getPixelOrigin().add(this._location).multiplyBy(i).subtract(this._map._getNewPixelOrigin(e.center,e.zoom)).round();if(t.Browser.any3d){t.DomUtil.setTransform(this._image,s,i)}else{t.DomUtil.setPosition(this._image,s)}},_reset:function(e){var i=this._image,s=this._location,r=this._size;if(e&&this._step>1&&(this._overlayToRemove===undefined||this._url===this._overlayToRemove)){return}t.DomUtil.setPosition(i,s);i.style.width=r.x+"px";i.style.height=r.y+"px"},_updateOpacity:function(){if(!this._map){return}var e=+new Date,i=false;var s=this._image;var r=Math.min(1,(e-s.loaded)/200);t.DomUtil.setOpacity(s,r);if(r<1){i=true}if(i){t.Util.cancelAnimFrame(this._fadeFrame);this._fadeFrame=t.Util.requestAnimFrame(this._updateOpacity,this)}t.DomUtil.addClass(s,"leaflet-image-loaded")}});var h=function(t,e,i,s,r,n){return new l(t,e,i,s,r,n)};var f=t.Layer.extend({initialize:function(e,i){this._template=e;this._container=t.DomUtil.create("div","leaflet-layer");t.DomUtil.addClass(this._container,"mapml-image-container");this._linkEl=i.linkEl;this.zoomBounds=i.zoomBounds;this.extentBounds=i.extentBounds;delete i.zoomBounds;delete i.extentBounds;t.setOptions(this,t.extend(i,this._setUpExtentTemplateVars(e)))},getEvents:function(){var t={moveend:this._onMoveEnd,zoomstart:this._clearLayer};return t},onAdd:function(t){this._map=t;this.options.pane.appendChild(this._container);this.setZIndex(this.options.zIndex);this._onAdd()},redraw:function(){this._onMoveEnd()},isVisible:function(){let t=this._linkEl.getMapEl()._map;let i=t.getZoom();let s=e.pixelToPCRSBounds(t.getPixelBounds(),i,t.options.projection);return i<=this.zoomBounds.maxZoom&&i>=this.zoomBounds.minZoom&&this.extentBounds.overlaps(s)},_clearLayer:function(){let t=this._container.querySelectorAll("img");for(let e=0;e<t.length;e++){this._container.removeChild(t[e])}},_addImage:function(t,e,i){let s=this._map;let r=this._imageOverlay;let n=this.getImageUrl(t,e);let a=s.getSize();this._imageOverlay=h(n,i,a,0,this._container);this._imageOverlay._step=this._template.step;this._imageOverlay.addTo(s);if(r){this._imageOverlay._overlayToRemove=r._url;this._imageOverlay.on("load error",(function(){s.removeLayer(r)}))}},_scaleImage:function(e,i){let s=this;setTimeout((function(){if(!s._map)return;let r=s._template.step;let n=Math.floor(i/r)*r;let a=s._map.getZoomScale(i,n);let o=e.min.multiplyBy(a).subtract(s._map._getNewPixelOrigin(s._map.getCenter(),i)).round();t.DomUtil.setTransform(s._imageOverlay._image,o,a)}))},_onAdd:function(){let t=this._map.getZoom();let e=t;let i=this._template.step;if(t%i!==0)e=Math.floor(t/i)*i;let s=this._map.getPixelBounds(this._map.getCenter(),e);this._pixelOrigins={};this._pixelOrigins[e]=s.min;let r=this._map.getPixelBounds().min.subtract(this._map.getPixelOrigin());this._addImage(s,e,r);if(t!==e){this._scaleImage(s,t)}},_onMoveEnd:function(e){let i=this._map.getZoom();let s=this._map.options.mapEl._history;let r=s[s.length-1];let n=s[s.length-2];if(!n)n=r;let a=this._template.step;let o=Math.floor(i/a)*a;let l=this._map.getPixelBounds(this._map.getCenter(),o);if(a!=="1"&&(i+1)%a===0&&r.zoom===n.zoom-1){this._addImage(l,o,t.point(0,0));this._scaleImage(l,i)}else if(e&&i%a!==0){this._imageOverlay._overlayToRemove=this._imageOverlay._url;if(r.zoom!==n.zoom){this._addImage(l,o,t.point(0,0));this._pixelOrigins[o]=l.min;this._scaleImage(l,i)}else{let t=this._pixelOrigins[o];let e=l.min.subtract(t);if(this.getImageUrl(l,o)===this._imageOverlay._url)return;this._addImage(l,o,e);this._scaleImage(l,i)}}else{if(!this.isVisible){this._clearLayer();return}var h=this._map,f=h.getPixelBounds().min.subtract(h.getPixelOrigin());this._addImage(h.getPixelBounds(),i,f);this._pixelOrigins[i]=h.getPixelOrigin()}},setZIndex:function(t){this.options.zIndex=t;this._updateZIndex();return this},_updateZIndex:function(){if(this._container&&this.options.zIndex!==undefined&&this.options.zIndex!==null){this._container.style.zIndex=this.options.zIndex}},onRemove:function(e){t.DomUtil.remove(this._container);this._clearLayer()},getImageUrl:function(e,i){var s={};s[this.options.extent.width]=this._map.getSize().x;s[this.options.extent.height]=this._map.getSize().y;s[this.options.extent.bottom]=this._TCRSToPCRS(e.max,i).y;s[this.options.extent.left]=this._TCRSToPCRS(e.min,i).x;s[this.options.extent.top]=this._TCRSToPCRS(e.min,i).y;s[this.options.extent.right]=this._TCRSToPCRS(e.max,i).x;for(var r in this.options.extent){if(["width","height","left","right","top","bottom"].indexOf(r)<0){s[r]=this.options.extent[r]}}return t.Util.template(this._template.template,s)},_TCRSToPCRS:function(t,e){var i=this._map,s=i.options.crs,r=s.transformation.untransform(t,s.scale(e));return r},_setUpExtentTemplateVars:function(t){var e={extent:{}},i=t.values;for(var s=0;s<t.values.length;s++){var r=i[s].getAttribute("type"),n=i[s].getAttribute("units"),a=i[s].getAttribute("axis"),o=i[s].getAttribute("name"),l=i[s].getAttribute("position"),h=i[s].tagName.toLowerCase()==="map-select";if(r==="width"){e.extent.width=o}else if(r==="height"){e.extent.height=o}else if(r==="location"&&(n==="pcrs"||n==="gcrs")){switch(a){case"longitude":case"easting":if(l){if(l.match(/.*?-left/i)){e.extent.left=o}else if(l.match(/.*?-right/i)){e.extent.right=o}}break;case"latitude":case"northing":if(l){if(l.match(/top-.*?/i)){e.extent.top=o}else if(l.match(/bottom-.*?/i)){e.extent.bottom=o}}break}}else if(h){const t=i[s].htmlselect;e.extent[o]=function(){return t.value}}else{const t=i[s];e.extent[o]=function(){return t.getAttribute("value")}}}return e}});var c=function(t,e){return new f(t,e)};var u=t.TileLayer.extend({initialize:function(e,i){i.tms=e.tms;this.zoomBounds=Object.assign({},i.zoomBounds);t.extend(i,this.zoomBounds);t.setOptions(this,i);this._setUpTileTemplateVars(e);this._linkEl=i.linkEl;this.extentBounds=this.options.extentBounds;delete this.options.zoomBounds;delete this.options.extentBounds;this._template=e;this._initContainer();t.TileLayer.prototype.initialize.call(this,e.template,t.extend(i,{pane:this.options.pane}))},onAdd:function(e){this.options.pane.appendChild(this._container);t.TileLayer.prototype.onAdd.call(this,e);this._handleMoveEnd()},onRemove:function(){t.DomUtil.remove(this._container);for(let e of this._container.children){t.DomUtil.remove(e)}},getEvents:function(){let e=t.TileLayer.prototype.getEvents.call(this,this._map);this._parentOnMoveEnd=e.moveend;e.moveend=this._handleMoveEnd;return e},isVisible:function(){let t=this._linkEl.getMapEl()._map;let i=t.getZoom();let s=e.pixelToPCRSBounds(t.getPixelBounds(),i,t.options.projection);return i<=this.zoomBounds.maxZoom&&i>=this.zoomBounds.minZoom&&this.extentBounds.overlaps(s)},_initContainer:function(){if(this._container){return}this._container=t.DomUtil.create("div","leaflet-layer",this.options.pane);t.DomUtil.addClass(this._container,"mapml-templated-tile-container");this._updateZIndex()},_handleMoveEnd:function(t){if(!this.isVisible())return;this._parentOnMoveEnd()},createTile:function(e){let i=document.createElement("DIV"),s=this.getTileSize();t.DomUtil.addClass(i,"mapml-tile-group");t.DomUtil.addClass(i,"leaflet-tile");this._template.linkEl.dispatchEvent(new CustomEvent("tileloadstart",{detail:{x:e.x,y:e.y,zoom:e.z,appendTile:t=>{i.appendChild(t)}}}));if(this._template.type.startsWith("image/")){let r=t.TileLayer.prototype.createTile.call(this,e,(function(){}));r.width=s.x;r.height=s.y;i.appendChild(r)}else if(!this._url.includes(M.BLANK_TT_TREF)){this._fetchTile(e,i)}return i},_mapmlTileReady:function(e){t.DomUtil.addClass(e,"leaflet-tile-loaded")},getPane:function(){return this.options.pane},_fetchTile:function(t,e){let i=this.getTileUrl(t);if(i){fetch(i,{redirect:"follow"}).then((function(t){if(t.status>=200&&t.status<300){return Promise.resolve(t)}else{console.log("Looks like there was a problem. Status Code: "+t.status);return Promise.reject(t)}})).then((function(t){return t.text()})).then((t=>{var e=new DOMParser;return e.parseFromString(t,"application/xml")})).then((i=>{this._createFeatures(i,t,e);this._mapmlTileReady(e)})).catch((t=>{console.log("Error creating tile: "+t)}))}},_parseStylesheetAsHTML:function(t,e,i){if(!(i instanceof Element)||!t||!t.querySelector("map-link[rel=stylesheet],map-style"))return;if(e instanceof Element){e=e.getAttribute("href")?e.getAttribute("href"):document.URL}else if(!e||e===""||e instanceof Object){return}var s=[];var r=t.querySelectorAll("map-link[rel=stylesheet],map-style");for(var n=0;n<r.length;n++){if(r[n].nodeName.toUpperCase()==="MAP-LINK"){var a=r[n].hasAttribute("href")?new URL(r[n].getAttribute("href"),e).href:null;if(a){if(!i.querySelector("link[href='"+a+"']")){var o=document.createElement("link");f(r[n],o);o.setAttribute("href",a);s.push(o)}}}else{var l=document.createElement("style");f(r[n],l);l.textContent=r[n].textContent;s.push(l)}}for(var h=s.length-1;h>=0;h--){i.insertAdjacentElement("afterbegin",s[h])}function f(t,e){return Array.from(t.attributes).forEach((t=>{if(t.nodeName!=="href")e.setAttribute(t.nodeName,t.nodeValue)}))}},_createFeatures:function(r,n,a){let o=r.querySelector("map-link[rel=stylesheet],map-style");if(o){let t=r.querySelector("map-base")&&r.querySelector("map-base").hasAttribute("href")?new URL(r.querySelector("map-base").getAttribute("href")).href:r.URL;this._parseStylesheetAsHTML(r,t,a)}let l=t.SVG.create("svg"),h=t.SVG.create("g"),f=this._map.options.crs.options.crs.tile.bounds.max.x,c=n.x*f,u=n.y*f;let d=new i(null,{projection:this._map.options.projection,tiles:true,layerBounds:this.extentBounds,zoomBounds:this.zoomBounds,interactive:false,mapEl:this._linkEl.getMapEl()});let m=e.getNativeVariables(r);let b='[row="'+n.y+'"][col="'+n.x+'"][zoom="'+n.z+'"]';let w=r.querySelectorAll("map-feature:has(> map-geometry),map-tile"+b);for(let e=0;e<w.length;e++){if(w[e].nodeName==="map-feature"){let i=d.createGeometry(w[e],m.cs,n.z);for(let e in i._layers){let r=i._layers[e];s.prototype._initPath(r,false);r._project(this._map,t.point([c,u]),n.z);s.prototype._addPath(r,h,false);s.prototype._updateFeature(r)}}else{let i=w[e];const s=new Image;s.src=i.getAttribute("src");let r=t.SVG.create("image");r.setAttribute("href",s.src);h.appendChild(r)}}l.setAttribute("width",f.toString());l.setAttribute("height",f.toString());l.appendChild(h);a.appendChild(l)},getTileUrl:function(e){if(e.z>=this._template.tilematrix.bounds.length||!this._template.tilematrix.bounds[e.z].contains(e)){return""}var i={},s=this._template.linkEl,r=s.zoomInput;i[this._template.tilematrix.col.name]=e.x;i[this._template.tilematrix.row.name]=e.y;if(r&&s.hasAttribute("tref")&&s.getAttribute("tref").includes(`{${r.getAttribute("name")}}`)){i[this._template.zoom.name]=this._getZoomForUrl()}i[this._template.pcrs.easting.left]=this._tileMatrixToPCRSPosition(e,"top-left").x;i[this._template.pcrs.easting.right]=this._tileMatrixToPCRSPosition(e,"top-right").x;i[this._template.pcrs.northing.top]=this._tileMatrixToPCRSPosition(e,"top-left").y;i[this._template.pcrs.northing.bottom]=this._tileMatrixToPCRSPosition(e,"bottom-left").y;for(var n in this._template.tile){if(["row","col","zoom","left","right","top","bottom"].indexOf(n)<0){i[n]=this._template.tile[n]}}if(this._map&&!this._map.options.crs.infinite){let t=this._globalTileRange.max.y-e.y;if(this.options.tms){i[this._template.tilematrix.row.name]=t}}i.r=this.options.detectRetina&&t.Browser.retina&&this.options.maxZoom>0?"@2x":"";return t.Util.template(this._url,i)},_tileMatrixToPCRSPosition:function(e,i){var s=this._map,r=s.options.crs,n=this.getTileSize(),a=e.scaleBy(n),o=a.add(n),l=a.add(Math.floor(n/2)),h=r.transformation.untransform(a,r.scale(e.z)),f=r.transformation.untransform(o,r.scale(e.z)),c=r.transformation.untransform(l,r.scale(e.z)),u=null;switch(i){case"top-left":u=h;break;case"bottom-left":u=new t.Point(h.x,f.y);break;case"center-left":u=new t.Point(h.x,c.y);break;case"top-right":u=new t.Point(f.x,h.y);break;case"bottom-right":u=f;break;case"center-right":u=new t.Point(f.x,c.y);break;case"top-center":u=new t.Point(c.x,h.y);break;case"bottom-center":u=new t.Point(c.x,f.y);break;case"center":u=c;break}return u},_setUpTileTemplateVars:function(i){i.tile={};var s=i.values,r=this.options.crs.options,n,a,o,l;for(var h=0;h<i.values.length;h++){var f=s[h].getAttribute("type"),c=s[h].getAttribute("units"),u=s[h].getAttribute("axis"),d=s[h].getAttribute("name"),m=s[h].getAttribute("position"),b=s[h].tagName.toLowerCase()==="map-select";s[h].getAttribute("value");var w=s[h].getAttribute("min"),_=s[h].getAttribute("max");if(f==="location"&&c==="tilematrix"){switch(u){case"column":l={name:d,min:r.crs.tilematrix.horizontal.min,max:r.crs.tilematrix.horizontal.max(r.resolutions.length-1)};if(!isNaN(Number.parseFloat(w))){l.min=Number.parseFloat(w)}if(!isNaN(Number.parseFloat(_))){l.max=Number.parseFloat(_)}break;case"row":o={name:d,min:r.crs.tilematrix.vertical.min,max:r.crs.tilematrix.vertical.max(r.resolutions.length-1)};if(!isNaN(Number.parseFloat(w))){o.min=Number.parseFloat(w)}if(!isNaN(Number.parseFloat(_))){o.max=Number.parseFloat(_)}break;case"longitude":case"easting":if(!n){n={min:r.crs.pcrs.horizontal.min,max:r.crs.pcrs.horizontal.max}}if(!isNaN(Number.parseFloat(w))){n.min=Number.parseFloat(w)}if(!isNaN(Number.parseFloat(_))){n.max=Number.parseFloat(_)}if(m){if(m.match(/.*?-left/i)){n.left=d}else if(m.match(/.*?-right/i)){n.right=d}}break;case"latitude":case"northing":if(!a){a={min:r.crs.pcrs.vertical.min,max:r.crs.pcrs.vertical.max}}if(!isNaN(Number.parseFloat(w))){a.min=Number.parseFloat(w)}if(!isNaN(Number.parseFloat(_))){a.max=Number.parseFloat(_)}if(m){if(m.match(/top-.*?/i)){a.top=d}else if(m.match(/bottom-.*?/i)){a.bottom=d}}break}}else if(b){const t=s[h].htmlselect;i.tile[d]=function(){return t.value}}else if(f==="hidden"){const t=s[h];i.tile[d]=function(){return t.getAttribute("value")}}}var y=this.options.crs.transformation,p=this.options.crs.options.crs.tile.bounds.max.x,g=t.bind(this.options.crs.scale,this.options.crs),v=function(t,e){return y.transform(t,g(e)).divideBy(p).floor()};if(n&&a){i.pcrs={};i.pcrs.bounds=t.bounds([n.min,a.min],[n.max,a.max]);i.pcrs.easting=n;i.pcrs.northing=a}else if(l&&o&&!isNaN(i.zoom.initialValue)){if(!i.pcrs){i.pcrs={};i.pcrs.easting="";i.pcrs.northing=""}i.pcrs.bounds=e.boundsToPCRSBounds(t.bounds(t.point([l.min,o.min]),t.point([l.max,o.max])),i.zoom.initialValue,this.options.crs,e.axisToCS("column"));i.tilematrix={};i.tilematrix.col=l;i.tilematrix.row=o}if(!i.tilematrix){i.tilematrix={};i.tilematrix.col={};i.tilematrix.row={}}i.tilematrix.bounds=[];var x=i.pcrs.bounds;var k=this.options.minNativeZoom,M=this.options.maxNativeZoom;for(var z=0;z<=M;z++){i.tilematrix.bounds[z]=z>=k?t.bounds(v(x.min,z),v(x.max,z)):t.bounds(t.point([-1,-1]),t.point([-1,-1]))}},_clampZoom:function(e){let i=t.GridLayer.prototype._clampZoom.call(this,e);if(this._template.step>this.options.maxNativeZoom)this._template.step=this.options.maxNativeZoom;if(e!==i){e=i}else{if(e%this._template.step!==0){e=Math.floor(e/this._template.step)*this._template.step}}return e}});var d=function(t,e){return new u(t,e)};var m=t.LayerGroup.extend({initialize:function(e,i){t.LayerGroup.prototype.initialize.call(this,[]);this._template=e;this._container=t.DomUtil.create("div","leaflet-layer");t.DomUtil.addClass(this._container,"mapml-features-tiles-container");this.zoomBounds=i.zoomBounds;this.extentBounds=i.extentBounds;delete i.zoomBounds;delete i.extentBounds;this._linkEl=i.linkEl;t.setOptions(this,t.extend(i,this._setUpTemplateVars(e)))},onAdd:function(e){this._map=e;this.options.pane.appendChild(this._container);this._onMoveEnd();t.LayerGroup.prototype.onAdd.call(this,e)},onRemove:function(e){t.DomUtil.remove(this._container);for(let e of this._container.children){t.DomUtil.remove(e)}t.LayerGroup.prototype.onRemove.call(this,e)},getContainer:function(){return this._container},getEvents:function(){var t={moveend:this._onMoveEnd};return t},isVisible:function(){let t=this._linkEl.getMapEl()._map;let i=t.getZoom();let s=e.pixelToPCRSBounds(t.getPixelBounds(),i,t.options.projection);return i<=this.zoomBounds.maxZoom&&i>=this.zoomBounds.minZoom&&this.extentBounds.overlaps(s)},redraw:function(){this._onMoveEnd()},_onMoveEnd:function(){let e=this._map.options.mapEl._history;let i=e[e.length-1];let s=e[e.length-2]??i;let r=this._template.step;let n=this._map.getZoom();let a=n;if(r!=="1"&&(n+1)%r===0&&i.zoom===s.zoom-1||i.zoom===s.zoom||Math.floor(n/r)*r!==Math.floor(s.zoom/r)*r){a=Math.floor(n/r)*r}else if(n%this._template.step!==0)return;let o=this._map.getPixelBounds(this._map.getCenter(),a);const l=((e,i)=>{if(e===undefined)e=this._map.getZoom();if(i===undefined)i=this._map.getPixelBounds();const s=(t,e)=>{var i=this._map,s=i.options.crs,r=s.transformation.untransform(t,s.scale(e));return r};var r={};if(this.options.param.zoom){r[this.options.param.zoom]=e}if(this.options.param.width){r[this.options.param.width]=this._map.getSize().x}if(this.options.param.height){r[this.options.param.height]=this._map.getSize().y}if(this.options.param.bottom){r[this.options.param.bottom]=s(i.max,e).y}if(this.options.param.left){r[this.options.param.left]=s(i.min,e).x}if(this.options.param.top){r[this.options.param.top]=s(i.min,e).y}if(this.options.param.right){r[this.options.param.right]=s(i.max,e).x}for(var n in this.options.param){if(["width","height","left","right","top","bottom","zoom"].indexOf(n)<0){r[n]=this.options.param[n]}}return t.Util.template(this._template.template,r)}).bind(this);var h=l(a,o);this._url=h;this.clearLayers();if(this._linkEl.shadowRoot){this._linkEl.shadowRoot.innerHTML=""}const f=t=>{const e=t.querySelectorAll("link[rel=stylesheet],style");e.forEach((t=>t.remove()))};f(this._container);if(!this.isVisible()){this._url="";return}let c,u=new Headers({Accept:"text/mapml"}),d=this._linkEl,m=t=>fetch(t,{redirect:"follow",headers:u}).then((function(t){return t.text()})).then((function(t){let e=new DOMParser;c=e.parseFromString(t,"application/xml");let i=document.createDocumentFragment();const s=`\n                map-head > map-link,\n                map-body > map-link,\n                map-head > map-meta,\n                map-body > map-meta,\n                map-head > map-style,\n                map-body > map-style,\n                map-tile,\n                map-feature\n            `.trim();let r=c.querySelectorAll(s);for(let t=0;t<r.length;t++){i.appendChild(r[t])}d.shadowRoot.appendChild(i)}));const b=this._map;m(this._url).then((()=>{const t=d.shadowRoot.querySelectorAll("map-feature");const e=Array.from(t).map((t=>t.whenReady?t.whenReady():Promise.resolve()));Promise.all(e).then((()=>{b.fire("templatedfeatureslayeradd")}));this.eachLayer((function(t){if(t._path){if(t._path.getAttribute("d")!=="M0 0"){t._path.setAttribute("tabindex",0)}else{t._path.removeAttribute("tabindex")}if(t._path.childElementCount===0){let e=document.createElement("title");e.innerText=this._linkEl.getMapEl().locale.dfFeatureCaption;t._path.appendChild(e)}}}),this)})).catch((function(t){console.log(t)}))},_setUpTemplateVars:function(t){var e={param:{}},i=t.values;e.param.hidden=[];for(var s=0;s<i.length;s++){var r=i[s].getAttribute("type"),n=i[s].getAttribute("units"),a=i[s].getAttribute("axis"),o=i[s].getAttribute("name"),l=i[s].getAttribute("position");i[s].getAttribute("value");var h=i[s].tagName.toLowerCase()==="map-select";if(r==="width"){e.param.width=o}else if(r==="height"){e.param.height=o}else if(r==="zoom"){e.param.zoom=o}else if(r==="location"&&(n==="pcrs"||n==="gcrs")){switch(a){case"x":case"longitude":case"easting":if(l){if(l.match(/.*?-left/i)){e.param.left=o}else if(l.match(/.*?-right/i)){e.param.right=o}}break;case"y":case"latitude":case"northing":if(l){if(l.match(/top-.*?/i)){e.param.top=o}else if(l.match(/bottom-.*?/i)){e.param.bottom=o}}break}}else if(h){const t=i[s].htmlselect;e.param[o]=function(){return t.value}}else{const t=i[s];e.param[o]=function(){return t.getAttribute("value")}}}return e},renderStyles:a});var b=function(t,e){return new m(t,e)};function w(t,e){this.x=t;this.y=e}w.prototype={clone(){return new w(this.x,this.y)},add(t){return this.clone()._add(t)},sub(t){return this.clone()._sub(t)},multByPoint(t){return this.clone()._multByPoint(t)},divByPoint(t){return this.clone()._divByPoint(t)},mult(t){return this.clone()._mult(t)},div(t){return this.clone()._div(t)},rotate(t){return this.clone()._rotate(t)},rotateAround(t,e){return this.clone()._rotateAround(t,e)},matMult(t){return this.clone()._matMult(t)},unit(){return this.clone()._unit()},perp(){return this.clone()._perp()},round(){return this.clone()._round()},mag(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals(t){return this.x===t.x&&this.y===t.y},dist(t){return Math.sqrt(this.distSqr(t))},distSqr(t){const e=t.x-this.x,i=t.y-this.y;return e*e+i*i},angle(){return Math.atan2(this.y,this.x)},angleTo(t){return Math.atan2(this.y-t.y,this.x-t.x)},angleWith(t){return this.angleWithSep(t.x,t.y)},angleWithSep(t,e){return Math.atan2(this.x*e-this.y*t,this.x*t+this.y*e)},_matMult(t){const e=t[0]*this.x+t[1]*this.y,i=t[2]*this.x+t[3]*this.y;this.x=e;this.y=i;return this},_add(t){this.x+=t.x;this.y+=t.y;return this},_sub(t){this.x-=t.x;this.y-=t.y;return this},_mult(t){this.x*=t;this.y*=t;return this},_div(t){this.x/=t;this.y/=t;return this},_multByPoint(t){this.x*=t.x;this.y*=t.y;return this},_divByPoint(t){this.x/=t.x;this.y/=t.y;return this},_unit(){this._div(this.mag());return this},_perp(){const t=this.y;this.y=this.x;this.x=-t;return this},_rotate(t){const e=Math.cos(t),i=Math.sin(t),s=e*this.x-i*this.y,r=i*this.x+e*this.y;this.x=s;this.y=r;return this},_rotateAround(t,e){const i=Math.cos(t),s=Math.sin(t),r=e.x+i*(this.x-e.x)-s*(this.y-e.y),n=e.y+s*(this.x-e.x)+i*(this.y-e.y);this.x=r;this.y=n;return this},_round(){this.x=Math.round(this.x);this.y=Math.round(this.y);return this},constructor:w};w.convert=function(t){if(t instanceof w){return t}if(Array.isArray(t)){return new w(+t[0],+t[1])}if(t.x!==undefined&&t.y!==undefined){return new w(+t.x,+t.y)}throw new Error("Expected [x, y] or {x, y} point format")};function _(t,e,i){return Math.min(Math.max(t,i),e)}class y extends Error{constructor(t){super(`Failed to parse color: "${t}"`)}}var p=y;function g(t){if(typeof t!=="string")throw new p(t);if(t.trim().toLowerCase()==="transparent")return[0,0,0,0];let e=t.trim();e=E.test(t)?z(t):t;const i=T.exec(e);if(i){const t=Array.from(i).slice(1);return[...t.slice(0,3).map((t=>parseInt(j(t,2),16))),parseInt(j(t[3]||"f",2),16)/255]}const s=P.exec(e);if(s){const t=Array.from(s).slice(1);return[...t.slice(0,3).map((t=>parseInt(t,16))),parseInt(t[3]||"ff",16)/255]}const r=S.exec(e);if(r){const t=Array.from(r).slice(1);return[...t.slice(0,3).map((t=>parseInt(t,10))),parseFloat(t[3]||"1")]}const n=$.exec(e);if(n){const[e,i,s,r]=Array.from(n).slice(1).map(parseFloat);if(_(0,100,i)!==i)throw new p(t);if(_(0,100,s)!==s)throw new p(t);return[...C(e,i,s),Number.isNaN(r)?1:r]}throw new p(t)}function v(t){let e=5381;let i=t.length;while(i){e=e*33^t.charCodeAt(--i)}return(e>>>0)%2341}const x=t=>parseInt(t.replace(/_/g,""),36);const k="1q29ehhb 1n09sgk7 1kl1ekf_ _yl4zsno 16z9eiv3 1p29lhp8 _bd9zg04 17u0____ _iw9zhe5 _to73___ _r45e31e _7l6g016 _jh8ouiv _zn3qba8 1jy4zshs 11u87k0u 1ro9yvyo 1aj3xael 1gz9zjz0 _3w8l4xo 1bf1ekf_ _ke3v___ _4rrkb__ 13j776yz _646mbhl _nrjr4__ _le6mbhl 1n37ehkb _m75f91n _qj3bzfz 1939yygw 11i5z6x8 _1k5f8xs 1509441m 15t5lwgf _ae2th1n _tg1ugcv 1lp1ugcv 16e14up_ _h55rw7n _ny9yavn _7a11xb_ 1ih442g9 _pv442g9 1mv16xof 14e6y7tu 1oo9zkds 17d1cisi _4v9y70f _y98m8kc 1019pq0v 12o9zda8 _348j4f4 1et50i2o _8epa8__ _ts6senj 1o350i2o 1mi9eiuo 1259yrp0 1ln80gnw _632xcoy 1cn9zldc _f29edu4 1n490c8q _9f9ziet 1b94vk74 _m49zkct 1kz6s73a 1eu9dtog _q58s1rz 1dy9sjiq __u89jo3 _aj5nkwg _ld89jo3 13h9z6wx _qa9z2ii _l119xgq _bs5arju 1hj4nwk9 1qt4nwk9 1ge6wau6 14j9zlcw 11p1edc_ _ms1zcxe _439shk6 _jt9y70f _754zsow 1la40eju _oq5p___ _x279qkz 1fa5r3rv _yd2d9ip _424tcku _8y1di2_ _zi2uabw _yy7rn9h 12yz980_ __39ljp6 1b59zg0x _n39zfzp 1fy9zest _b33k___ _hp9wq92 1il50hz4 _io472ub _lj9z3eo 19z9ykg0 _8t8iu3a 12b9bl4a 1ak5yw0o _896v4ku _tb8k8lv _s59zi6t _c09ze0p 1lg80oqn 1id9z8wb _238nba5 1kq6wgdi _154zssg _tn3zk49 _da9y6tc 1sg7cv4f _r12jvtt 1gq5fmkz 1cs9rvci _lp9jn1c _xw1tdnb 13f9zje6 16f6973h _vo7ir40 _bt5arjf _rc45e4t _hr4e100 10v4e100 _hc9zke2 _w91egv_ _sj2r1kk 13c87yx8 _vqpds__ _ni8ggk8 _tj9yqfb 1ia2j4r4 _7x9b10u 1fc9ld4j 1eq9zldr _5j9lhpx _ez9zl6o _md61fzm".split(" ").reduce(((t,e)=>{const i=x(e.substring(0,3));const s=x(e.substring(3)).toString(16);let r="";for(let t=0;t<6-s.length;t++){r+="0"}t[i]=`${r}${s}`;return t}),{});function z(t){const e=t.toLowerCase().trim();const i=k[v(e)];if(!i)throw new p(t);return`#${i}`}const j=(t,e)=>Array.from(Array(e)).map((()=>t)).join("");const T=new RegExp(`^#${j("([a-f0-9])",3)}([a-f0-9])?$`,"i");const P=new RegExp(`^#${j("([a-f0-9]{2})",3)}([a-f0-9]{2})?$`,"i");const S=new RegExp(`^rgba?\\(\\s*(\\d+)\\s*${j(",\\s*(\\d+)\\s*",2)}(?:,\\s*([\\d.]+))?\\s*\\)$`,"i");const $=/^hsla?\(\s*([\d.]+)\s*,\s*([\d.]+)%\s*,\s*([\d.]+)%(?:\s*,\s*([\d.]+))?\s*\)$/i;const E=/^[a-z]+$/i;const A=t=>Math.round(t*255);const C=(t,e,i)=>{let s=i/100;if(e===0){return[s,s,s].map(A)}const r=(t%360+360)%360/60;const n=(1-Math.abs(2*s-1))*(e/100);const a=n*(1-Math.abs(r%2-1));let o=0;let l=0;let h=0;if(r>=0&&r<1){o=n;l=a}else if(r>=1&&r<2){o=a;l=n}else if(r>=2&&r<3){l=n;h=a}else if(r>=3&&r<4){l=a;h=n}else if(r>=4&&r<5){o=a;h=n}else if(r>=5&&r<6){o=n;h=a}const f=s-n/2;const c=o+f;const u=l+f;const d=h+f;return[c,u,d].map(A)};function I(t,e,i,s){return`rgba(${_(0,255,t).toFixed()}, ${_(0,255,e).toFixed()}, ${_(0,255,i).toFixed()}, ${parseFloat(_(0,1,s).toFixed(3))})`}function D(t,e,i){const s=(t,e)=>e===3?t:t/255;const[r,n,a,o]=g(t).map(s);const[l,h,f,c]=g(e).map(s);const u=c-o;const d=i*2-1;const m=d*u===-1?d:d+u/(1+d*u);const b=(m+1)/2;const w=1-b;const _=(r*w+l*b)*255;const y=(n*w+h*b)*255;const p=(a*w+f*b)*255;const v=c*i+o*(1-i);return I(_,y,p,v)}class F{constructor(t,e,i,s,r){this.properties={};this.extent=i;this.type=0;this.id=undefined;this._pbf=t;this._geometry=-1;this._keys=s;this._values=r;t.readFields(B,this,e)}loadGeometry(){const t=this._pbf;t.pos=this._geometry;const e=t.readVarint()+t.pos;const i=[];let s;let r=1;let n=0;let a=0;let o=0;while(t.pos<e){if(n<=0){const e=t.readVarint();r=e&7;n=e>>3}n--;if(r===1||r===2){a+=t.readSVarint();o+=t.readSVarint();if(r===1){if(s)i.push(s);s=[]}if(s)s.push(new w(a,o))}else if(r===7){if(s){s.push(s[0].clone())}}else{throw new Error(`unknown command ${r}`)}}if(s)i.push(s);return i}bbox(){const t=this._pbf;t.pos=this._geometry;const e=t.readVarint()+t.pos;let i=1,s=0,r=0,n=0,a=Infinity,o=-Infinity,l=Infinity,h=-Infinity;while(t.pos<e){if(s<=0){const e=t.readVarint();i=e&7;s=e>>3}s--;if(i===1||i===2){r+=t.readSVarint();n+=t.readSVarint();if(r<a)a=r;if(r>o)o=r;if(n<l)l=n;if(n>h)h=n}else if(i!==7){throw new Error(`unknown command ${i}`)}}return[a,l,o,h]}toGeoJSON(t,e,i){const s=this.extent*Math.pow(2,i),r=this.extent*t,n=this.extent*e,a=this.loadGeometry();function o(t){return[(t.x+r)*360/s-180,360/Math.PI*Math.atan(Math.exp((1-(t.y+n)*2/s)*Math.PI))-90]}function l(t){return t.map(o)}let h;if(this.type===1){const t=[];for(const e of a){t.push(e[0])}const e=l(t);h=t.length===1?{type:"Point",coordinates:e[0]}:{type:"MultiPoint",coordinates:e}}else if(this.type===2){const t=a.map(l);h=t.length===1?{type:"LineString",coordinates:t[0]}:{type:"MultiLineString",coordinates:t}}else if(this.type===3){const t=N(a);const e=[];for(const i of t){e.push(i.map(l))}h=e.length===1?{type:"Polygon",coordinates:e[0]}:{type:"MultiPolygon",coordinates:e}}else{throw new Error("unknown feature type")}const f={type:"Feature",geometry:h,properties:this.properties};if(this.id!=null){f.id=this.id}return f}}F.types=["Unknown","Point","LineString","Polygon"];function B(t,e,i){if(t===1)e.id=i.readVarint();else if(t===2)R(i,e);else if(t===3)e.type=i.readVarint();else if(t===4)e._geometry=i.pos}function R(t,e){const i=t.readVarint()+t.pos;while(t.pos<i){const i=e._keys[t.readVarint()];const s=e._values[t.readVarint()];e.properties[i]=s}}function N(t){const e=t.length;if(e<=1)return[t];const i=[];let s,r;for(let n=0;n<e;n++){const e=V(t[n]);if(e===0)continue;if(r===undefined)r=e<0;if(r===e<0){if(s)i.push(s);s=[t[n]]}else if(s){s.push(t[n])}}if(s)i.push(s);return i}function V(t){let e=0;for(let i=0,s=t.length,r=s-1,n,a;i<s;r=i++){n=t[i];a=t[r];e+=(a.x-n.x)*(n.y+a.y)}return e}class U{constructor(t,e){this.version=1;this.name="";this.extent=4096;this.length=0;this._pbf=t;this._keys=[];this._values=[];this._features=[];t.readFields(O,this,e);this.length=this._features.length}feature(t){if(t<0||t>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[t];const e=this._pbf.readVarint()+this._pbf.pos;return new F(this._pbf,e,this.extent,this._keys,this._values)}}function O(t,e,i){if(t===15)e.version=i.readVarint();else if(t===1)e.name=i.readString();else if(t===5)e.extent=i.readVarint();else if(t===2)e._features.push(i.pos);else if(t===3)e._keys.push(i.readString());else if(t===4)e._values.push(X(i))}function X(t){let e=null;const i=t.readVarint()+t.pos;while(t.pos<i){const i=t.readVarint()>>3;e=i===1?t.readString():i===2?t.readFloat():i===3?t.readDouble():i===4?t.readVarint64():i===5?t.readVarint():i===6?t.readSVarint():i===7?t.readBoolean():null}if(e==null){throw new Error("unknown feature value")}return e}class q{constructor(t,e){this.layers=t.readFields(Y,{},e)}}function Y(t,e,i){if(t===3){const t=new U(i,i.readVarint()+i.pos);if(t.length)e[t.name]=t}}const Z=(1<<16)*(1<<16);const H=1/Z;const G=12;const W=typeof TextDecoder==="undefined"?null:new TextDecoder("utf-8");const J=0;const K=1;const Q=2;const tt=5;class et{constructor(t=new Uint8Array(16)){this.buf=ArrayBuffer.isView(t)?t:new Uint8Array(t);this.dataView=new DataView(this.buf.buffer);this.pos=0;this.type=0;this.length=this.buf.length}readFields(t,e,i=this.length){while(this.pos<i){const i=this.readVarint(),s=i>>3,r=this.pos;this.type=i&7;t(s,e,this);if(this.pos===r)this.skip(i)}return e}readMessage(t,e){return this.readFields(t,e,this.readVarint()+this.pos)}readFixed32(){const t=this.dataView.getUint32(this.pos,true);this.pos+=4;return t}readSFixed32(){const t=this.dataView.getInt32(this.pos,true);this.pos+=4;return t}readFixed64(){const t=this.dataView.getUint32(this.pos,true)+this.dataView.getUint32(this.pos+4,true)*Z;this.pos+=8;return t}readSFixed64(){const t=this.dataView.getUint32(this.pos,true)+this.dataView.getInt32(this.pos+4,true)*Z;this.pos+=8;return t}readFloat(){const t=this.dataView.getFloat32(this.pos,true);this.pos+=4;return t}readDouble(){const t=this.dataView.getFloat64(this.pos,true);this.pos+=8;return t}readVarint(t){const e=this.buf;let i,s;s=e[this.pos++];i=s&127;if(s<128)return i;s=e[this.pos++];i|=(s&127)<<7;if(s<128)return i;s=e[this.pos++];i|=(s&127)<<14;if(s<128)return i;s=e[this.pos++];i|=(s&127)<<21;if(s<128)return i;s=e[this.pos];i|=(s&15)<<28;return it(i,t,this)}readVarint64(){return this.readVarint(true)}readSVarint(){const t=this.readVarint();return t%2===1?(t+1)/-2:t/2}readBoolean(){return Boolean(this.readVarint())}readString(){const t=this.readVarint()+this.pos;const e=this.pos;this.pos=t;if(t-e>=G&&W){return W.decode(this.buf.subarray(e,t))}return _t(this.buf,e,t)}readBytes(){const t=this.readVarint()+this.pos,e=this.buf.subarray(this.pos,t);this.pos=t;return e}readPackedVarint(t=[],e){const i=this.readPackedEnd();while(this.pos<i)t.push(this.readVarint(e));return t}readPackedSVarint(t=[]){const e=this.readPackedEnd();while(this.pos<e)t.push(this.readSVarint());return t}readPackedBoolean(t=[]){const e=this.readPackedEnd();while(this.pos<e)t.push(this.readBoolean());return t}readPackedFloat(t=[]){const e=this.readPackedEnd();while(this.pos<e)t.push(this.readFloat());return t}readPackedDouble(t=[]){const e=this.readPackedEnd();while(this.pos<e)t.push(this.readDouble());return t}readPackedFixed32(t=[]){const e=this.readPackedEnd();while(this.pos<e)t.push(this.readFixed32());return t}readPackedSFixed32(t=[]){const e=this.readPackedEnd();while(this.pos<e)t.push(this.readSFixed32());return t}readPackedFixed64(t=[]){const e=this.readPackedEnd();while(this.pos<e)t.push(this.readFixed64());return t}readPackedSFixed64(t=[]){const e=this.readPackedEnd();while(this.pos<e)t.push(this.readSFixed64());return t}readPackedEnd(){return this.type===Q?this.readVarint()+this.pos:this.pos+1}skip(t){const e=t&7;if(e===J)while(this.buf[this.pos++]>127){}else if(e===Q)this.pos=this.readVarint()+this.pos;else if(e===tt)this.pos+=4;else if(e===K)this.pos+=8;else throw new Error(`Unimplemented type: ${e}`)}writeTag(t,e){this.writeVarint(t<<3|e)}realloc(t){let e=this.length||16;while(e<this.pos+t)e*=2;if(e!==this.length){const t=new Uint8Array(e);t.set(this.buf);this.buf=t;this.dataView=new DataView(t.buffer);this.length=e}}finish(){this.length=this.pos;this.pos=0;return this.buf.subarray(0,this.length)}writeFixed32(t){this.realloc(4);this.dataView.setInt32(this.pos,t,true);this.pos+=4}writeSFixed32(t){this.realloc(4);this.dataView.setInt32(this.pos,t,true);this.pos+=4}writeFixed64(t){this.realloc(8);this.dataView.setInt32(this.pos,t&-1,true);this.dataView.setInt32(this.pos+4,Math.floor(t*H),true);this.pos+=8}writeSFixed64(t){this.realloc(8);this.dataView.setInt32(this.pos,t&-1,true);this.dataView.setInt32(this.pos+4,Math.floor(t*H),true);this.pos+=8}writeVarint(t){t=+t||0;if(t>268435455||t<0){rt(t,this);return}this.realloc(4);this.buf[this.pos++]=t&127|(t>127?128:0);if(t<=127)return;this.buf[this.pos++]=(t>>>=7)&127|(t>127?128:0);if(t<=127)return;this.buf[this.pos++]=(t>>>=7)&127|(t>127?128:0);if(t<=127)return;this.buf[this.pos++]=t>>>7&127}writeSVarint(t){this.writeVarint(t<0?-t*2-1:t*2)}writeBoolean(t){this.writeVarint(+t)}writeString(t){t=String(t);this.realloc(t.length*4);this.pos++;const e=this.pos;this.pos=yt(this.buf,t,this.pos);const i=this.pos-e;if(i>=128)ot(e,i,this);this.pos=e-1;this.writeVarint(i);this.pos+=i}writeFloat(t){this.realloc(4);this.dataView.setFloat32(this.pos,t,true);this.pos+=4}writeDouble(t){this.realloc(8);this.dataView.setFloat64(this.pos,t,true);this.pos+=8}writeBytes(t){const e=t.length;this.writeVarint(e);this.realloc(e);for(let i=0;i<e;i++)this.buf[this.pos++]=t[i]}writeRawMessage(t,e){this.pos++;const i=this.pos;t(e,this);const s=this.pos-i;if(s>=128)ot(i,s,this);this.pos=i-1;this.writeVarint(s);this.pos+=s}writeMessage(t,e,i){this.writeTag(t,Q);this.writeRawMessage(e,i)}writePackedVarint(t,e){if(e.length)this.writeMessage(t,lt,e)}writePackedSVarint(t,e){if(e.length)this.writeMessage(t,ht,e)}writePackedBoolean(t,e){if(e.length)this.writeMessage(t,ut,e)}writePackedFloat(t,e){if(e.length)this.writeMessage(t,ft,e)}writePackedDouble(t,e){if(e.length)this.writeMessage(t,ct,e)}writePackedFixed32(t,e){if(e.length)this.writeMessage(t,dt,e)}writePackedSFixed32(t,e){if(e.length)this.writeMessage(t,mt,e)}writePackedFixed64(t,e){if(e.length)this.writeMessage(t,bt,e)}writePackedSFixed64(t,e){if(e.length)this.writeMessage(t,wt,e)}writeBytesField(t,e){this.writeTag(t,Q);this.writeBytes(e)}writeFixed32Field(t,e){this.writeTag(t,tt);this.writeFixed32(e)}writeSFixed32Field(t,e){this.writeTag(t,tt);this.writeSFixed32(e)}writeFixed64Field(t,e){this.writeTag(t,K);this.writeFixed64(e)}writeSFixed64Field(t,e){this.writeTag(t,K);this.writeSFixed64(e)}writeVarintField(t,e){this.writeTag(t,J);this.writeVarint(e)}writeSVarintField(t,e){this.writeTag(t,J);this.writeSVarint(e)}writeStringField(t,e){this.writeTag(t,Q);this.writeString(e)}writeFloatField(t,e){this.writeTag(t,tt);this.writeFloat(e)}writeDoubleField(t,e){this.writeTag(t,K);this.writeDouble(e)}writeBooleanField(t,e){this.writeVarintField(t,+e)}}function it(t,e,i){const s=i.buf;let r,n;n=s[i.pos++];r=(n&112)>>4;if(n<128)return st(t,r,e);n=s[i.pos++];r|=(n&127)<<3;if(n<128)return st(t,r,e);n=s[i.pos++];r|=(n&127)<<10;if(n<128)return st(t,r,e);n=s[i.pos++];r|=(n&127)<<17;if(n<128)return st(t,r,e);n=s[i.pos++];r|=(n&127)<<24;if(n<128)return st(t,r,e);n=s[i.pos++];r|=(n&1)<<31;if(n<128)return st(t,r,e);throw new Error("Expected varint not more than 10 bytes")}function st(t,e,i){return i?e*4294967296+(t>>>0):(e>>>0)*4294967296+(t>>>0)}function rt(t,e){let i,s;if(t>=0){i=t%4294967296|0;s=t/4294967296|0}else{i=~(-t%4294967296);s=~(-t/4294967296);if(i^4294967295){i=i+1|0}else{i=0;s=s+1|0}}if(t>=0x10000000000000000||t<-0x10000000000000000){throw new Error("Given varint doesn't fit into 10 bytes")}e.realloc(10);nt(i,s,e);at(s,e)}function nt(t,e,i){i.buf[i.pos++]=t&127|128;t>>>=7;i.buf[i.pos++]=t&127|128;t>>>=7;i.buf[i.pos++]=t&127|128;t>>>=7;i.buf[i.pos++]=t&127|128;t>>>=7;i.buf[i.pos]=t&127}function at(t,e){const i=(t&7)<<4;e.buf[e.pos++]|=i|((t>>>=3)?128:0);if(!t)return;e.buf[e.pos++]=t&127|((t>>>=7)?128:0);if(!t)return;e.buf[e.pos++]=t&127|((t>>>=7)?128:0);if(!t)return;e.buf[e.pos++]=t&127|((t>>>=7)?128:0);if(!t)return;e.buf[e.pos++]=t&127|((t>>>=7)?128:0);if(!t)return;e.buf[e.pos++]=t&127}function ot(t,e,i){const s=e<=16383?1:e<=2097151?2:e<=268435455?3:Math.floor(Math.log(e)/(Math.LN2*7));i.realloc(s);for(let e=i.pos-1;e>=t;e--)i.buf[e+s]=i.buf[e]}function lt(t,e){for(let i=0;i<t.length;i++)e.writeVarint(t[i])}function ht(t,e){for(let i=0;i<t.length;i++)e.writeSVarint(t[i])}function ft(t,e){for(let i=0;i<t.length;i++)e.writeFloat(t[i])}function ct(t,e){for(let i=0;i<t.length;i++)e.writeDouble(t[i])}function ut(t,e){for(let i=0;i<t.length;i++)e.writeBoolean(t[i])}function dt(t,e){for(let i=0;i<t.length;i++)e.writeFixed32(t[i])}function mt(t,e){for(let i=0;i<t.length;i++)e.writeSFixed32(t[i])}function bt(t,e){for(let i=0;i<t.length;i++)e.writeFixed64(t[i])}function wt(t,e){for(let i=0;i<t.length;i++)e.writeSFixed64(t[i])}function _t(t,e,i){let s="";let r=e;while(r<i){const e=t[r];let n=null;let a=e>239?4:e>223?3:e>191?2:1;if(r+a>i)break;let o,l,h;if(a===1){if(e<128){n=e}}else if(a===2){o=t[r+1];if((o&192)===128){n=(e&31)<<6|o&63;if(n<=127){n=null}}}else if(a===3){o=t[r+1];l=t[r+2];if((o&192)===128&&(l&192)===128){n=(e&15)<<12|(o&63)<<6|l&63;if(n<=2047||n>=55296&&n<=57343){n=null}}}else if(a===4){o=t[r+1];l=t[r+2];h=t[r+3];if((o&192)===128&&(l&192)===128&&(h&192)===128){n=(e&15)<<18|(o&63)<<12|(l&63)<<6|h&63;if(n<=65535||n>=1114112){n=null}}}if(n===null){n=65533;a=1}else if(n>65535){n-=65536;s+=String.fromCharCode(n>>>10&1023|55296);n=56320|n&1023}s+=String.fromCharCode(n);r+=a}return s}function yt(t,e,i){for(let s=0,r,n;s<e.length;s++){r=e.charCodeAt(s);if(r>55295&&r<57344){if(n){if(r<56320){t[i++]=239;t[i++]=191;t[i++]=189;n=r;continue}else{r=n-55296<<10|r-56320|65536;n=null}}else{if(r>56319||s+1===e.length){t[i++]=239;t[i++]=191;t[i++]=189}else{n=r}continue}}else if(n){t[i++]=239;t[i++]=191;t[i++]=189;n=null}if(r<128){t[i++]=r}else{if(r<2048){t[i++]=r>>6|192}else{if(r<65536){t[i++]=r>>12|224}else{t[i++]=r>>18|240;t[i++]=r>>12&63|128}t[i++]=r>>6&63|128}t[i++]=r&63|128}}return i}var pt;var gt;function vt(){if(gt)return pt;gt=1;var t=Object.defineProperty;var e=Object.getOwnPropertyDescriptor;var i=Object.getOwnPropertyNames;var s=Object.prototype.hasOwnProperty;var r=Math.pow;var n=(e,i)=>{for(var s in i)t(e,s,{get:i[s],enumerable:true})};var a=(r,n,a,o)=>{if(n&&typeof n==="object"||typeof n==="function"){for(let l of i(n))if(!s.call(r,l)&&l!==a)t(r,l,{get:()=>n[l],enumerable:!(o=e(n,l))||o.enumerable})}return r};var o=e=>a(t({},"__esModule",{value:true}),e);var l=(t,e,i)=>new Promise(((s,r)=>{var n=t=>{try{o(i.next(t))}catch(t){r(t)}};var a=t=>{try{o(i.throw(t))}catch(t){r(t)}};var o=t=>t.done?s(t.value):Promise.resolve(t.value).then(n,a);o((i=i.apply(t,e)).next())}));var h={};n(h,{Compression:()=>kt,EtagMismatch:()=>It,FetchSource:()=>St,FileSource:()=>Pt,PMTiles:()=>Nt,Protocol:()=>ut,ResolvedValueCache:()=>Bt,SharedPromiseCache:()=>Rt,TileType:()=>zt,bytesToHeader:()=>Et,findTile:()=>Tt,getUint64:()=>$t,leafletRasterLayer:()=>ft,readVarint:()=>bt,tileIdToZxy:()=>xt,tileTypeExt:()=>jt,zxyToTileId:()=>vt});pt=o(h);var f=Uint8Array;var c=Uint16Array;var u=Int32Array;var d=new f([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]);var m=new f([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]);var b=new f([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);var w=function(t,e){var i=new c(31);for(var s=0;s<31;++s){i[s]=e+=1<<t[s-1]}var r=new u(i[30]);for(var s=1;s<30;++s){for(var n=i[s];n<i[s+1];++n){r[n]=n-i[s]<<5|s}}return{b:i,r}};var _=w(d,2);var y=_.b;var p=_.r;y[28]=258,p[258]=28;var g=w(m,0);var v=g.b;var x=new c(32768);for(M=0;M<32768;++M){k=(M&43690)>>1|(M&21845)<<1;k=(k&52428)>>2|(k&13107)<<2;k=(k&61680)>>4|(k&3855)<<4;x[M]=((k&65280)>>8|(k&255)<<8)>>1}var k;var M;var z=function(t,e,i){var s=t.length;var r=0;var n=new c(e);for(;r<s;++r){if(t[r])++n[t[r]-1]}var a=new c(e);for(r=1;r<e;++r){a[r]=a[r-1]+n[r-1]<<1}var o;{o=new c(1<<e);var l=15-e;for(r=0;r<s;++r){if(t[r]){var h=r<<4|t[r];var f=e-t[r];var u=a[t[r]-1]++<<f;for(var d=u|(1<<f)-1;u<=d;++u){o[x[u]>>l]=h}}}}return o};var j=new f(288);for(M=0;M<144;++M)j[M]=8;var M;for(M=144;M<256;++M)j[M]=9;var M;for(M=256;M<280;++M)j[M]=7;var M;for(M=280;M<288;++M)j[M]=8;var M;var T=new f(32);for(M=0;M<32;++M)T[M]=5;var M;var P=z(j,9);var S=z(T,5);var $=function(t){var e=t[0];for(var i=1;i<t.length;++i){if(t[i]>e)e=t[i]}return e};var E=function(t,e,i){var s=e/8|0;return(t[s]|t[s+1]<<8)>>(e&7)&i};var A=function(t,e){var i=e/8|0;return(t[i]|t[i+1]<<8|t[i+2]<<16)>>(e&7)};var C=function(t){return(t+7)/8|0};var I=function(t,e,i){if(i==null||i>t.length)i=t.length;var s=new f(i-e);s.set(t.subarray(e,i));return s};var D=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"];var F=function(t,e,i){var s=new Error(e||D[t]);s.code=t;if(Error.captureStackTrace)Error.captureStackTrace(s,F);if(!i)throw s;return s};var B=function(t,e,i,s){var r=t.length,n=0;if(!r||e.f&&!e.l)return i||new f(0);var a=!i||e.i!=2;var o=e.i;if(!i)i=new f(r*3);var l=function(t){var e=i.length;if(t>e){var s=new f(Math.max(e*2,t));s.set(i);i=s}};var h=e.f||0,c=e.p||0,u=e.b||0,w=e.l,_=e.d,p=e.m,g=e.n;var x=r*8;do{if(!w){h=E(t,c,1);var k=E(t,c+1,3);c+=3;if(!k){var M=C(c)+4,j=t[M-4]|t[M-3]<<8,L=M+j;if(L>r){if(o)F(0);break}if(a)l(u+j);i.set(t.subarray(M,L),u);e.b=u+=j,e.p=c=L*8,e.f=h;continue}else if(k==1)w=P,_=S,p=9,g=5;else if(k==2){var T=E(t,c,31)+257,D=E(t,c+10,15)+4;var B=T+E(t,c+5,31)+1;c+=14;var R=new f(B);var N=new f(19);for(var V=0;V<D;++V){N[b[V]]=E(t,c+V*3,7)}c+=D*3;var U=$(N),O=(1<<U)-1;var X=z(N,U);for(var V=0;V<B;){var q=X[E(t,c,O)];c+=q&15;var M=q>>4;if(M<16){R[V++]=M}else{var Y=0,Z=0;if(M==16)Z=3+E(t,c,3),c+=2,Y=R[V-1];else if(M==17)Z=3+E(t,c,7),c+=3;else if(M==18)Z=11+E(t,c,127),c+=7;while(Z--)R[V++]=Y}}var H=R.subarray(0,T),G=R.subarray(T);p=$(H);g=$(G);w=z(H,p);_=z(G,g)}else F(1);if(c>x){if(o)F(0);break}}if(a)l(u+131072);var W=(1<<p)-1,J=(1<<g)-1;var K=c;for(;;K=c){var Y=w[A(t,c)&W],Q=Y>>4;c+=Y&15;if(c>x){if(o)F(0);break}if(!Y)F(2);if(Q<256)i[u++]=Q;else if(Q==256){K=c,w=null;break}else{var tt=Q-254;if(Q>264){var V=Q-257,et=d[V];tt=E(t,c,(1<<et)-1)+y[V];c+=et}var it=_[A(t,c)&J],st=it>>4;if(!it)F(3);c+=it&15;var G=v[st];if(st>3){var et=m[st];G+=A(t,c)&(1<<et)-1,c+=et}if(c>x){if(o)F(0);break}if(a)l(u+131072);var rt=u+tt;if(u<G){var nt=n-G,at=Math.min(G,rt);if(nt+u<0)F(3);for(;u<at;++u)i[u]=s[nt+u]}for(;u<rt;u+=4){i[u]=i[u-G];i[u+1]=i[u+1-G];i[u+2]=i[u+2-G];i[u+3]=i[u+3-G]}u=rt}}e.l=w,e.p=K,e.b=u,e.f=h;if(w)h=1,e.m=p,e.d=_,e.n=g}while(!h);return u==i.length?i:I(i,0,u)};var R=new f(0);var N=function(t){if(t[0]!=31||t[1]!=139||t[2]!=8)F(6,"invalid gzip data");var e=t[3];var i=10;if(e&4)i+=(t[10]|t[11]<<8)+2;for(var s=(e>>3&1)+(e>>4&1);s>0;s-=!t[i++]);return i+(e&2)};var V=function(t){var e=t.length;return(t[e-4]|t[e-3]<<8|t[e-2]<<16|t[e-1]<<24)>>>0};var U=function(t,e){if((t[0]&15)!=8||t[0]>>4>7||(t[0]<<8|t[1])%31)F(6,"invalid zlib data");if((t[1]>>5&1)==1)F(6,"invalid zlib data: "+(t[1]&32?"need":"unexpected")+" dictionary");return(t[1]>>3&4)+2};function O(t,e){return B(t,{i:2},e,e)}function X(t,e){var i=N(t);if(i+8>t.length)F(6,"invalid gzip data");return B(t.subarray(i,-8),{i:2},new f(V(t)),e)}function q(t,e){return B(t.subarray(U(t),-4),{i:2},e,e)}function Y(t,e){return t[0]==31&&t[1]==139&&t[2]==8?X(t,e):(t[0]&15)!=8||t[0]>>4>7||(t[0]<<8|t[1])%31?O(t,e):q(t,e)}var Z=typeof TextDecoder!="undefined"&&new TextDecoder;try{Z.decode(R,{stream:true})}catch(t){}var H=(t,e)=>t*r(2,e);var G=(t,e)=>Math.floor(t/r(2,e));var W=(t,e)=>H(t.getUint16(e+1,true),8)+t.getUint8(e);var J=(t,e)=>H(t.getUint32(e+2,true),16)+t.getUint16(e,true);var K=(t,e,i,s,r)=>{if(t!==s.getUint8(r))return t-s.getUint8(r);const n=W(s,r+1);if(e!==n)return e-n;const a=W(s,r+4);if(i!==a)return i-a;return 0};var Q=(t,e,i,s)=>{const r=et(t,e|128,i,s);if(r){return{z:e,x:i,y:s,offset:r[0],length:r[1],isDir:true}}return null};var tt=(t,e,i,s)=>{const r=et(t,e,i,s);if(r){return{z:e,x:i,y:s,offset:r[0],length:r[1],isDir:false}}return null};var et=(t,e,i,s)=>{let r=0;let n=t.byteLength/17-1;while(r<=n){const a=n+r>>1;const o=K(e,i,s,t,a*17);if(o>0){r=a+1}else if(o<0){n=a-1}else{return[J(t,a*17+7),t.getUint32(a*17+13,true)]}}return null};var it=(t,e)=>{if(t.isDir&&!e.isDir){return 1}if(!t.isDir&&e.isDir){return-1}if(t.z!==e.z){return t.z-e.z}if(t.x!==e.x){return t.x-e.x}return t.y-e.y};var st=(t,e)=>{const i=t.getUint8(e*17);const s=i&127;return{z:s,x:W(t,e*17+1),y:W(t,e*17+4),offset:J(t,e*17+7),length:t.getUint32(e*17+13,true),isDir:i>>7===1}};var rt=t=>{const e=[];const i=new DataView(t);for(let t=0;t<i.byteLength/17;t++){e.push(st(i,t))}return nt(e)};var nt=t=>{t.sort(it);const e=new ArrayBuffer(17*t.length);const i=new Uint8Array(e);for(let e=0;e<t.length;e++){const s=t[e];let r=s.z;if(s.isDir)r=r|128;i[e*17]=r;i[e*17+1]=s.x&255;i[e*17+2]=s.x>>8&255;i[e*17+3]=s.x>>16&255;i[e*17+4]=s.y&255;i[e*17+5]=s.y>>8&255;i[e*17+6]=s.y>>16&255;i[e*17+7]=s.offset&255;i[e*17+8]=G(s.offset,8)&255;i[e*17+9]=G(s.offset,16)&255;i[e*17+10]=G(s.offset,24)&255;i[e*17+11]=G(s.offset,32)&255;i[e*17+12]=G(s.offset,48)&255;i[e*17+13]=s.length&255;i[e*17+14]=s.length>>8&255;i[e*17+15]=s.length>>16&255;i[e*17+16]=s.length>>24&255}return e};var at=(t,e)=>{if(t.byteLength<17)return null;const i=t.byteLength/17;const s=st(t,i-1);if(s.isDir){const t=s.z;const i=e.z-t;const r=Math.trunc(e.x/(1<<i));const n=Math.trunc(e.y/(1<<i));return{z:t,x:r,y:n}}return null};function ot(t){return l(this,null,(function*(){const e=yield t.getBytes(0,512e3);const i=new DataView(e.data);const s=i.getUint32(4,true);const r=i.getUint16(8,true);const n=new TextDecoder("utf-8");const a=JSON.parse(n.decode(new DataView(e.data,10,s)));let o=0;if(a.compression==="gzip"){o=2}let l=0;if("minzoom"in a){l=+a.minzoom}let h=0;if("maxzoom"in a){h=+a.maxzoom}let f=0;let c=0;let u=0;let d=-180;let m=-85;let b=180;let w=85;if(a.bounds){const t=a.bounds.split(",");d=+t[0];m=+t[1];b=+t[2];w=+t[3]}if(a.center){const t=a.center.split(",");f=+t[0];c=+t[1];u=+t[2]}const _={specVersion:i.getUint16(2,true),rootDirectoryOffset:10+s,rootDirectoryLength:r*17,jsonMetadataOffset:10,jsonMetadataLength:s,leafDirectoryOffset:0,leafDirectoryLength:void 0,tileDataOffset:0,tileDataLength:void 0,numAddressedTiles:0,numTileEntries:0,numTileContents:0,clustered:false,internalCompression:1,tileCompression:o,tileType:1,minZoom:l,maxZoom:h,minLon:d,minLat:m,maxLon:b,maxLat:w,centerZoom:u,centerLon:f,centerLat:c,etag:e.etag};return _}))}function lt(t,e,i,s,r,n,a){return l(this,null,(function*(){let o=yield i.getArrayBuffer(e,t.rootDirectoryOffset,t.rootDirectoryLength,t);if(t.specVersion===1){o=rt(o)}const l=tt(new DataView(o),s,r,n);if(l){const t=yield e.getBytes(l.offset,l.length,a);let i=t.data;const s=new DataView(i);if(s.getUint8(0)===31&&s.getUint8(1)===139){i=Y(new Uint8Array(i))}return{data:i}}const h=at(new DataView(o),{z:s,x:r,y:n});if(h){const l=Q(new DataView(o),h.z,h.x,h.y);if(l){let o=yield i.getArrayBuffer(e,l.offset,l.length,t);if(t.specVersion===1){o=rt(o)}const h=tt(new DataView(o),s,r,n);if(h){const t=yield e.getBytes(h.offset,h.length,a);let i=t.data;const s=new DataView(i);if(s.getUint8(0)===31&&s.getUint8(1)===139){i=Y(new Uint8Array(i))}return{data:i}}}}return void 0}))}var ht={getHeader:ot,getZxy:lt};var ft=(t,e)=>{let i=false;let s="";const r=L.GridLayer.extend({createTile:(e,r)=>{const n=document.createElement("img");const a=new AbortController;const o=a.signal;n.cancel=()=>{a.abort()};if(!i){t.getHeader().then((t=>{if(t.tileType===1){console.error("Error: archive contains MVT vector tiles, but leafletRasterLayer is for displaying raster tiles. See https://github.com/protomaps/PMTiles/tree/main/js for details.")}else if(t.tileType===2){s="image/png"}else if(t.tileType===3){s="image/jpeg"}else if(t.tileType===4){s="image/webp"}else if(t.tileType===5){s="image/avif"}}));i=true}t.getZxy(e.z,e.x,e.y,o).then((t=>{if(t){const e=new Blob([t.data],{type:s});const i=window.URL.createObjectURL(e);n.src=i;n.cancel=void 0;r(void 0,n)}})).catch((t=>{if(t.name!=="AbortError"){throw t}}));return n},_removeTile:function(t){const e=this._tiles[t];if(!e){return}if(e.el.cancel)e.el.cancel();e.el.width=0;e.el.height=0;e.el.deleted=true;L.DomUtil.remove(e.el);delete this._tiles[t];this.fire("tileunload",{tile:e.el,coords:this._keyToTileCoords(t)})}});return new r(e)};var ct=t=>(e,i)=>{if(i instanceof AbortController){return t(e,i)}const s=new AbortController;t(e,s).then((t=>i(void 0,t.data,t.cacheControl||"",t.expires||"")),(t=>i(t))).catch((t=>i(t)));return{cancel:()=>s.abort()}};var ut=class{constructor(t){this.tilev4=(t,e)=>l(this,null,(function*(){if(t.type==="json"){const e=t.url.substr(10);let i=this.tiles.get(e);if(!i){i=new Nt(e);this.tiles.set(e,i)}if(this.metadata){return{data:yield i.getTileJson(t.url)}}const s=yield i.getHeader();return{data:{tiles:[`${t.url}/{z}/{x}/{y}`],minzoom:s.minZoom,maxzoom:s.maxZoom,bounds:[s.minLon,s.minLat,s.maxLon,s.maxLat]}}}const i=new RegExp(/pmtiles:\/\/(.+)\/(\d+)\/(\d+)\/(\d+)/);const s=t.url.match(i);if(!s){throw new Error("Invalid PMTiles protocol URL")}const r=s[1];let n=this.tiles.get(r);if(!n){n=new Nt(r);this.tiles.set(r,n)}const a=s[2];const o=s[3];const l=s[4];const h=yield n.getHeader();const f=yield n==null?void 0:n.getZxy(+a,+o,+l,e.signal);if(f){return{data:new Uint8Array(f.data),cacheControl:f.cacheControl,expires:f.expires}}if(h.tileType===1){return{data:new Uint8Array}}return{data:null}}));this.tile=ct(this.tilev4);this.tiles=new Map;this.metadata=(t==null?void 0:t.metadata)||false}add(t){this.tiles.set(t.source.getKey(),t)}get(t){return this.tiles.get(t)}};function dt(t,e){return(e>>>0)*4294967296+(t>>>0)}function mt(t,e){const i=e.buf;let s=i[e.pos++];let r=(s&112)>>4;if(s<128)return dt(t,r);s=i[e.pos++];r|=(s&127)<<3;if(s<128)return dt(t,r);s=i[e.pos++];r|=(s&127)<<10;if(s<128)return dt(t,r);s=i[e.pos++];r|=(s&127)<<17;if(s<128)return dt(t,r);s=i[e.pos++];r|=(s&127)<<24;if(s<128)return dt(t,r);s=i[e.pos++];r|=(s&1)<<31;if(s<128)return dt(t,r);throw new Error("Expected varint not more than 10 bytes")}function bt(t){const e=t.buf;let i=e[t.pos++];let s=i&127;if(i<128)return s;i=e[t.pos++];s|=(i&127)<<7;if(i<128)return s;i=e[t.pos++];s|=(i&127)<<14;if(i<128)return s;i=e[t.pos++];s|=(i&127)<<21;if(i<128)return s;i=e[t.pos];s|=(i&15)<<28;return mt(s,t)}function wt(t,e,i,s){if(s===0){if(i===1){e[0]=t-1-e[0];e[1]=t-1-e[1]}const s=e[0];e[0]=e[1];e[1]=s}}function _t(t,e){const i=r(2,t);let s=e;let n=e;let a=e;const o=[0,0];let l=1;while(l<i){s=1&a/2;n=1&(a^s);wt(l,o,s,n);o[0]+=l*s;o[1]+=l*n;a=a/4;l*=2}return[t,o[0],o[1]]}var yt=[0,1,5,21,85,341,1365,5461,21845,87381,349525,1398101,5592405,22369621,89478485,357913941,1431655765,5726623061,22906492245,91625968981,366503875925,1466015503701,5864062014805,23456248059221,93824992236885,375299968947541,0x5555555555555];function vt(t,e,i){if(t>26){throw Error("Tile zoom level exceeds max safe number limit (26)")}if(e>r(2,t)-1||i>r(2,t)-1){throw Error("tile x/y outside zoom level bounds")}const s=yt[t];const n=r(2,t);let a=0;let o=0;let l=0;const h=[e,i];let f=n/2;while(f>0){a=(h[0]&f)>0?1:0;o=(h[1]&f)>0?1:0;l+=f*f*(3*a^o);wt(f,h,a,o);f=f/2}return s+l}function xt(t){let e=0;for(let i=0;i<27;i++){const s=(1<<i)*(1<<i);if(e+s>t){return _t(i,t-e)}e+=s}throw Error("Tile zoom level exceeds max safe number limit (26)")}var kt=(t=>{t[t["Unknown"]=0]="Unknown";t[t["None"]=1]="None";t[t["Gzip"]=2]="Gzip";t[t["Brotli"]=3]="Brotli";t[t["Zstd"]=4]="Zstd";return t})(kt||{});function Mt(t,e){return l(this,null,(function*(){if(e===1||e===0){return t}if(e===2){if(typeof globalThis.DecompressionStream==="undefined"){return Y(new Uint8Array(t))}const e=new Response(t).body;if(!e){throw Error("Failed to read response stream")}const i=e.pipeThrough(new globalThis.DecompressionStream("gzip"));return new Response(i).arrayBuffer()}throw Error("Compression method not supported")}))}var zt=(t=>{t[t["Unknown"]=0]="Unknown";t[t["Mvt"]=1]="Mvt";t[t["Png"]=2]="Png";t[t["Jpeg"]=3]="Jpeg";t[t["Webp"]=4]="Webp";t[t["Avif"]=5]="Avif";return t})(zt||{});function jt(t){if(t===1)return".mvt";if(t===2)return".png";if(t===3)return".jpg";if(t===4)return".webp";if(t===5)return".avif";return""}var Lt=127;function Tt(t,e){let i=0;let s=t.length-1;while(i<=s){const r=s+i>>1;const n=e-t[r].tileId;if(n>0){i=r+1}else if(n<0){s=r-1}else{return t[r]}}if(s>=0){if(t[s].runLength===0){return t[s]}if(e-t[s].tileId<t[s].runLength){return t[s]}}return null}var Pt=class{constructor(t){this.file=t}getKey(){return this.file.name}getBytes(t,e){return l(this,null,(function*(){const i=this.file.slice(t,t+e);const s=yield i.arrayBuffer();return{data:s}}))}};var St=class{constructor(t,e=new Headers){this.url=t;this.customHeaders=e;this.mustReload=false;let i="";if("navigator"in globalThis){i=globalThis.navigator.userAgent||""}const s=i.indexOf("Windows")>-1;const r=/Chrome|Chromium|Edg|OPR|Brave/.test(i);this.chromeWindowsNoCache=false;if(s&&r){this.chromeWindowsNoCache=true}}getKey(){return this.url}setHeaders(t){this.customHeaders=t}getBytes(t,e,i,s){return l(this,null,(function*(){let r;let n;if(i){n=i}else{r=new AbortController;n=r.signal}const a=new Headers(this.customHeaders);a.set("range",`bytes=${t}-${t+e-1}`);let o;if(this.mustReload){o="reload"}else if(this.chromeWindowsNoCache){o="no-store"}let l=yield fetch(this.url,{signal:n,cache:o,headers:a});if(t===0&&l.status===416){const t=l.headers.get("Content-Range");if(!t||!t.startsWith("bytes */")){throw Error("Missing content-length on 416 response")}const e=+t.substr(8);l=yield fetch(this.url,{signal:n,cache:"reload",headers:{range:`bytes=0-${e-1}`}})}let h=l.headers.get("Etag");if(h==null?void 0:h.startsWith("W/")){h=null}if(l.status===416||s&&h&&h!==s){this.mustReload=true;throw new It(`Server returned non-matching ETag ${s} after one retry. Check browser extensions and servers for issues that may affect correct ETag headers.`)}if(l.status>=300){throw Error(`Bad response code: ${l.status}`)}const f=l.headers.get("Content-Length");if(l.status===200&&(!f||+f>e)){if(r)r.abort();throw Error("Server returned no content-length header or content-length exceeding request. Check that your storage backend supports HTTP Byte Serving.")}const c=yield l.arrayBuffer();return{data:c,etag:h||void 0,cacheControl:l.headers.get("Cache-Control")||void 0,expires:l.headers.get("Expires")||void 0}}))}};function $t(t,e){const i=t.getUint32(e+4,true);const s=t.getUint32(e+0,true);return i*r(2,32)+s}function Et(t,e){const i=new DataView(t);const s=i.getUint8(7);if(s>3){throw Error(`Archive is spec version ${s} but this library supports up to spec version 3`)}return{specVersion:s,rootDirectoryOffset:$t(i,8),rootDirectoryLength:$t(i,16),jsonMetadataOffset:$t(i,24),jsonMetadataLength:$t(i,32),leafDirectoryOffset:$t(i,40),leafDirectoryLength:$t(i,48),tileDataOffset:$t(i,56),tileDataLength:$t(i,64),numAddressedTiles:$t(i,72),numTileEntries:$t(i,80),numTileContents:$t(i,88),clustered:i.getUint8(96)===1,internalCompression:i.getUint8(97),tileCompression:i.getUint8(98),tileType:i.getUint8(99),minZoom:i.getUint8(100),maxZoom:i.getUint8(101),minLon:i.getInt32(102,true)/1e7,minLat:i.getInt32(106,true)/1e7,maxLon:i.getInt32(110,true)/1e7,maxLat:i.getInt32(114,true)/1e7,centerZoom:i.getUint8(118),centerLon:i.getInt32(119,true)/1e7,centerLat:i.getInt32(123,true)/1e7,etag:e}}function At(t){const e={buf:new Uint8Array(t),pos:0};const i=bt(e);const s=[];let r=0;for(let t=0;t<i;t++){const t=bt(e);s.push({tileId:r+t,offset:0,length:0,runLength:1});r+=t}for(let t=0;t<i;t++){s[t].runLength=bt(e)}for(let t=0;t<i;t++){s[t].length=bt(e)}for(let t=0;t<i;t++){const i=bt(e);if(i===0&&t>0){s[t].offset=s[t-1].offset+s[t-1].length}else{s[t].offset=i-1}}return s}function Ct(t){const e=new DataView(t);if(e.getUint16(2,true)===2){console.warn("PMTiles spec version 2 has been deprecated; please see github.com/protomaps/PMTiles for tools to upgrade");return 2}if(e.getUint16(2,true)===1){console.warn("PMTiles spec version 1 has been deprecated; please see github.com/protomaps/PMTiles for tools to upgrade");return 1}return 3}var It=class extends Error{};function Dt(t,e){return l(this,null,(function*(){const i=yield t.getBytes(0,16384);const s=new DataView(i.data);if(s.getUint16(0,true)!==19792){throw new Error("Wrong magic number for PMTiles archive")}if(Ct(i.data)<3){return[yield ht.getHeader(t)]}const r=i.data.slice(0,Lt);const n=Et(r,i.etag);const a=i.data.slice(n.rootDirectoryOffset,n.rootDirectoryOffset+n.rootDirectoryLength);const o=`${t.getKey()}|${n.etag||""}|${n.rootDirectoryOffset}|${n.rootDirectoryLength}`;const l=At(yield e(a,n.internalCompression));return[n,[o,l.length,l]]}))}function Ft(t,e,i,s,r){return l(this,null,(function*(){const n=yield t.getBytes(i,s,void 0,r.etag);const a=yield e(n.data,r.internalCompression);const o=At(a);if(o.length===0){throw new Error("Empty directory is invalid")}return o}))}var Bt=class{constructor(t=100,e=true,i=Mt){this.cache=new Map;this.maxCacheEntries=t;this.counter=1;this.decompress=i}getHeader(t){return l(this,null,(function*(){const e=t.getKey();const i=this.cache.get(e);if(i){i.lastUsed=this.counter++;const t=i.data;return t}const s=yield Dt(t,this.decompress);if(s[1]){this.cache.set(s[1][0],{lastUsed:this.counter++,data:s[1][2]})}this.cache.set(e,{lastUsed:this.counter++,data:s[0]});this.prune();return s[0]}))}getDirectory(t,e,i,s){return l(this,null,(function*(){const r=`${t.getKey()}|${s.etag||""}|${e}|${i}`;const n=this.cache.get(r);if(n){n.lastUsed=this.counter++;const t=n.data;return t}const a=yield Ft(t,this.decompress,e,i,s);this.cache.set(r,{lastUsed:this.counter++,data:a});this.prune();return a}))}getArrayBuffer(t,e,i,s){return l(this,null,(function*(){const r=`${t.getKey()}|${s.etag||""}|${e}|${i}`;const n=this.cache.get(r);if(n){n.lastUsed=this.counter++;const t=yield n.data;return t}const a=yield t.getBytes(e,i,void 0,s.etag);this.cache.set(r,{lastUsed:this.counter++,data:a.data});this.prune();return a.data}))}prune(){if(this.cache.size>this.maxCacheEntries){let t=Infinity;let e=void 0;this.cache.forEach(((i,s)=>{if(i.lastUsed<t){t=i.lastUsed;e=s}}));if(e){this.cache.delete(e)}}}invalidate(t){return l(this,null,(function*(){this.cache.delete(t.getKey())}))}};var Rt=class{constructor(t=100,e=true,i=Mt){this.cache=new Map;this.invalidations=new Map;this.maxCacheEntries=t;this.counter=1;this.decompress=i}getHeader(t){return l(this,null,(function*(){const e=t.getKey();const i=this.cache.get(e);if(i){i.lastUsed=this.counter++;const t=yield i.data;return t}const s=new Promise(((e,i)=>{Dt(t,this.decompress).then((t=>{if(t[1]){this.cache.set(t[1][0],{lastUsed:this.counter++,data:Promise.resolve(t[1][2])})}e(t[0]);this.prune()})).catch((t=>{i(t)}))}));this.cache.set(e,{lastUsed:this.counter++,data:s});return s}))}getDirectory(t,e,i,s){return l(this,null,(function*(){const r=`${t.getKey()}|${s.etag||""}|${e}|${i}`;const n=this.cache.get(r);if(n){n.lastUsed=this.counter++;const t=yield n.data;return t}const a=new Promise(((r,n)=>{Ft(t,this.decompress,e,i,s).then((t=>{r(t);this.prune()})).catch((t=>{n(t)}))}));this.cache.set(r,{lastUsed:this.counter++,data:a});return a}))}getArrayBuffer(t,e,i,s){return l(this,null,(function*(){const r=`${t.getKey()}|${s.etag||""}|${e}|${i}`;const n=this.cache.get(r);if(n){n.lastUsed=this.counter++;const t=yield n.data;return t}const a=new Promise(((n,a)=>{t.getBytes(e,i,void 0,s.etag).then((t=>{n(t.data);if(this.cache.has(r));this.prune()})).catch((t=>{a(t)}))}));this.cache.set(r,{lastUsed:this.counter++,data:a});return a}))}prune(){if(this.cache.size>=this.maxCacheEntries){let t=Infinity;let e=void 0;this.cache.forEach(((i,s)=>{if(i.lastUsed<t){t=i.lastUsed;e=s}}));if(e){this.cache.delete(e)}}}invalidate(t){return l(this,null,(function*(){const e=t.getKey();if(this.invalidations.get(e)){return yield this.invalidations.get(e)}this.cache.delete(t.getKey());const i=new Promise(((i,s)=>{this.getHeader(t).then((t=>{i();this.invalidations.delete(e)})).catch((t=>{s(t)}))}));this.invalidations.set(e,i)}))}};var Nt=class{constructor(t,e,i){if(typeof t==="string"){this.source=new St(t)}else{this.source=t}if(i){this.decompress=i}else{this.decompress=Mt}if(e){this.cache=e}else{this.cache=new Rt}}getHeader(){return l(this,null,(function*(){return yield this.cache.getHeader(this.source)}))}getZxyAttempt(t,e,i,s){return l(this,null,(function*(){const r=vt(t,e,i);const n=yield this.cache.getHeader(this.source);if(n.specVersion<3){return ht.getZxy(n,this.source,this.cache,t,e,i,s)}if(t<n.minZoom||t>n.maxZoom){return void 0}let a=n.rootDirectoryOffset;let o=n.rootDirectoryLength;for(let t=0;t<=3;t++){const t=yield this.cache.getDirectory(this.source,a,o,n);const e=Tt(t,r);if(e){if(e.runLength>0){const t=yield this.source.getBytes(n.tileDataOffset+e.offset,e.length,s,n.etag);return{data:yield this.decompress(t.data,n.tileCompression),cacheControl:t.cacheControl,expires:t.expires}}a=n.leafDirectoryOffset+e.offset;o=e.length}else{return void 0}}throw Error("Maximum directory depth exceeded")}))}getZxy(t,e,i,s){return l(this,null,(function*(){try{return yield this.getZxyAttempt(t,e,i,s)}catch(r){if(r instanceof It){this.cache.invalidate(this.source);return yield this.getZxyAttempt(t,e,i,s)}throw r}}))}getMetadataAttempt(){return l(this,null,(function*(){const t=yield this.cache.getHeader(this.source);const e=yield this.source.getBytes(t.jsonMetadataOffset,t.jsonMetadataLength,void 0,t.etag);const i=yield this.decompress(e.data,t.internalCompression);const s=new TextDecoder("utf-8");return JSON.parse(s.decode(i))}))}getMetadata(){return l(this,null,(function*(){try{return yield this.getMetadataAttempt()}catch(t){if(t instanceof It){this.cache.invalidate(this.source);return yield this.getMetadataAttempt()}throw t}}))}getTileJson(t){return l(this,null,(function*(){const e=yield this.getHeader();const i=yield this.getMetadata();const s=jt(e.tileType);return{tilejson:"3.0.0",scheme:"xyz",tiles:[`${t}/{z}/{x}/{y}${s}`],vector_layers:i.vector_layers,attribution:i.attribution,description:i.description,name:i.name,version:i.version,bounds:[e.minLon,e.minLat,e.maxLon,e.maxLat],center:[e.centerLon,e.centerLat,e.centerZoom],minzoom:e.minZoom,maxzoom:e.maxZoom}}))}};return pt}var xt=vt();var kt={exports:{}};var Mt=kt.exports;var zt;function jt(){if(zt)return kt.exports;zt=1;(function(t,e){!function(e,i){t.exports=i()}(Mt,(function(){function t(t,s,r,n,a){!function t(i,s,r,n,a){for(;n>r;){if(n-r>600){var o=n-r+1,l=s-r+1,h=Math.log(o),f=.5*Math.exp(2*h/3),c=.5*Math.sqrt(h*f*(o-f)/o)*(l-o/2<0?-1:1),u=Math.max(r,Math.floor(s-l*f/o+c)),d=Math.min(n,Math.floor(s+(o-l)*f/o+c));t(i,s,u,d,a)}var m=i[s],b=r,w=n;for(e(i,r,s),a(i[n],m)>0&&e(i,r,n);b<w;){for(e(i,b,w),b++,w--;a(i[b],m)<0;)b++;for(;a(i[w],m)>0;)w--}0===a(i[r],m)?e(i,r,w):e(i,++w,n),w<=s&&(r=w+1),s<=w&&(n=w-1)}}(t,s,r||0,n||t.length-1,a||i)}function e(t,e,i){var s=t[e];t[e]=t[i],t[i]=s}function i(t,e){return t<e?-1:t>e?1:0}var s=function(t){void 0===t&&(t=9),this._maxEntries=Math.max(4,t),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()};function r(t,e,i){if(!i)return e.indexOf(t);for(var s=0;s<e.length;s++)if(i(t,e[s]))return s;return-1}function n(t,e){a(t,0,t.children.length,e,t)}function a(t,e,i,s,r){r||(r=m(null)),r.minX=1/0,r.minY=1/0,r.maxX=-1/0,r.maxY=-1/0;for(var n=e;n<i;n++){var a=t.children[n];o(r,t.leaf?s(a):a)}return r}function o(t,e){return t.minX=Math.min(t.minX,e.minX),t.minY=Math.min(t.minY,e.minY),t.maxX=Math.max(t.maxX,e.maxX),t.maxY=Math.max(t.maxY,e.maxY),t}function l(t,e){return t.minX-e.minX}function h(t,e){return t.minY-e.minY}function f(t){return(t.maxX-t.minX)*(t.maxY-t.minY)}function c(t){return t.maxX-t.minX+(t.maxY-t.minY)}function u(t,e){return t.minX<=e.minX&&t.minY<=e.minY&&e.maxX<=t.maxX&&e.maxY<=t.maxY}function d(t,e){return e.minX<=t.maxX&&e.minY<=t.maxY&&e.maxX>=t.minX&&e.maxY>=t.minY}function m(t){return{children:t,height:1,leaf:true,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function b(e,i,s,r,n){for(var a=[i,s];a.length;)if(!((s=a.pop())-(i=a.pop())<=r)){var o=i+Math.ceil((s-i)/r/2)*r;t(e,o,i,s,n),a.push(i,o,o,s)}}return s.prototype.all=function(){return this._all(this.data,[])},s.prototype.search=function(t){var e=this.data,i=[];if(!d(t,e))return i;for(var s=this.toBBox,r=[];e;){for(var n=0;n<e.children.length;n++){var a=e.children[n],o=e.leaf?s(a):a;d(t,o)&&(e.leaf?i.push(a):u(t,o)?this._all(a,i):r.push(a))}e=r.pop()}return i},s.prototype.collides=function(t){var e=this.data;if(!d(t,e))return false;for(var i=[];e;){for(var s=0;s<e.children.length;s++){var r=e.children[s],n=e.leaf?this.toBBox(r):r;if(d(t,n)){if(e.leaf||u(t,n))return true;i.push(r)}}e=i.pop()}return false},s.prototype.load=function(t){if(!t||!t.length)return this;if(t.length<this._minEntries){for(var e=0;e<t.length;e++)this.insert(t[e]);return this}var i=this._build(t.slice(),0,t.length-1,0);if(this.data.children.length)if(this.data.height===i.height)this._splitRoot(this.data,i);else{if(this.data.height<i.height){var s=this.data;this.data=i,i=s}this._insert(i,this.data.height-i.height-1,true)}else this.data=i;return this},s.prototype.insert=function(t){return t&&this._insert(t,this.data.height-1),this},s.prototype.clear=function(){return this.data=m([]),this},s.prototype.remove=function(t,e){if(!t)return this;for(var i,s,n,a=this.data,o=this.toBBox(t),l=[],h=[];a||l.length;){if(a||(a=l.pop(),s=l[l.length-1],i=h.pop(),n=true),a.leaf){var f=r(t,a.children,e);if(-1!==f)return a.children.splice(f,1),l.push(a),this._condense(l),this}n||a.leaf||!u(a,o)?s?(i++,a=s.children[i],n=false):a=null:(l.push(a),h.push(i),i=0,s=a,a=a.children[0])}return this},s.prototype.toBBox=function(t){return t},s.prototype.compareMinX=function(t,e){return t.minX-e.minX},s.prototype.compareMinY=function(t,e){return t.minY-e.minY},s.prototype.toJSON=function(){return this.data},s.prototype.fromJSON=function(t){return this.data=t,this},s.prototype._all=function(t,e){for(var i=[];t;)t.leaf?e.push.apply(e,t.children):i.push.apply(i,t.children),t=i.pop();return e},s.prototype._build=function(t,e,i,s){var r,a=i-e+1,o=this._maxEntries;if(a<=o)return n(r=m(t.slice(e,i+1)),this.toBBox),r;s||(s=Math.ceil(Math.log(a)/Math.log(o)),o=Math.ceil(a/Math.pow(o,s-1))),(r=m([])).leaf=false,r.height=s;var l=Math.ceil(a/o),h=l*Math.ceil(Math.sqrt(o));b(t,e,i,h,this.compareMinX);for(var f=e;f<=i;f+=h){var c=Math.min(f+h-1,i);b(t,f,c,l,this.compareMinY);for(var u=f;u<=c;u+=l){var d=Math.min(u+l-1,c);r.children.push(this._build(t,u,d,s-1))}}return n(r,this.toBBox),r},s.prototype._chooseSubtree=function(t,e,i,s){for(;s.push(e),!e.leaf&&s.length-1!==i;){for(var r=1/0,n=1/0,a=void 0,o=0;o<e.children.length;o++){var l=e.children[o],h=f(l),c=(u=t,d=l,(Math.max(d.maxX,u.maxX)-Math.min(d.minX,u.minX))*(Math.max(d.maxY,u.maxY)-Math.min(d.minY,u.minY))-h);c<n?(n=c,r=h<r?h:r,a=l):c===n&&h<r&&(r=h,a=l)}e=a||e.children[0]}var u,d;return e},s.prototype._insert=function(t,e,i){var s=i?t:this.toBBox(t),r=[],n=this._chooseSubtree(s,this.data,e,r);for(n.children.push(t),o(n,s);e>=0&&r[e].children.length>this._maxEntries;)this._split(r,e),e--;this._adjustParentBBoxes(s,r,e)},s.prototype._split=function(t,e){var i=t[e],s=i.children.length,r=this._minEntries;this._chooseSplitAxis(i,r,s);var a=this._chooseSplitIndex(i,r,s),o=m(i.children.splice(a,i.children.length-a));o.height=i.height,o.leaf=i.leaf,n(i,this.toBBox),n(o,this.toBBox),e?t[e-1].children.push(o):this._splitRoot(i,o)},s.prototype._splitRoot=function(t,e){this.data=m([t,e]),this.data.height=t.height+1,this.data.leaf=false,n(this.data,this.toBBox)},s.prototype._chooseSplitIndex=function(t,e,i){for(var s,r,n,o,l,h,c,u=1/0,d=1/0,m=e;m<=i-e;m++){var b=a(t,0,m,this.toBBox),w=a(t,m,i,this.toBBox),_=(r=b,n=w,o=void 0,l=void 0,h=void 0,c=void 0,o=Math.max(r.minX,n.minX),l=Math.max(r.minY,n.minY),h=Math.min(r.maxX,n.maxX),c=Math.min(r.maxY,n.maxY),Math.max(0,h-o)*Math.max(0,c-l)),y=f(b)+f(w);_<u?(u=_,s=m,d=y<d?y:d):_===u&&y<d&&(d=y,s=m)}return s||i-e},s.prototype._chooseSplitAxis=function(t,e,i){var s=t.leaf?this.compareMinX:l,r=t.leaf?this.compareMinY:h;this._allDistMargin(t,e,i,s)<this._allDistMargin(t,e,i,r)&&t.children.sort(s)},s.prototype._allDistMargin=function(t,e,i,s){t.children.sort(s);for(var r=this.toBBox,n=a(t,0,e,r),l=a(t,i-e,i,r),h=c(n)+c(l),f=e;f<i-e;f++){var u=t.children[f];o(n,t.leaf?r(u):u),h+=c(n)}for(var d=i-e-1;d>=e;d--){var m=t.children[d];o(l,t.leaf?r(m):m),h+=c(l)}return h},s.prototype._adjustParentBBoxes=function(t,e,i){for(var s=i;s>=0;s--)o(e[s],t)},s.prototype._condense=function(t){for(var e=t.length-1,i=void 0;e>=0;e--)0===t[e].children.length?e>0?(i=t[e-1].children).splice(i.indexOf(t[e]),1):this.clear():n(t[e],this.toBBox)},s}))})(kt);return kt.exports}var Lt=jt();var Tt=o(Lt);function Pt(t){let e=0;let i=0;for(const s of t){e+=s.w*s.h;i=Math.max(i,s.w)}t.sort(((t,e)=>e.h-t.h));const s=Math.max(Math.ceil(Math.sqrt(e/.95)),i);const r=[{x:0,y:0,w:s,h:Infinity}];let n=0;let a=0;for(const e of t){for(let t=r.length-1;t>=0;t--){const i=r[t];if(e.w>i.w||e.h>i.h)continue;e.x=i.x;e.y=i.y;a=Math.max(a,e.y+e.h);n=Math.max(n,e.x+e.w);if(e.w===i.w&&e.h===i.h){const e=r.pop();if(t<r.length)r[t]=e}else if(e.h===i.h){i.x+=e.w;i.w-=e.w}else if(e.w===i.w){i.y+=e.h;i.h-=e.h}else{r.push({x:i.x+e.w,y:i.y,w:i.w-e.w,h:e.h});i.y+=e.h;i.h-=e.h}break}}return{w:n,h:a,fill:e/(n*a)||0}}var St=Object.defineProperty;var $t=Math.pow;var Et=(t,e)=>St(t,"name",{value:e,configurable:true});var At=(t,e,i)=>new Promise(((s,r)=>{var n=t=>{try{o(i.next(t))}catch(t){r(t)}},a=t=>{try{o(i.throw(t))}catch(t){r(t)}},o=t=>t.done?s(t.value):Promise.resolve(t.value).then(n,a);o((i=i.apply(t,e)).next())}));var Ct=class t{constructor(t,e){this.str=t!=null?t:e,this.perFeature=typeof this.str=="function"&&this.str.length===2}get(t,e){return typeof this.str=="function"?this.str(t,e):this.str}};Et(Ct,"StringAttr");var It=Ct,Dt=class t{constructor(t,e=1){this.value=t!=null?t:e,this.perFeature=typeof this.value=="function"&&this.value.length===2}get(t,e){return typeof this.value=="function"?this.value(t,e):this.value}};Et(Dt,"NumberAttr");var Ft=Dt,Bt=class t{constructor(t){var e;this.labelProps=(e=t==null?void 0:t.labelProps)!=null?e:["name"],this.textTransform=t==null?void 0:t.textTransform}get(t,e){let i,s;typeof this.labelProps=="function"?s=this.labelProps(t,e):s=this.labelProps;for(let t of s)if(Object.prototype.hasOwnProperty.call(e.props,t)&&typeof e.props[t]=="string"){i=e.props[t];break}let r;return typeof this.textTransform=="function"?r=this.textTransform(t,e):r=this.textTransform,i&&r==="uppercase"?i=i.toUpperCase():i&&r==="lowercase"?i=i.toLowerCase():i&&r==="capitalize"&&(i=i.toLowerCase().split(" ").map((t=>t[0].toUpperCase()+t.slice(1))).join(" ")),i}};Et(Bt,"TextAttr");var Rt=Bt,Nt=class t{constructor(t){var e,i;t!=null&&t.font?this.font=t.font:(this.family=(e=t==null?void 0:t.fontFamily)!=null?e:"sans-serif",this.size=(i=t==null?void 0:t.fontSize)!=null?i:12,this.weight=t==null?void 0:t.fontWeight,this.style=t==null?void 0:t.fontStyle)}get(t,e){if(this.font)return typeof this.font=="function"?this.font(t,e):this.font;let i="";this.style&&(typeof this.style=="function"?i=`${this.style(t,e)} `:i=`${this.style} `);let s="";this.weight&&(typeof this.weight=="function"?s=`${this.weight(t,e)} `:s=`${this.weight} `);let r;typeof this.size=="function"?r=this.size(t,e):r=this.size;let n;return typeof this.family=="function"?n=this.family(t,e):n=this.family,`${i}${s}${r}px ${n}`}};Et(Nt,"FontAttr");var Vt=Nt,Ut=class t{constructor(t,e=[]){this.value=t!=null?t:e,this.perFeature=typeof this.value=="function"&&this.value.length===2}get(t,e){return typeof this.value=="function"?this.value(t,e):this.value}};Et(Ut,"ArrayAttr");var Ot=Ut;var Xt=Et(((t,e,i)=>{let s=[],r,n,a,o=0,l=0,h=0,f=0,c=0,u=0,d=0,m=0,b=0,w=0,_=0,y=0;if(t.length<2)return[];if(t.length===2)return h=Math.sqrt($t(t[1].x-t[0].x,2)+$t(t[1].y-t[0].y,2)),[{length:h,beginIndex:0,beginDistance:0,endIndex:2,endDistance:h}];for(f=Math.sqrt($t(t[1].x-t[0].x,2)+$t(t[1].y-t[0].y,2)),o=1,l=t.length-1;o<l;o++)r=t[o-1],n=t[o],a=t[o+1],u=n.x-r.x,d=n.y-r.y,m=a.x-n.x,b=a.y-n.y,c=Math.sqrt(m*m+b*b),h+=f,w=Math.acos((u*m+d*b)/(f*c)),(w>e||h-y>i)&&(s.push({length:h-y,beginDistance:y,beginIndex:_,endIndex:o+1,endDistance:h}),_=o,y=h),f=c;return o-_>0&&s.push({length:h-y+c,beginIndex:_,beginDistance:y,endIndex:o+1,endDistance:h+c}),s}),"linelabel");function qt(t,e,i,s){let r=[];for(let n of t){let t=Xt(n,Math.PI/45,e);for(let a of t)if(a.length>=e+s){let t=new w(n[a.beginIndex].x,n[a.beginIndex].y),o=n[a.endIndex-1],l=new w((o.x-t.x)/a.length,(o.y-t.y)/a.length);for(let n=s;n<a.length-e;n+=i)r.push({start:t.add(l.mult(n)),end:t.add(l.mult(n+e))})}}return r}Et(qt,"simpleLabel");function Yt(t,e,i,s){let r=e.x-t.x,n=e.y-t.y,a=Math.sqrt($t(e.x-t.x,2)+$t(e.y-t.y,2)),o=[];for(let e=0;e<i+s;e+=2*s){let i=e*1/a;o.push({x:t.x+i*r,y:t.y+i*n})}return o}Et(Yt,"lineCells");function Zt(t,e){if(t.length<=e)return[t];let i=e-1,s=t.lastIndexOf(" ",i),r=t.indexOf(" ",i);if(s===-1&&r===-1)return[t];let n,a;return r===-1||s>=0&&i-s<r-i?(n=t.substring(0,s),a=t.substring(s+1,t.length)):(n=t.substring(0,r),a=t.substring(r+1,t.length)),[n,...Zt(a,e)]}Et(Zt,"linebreak");var Ht=(t=>(t[t.Point=1]="Point",t[t.Line=2]="Line",t[t.Polygon=3]="Polygon",t))(Ht||{});function Gt(t){return`${t.x}:${t.y}:${t.z}`}Et(Gt,"toIndex");var Wt=Et(((t,e,i)=>{t.pos=e;let s=t.readVarint()+t.pos,r=1,n=0,a=0,o=0,l=1/0,h=-1/0,f=1/0,c=-1/0,u=[],d=[];for(;t.pos<s;){if(n<=0){let e=t.readVarint();r=e&7,n=e>>3}if(n--,r===1||r===2)a+=t.readSVarint()*i,o+=t.readSVarint()*i,a<l&&(l=a),a>h&&(h=a),o<f&&(f=o),o>c&&(c=o),r===1&&(d.length>0&&u.push(d),d=[]),d.push(new w(a,o));else if(r===7)d&&d.push(d[0].clone());else throw new Error(`unknown command ${r}`)}return d&&u.push(d),{geom:u,bbox:{minX:l,minY:f,maxX:h,maxY:c}}}),"loadGeomAndBbox");function Jt(t,e){let i=new q(new et(t)),s=new Map;for(let[t,r]of Object.entries(i.layers)){let i=[],n=r;for(let t=0;t<n.length;t++){let s=Wt(n.feature(t)._pbf,n.feature(t)._geometry,e/n.extent),r=0;for(let t of s.geom)r+=t.length;i.push({id:n.feature(t).id,geomType:n.feature(t).type,geom:s.geom,numVertices:r,bbox:s.bbox,props:n.feature(t).properties})}s.set(t,i)}return s}Et(Jt,"parseTile");var Kt=class t{constructor(t,e){typeof t=="string"?this.p=new xt.PMTiles(t):this.p=t,this.zoomaborts=[],this.shouldCancelZooms=e}get(t,e){return At(this,null,(function*(){this.shouldCancelZooms&&(this.zoomaborts=this.zoomaborts.filter((e=>e.z!==t.z?(e.controller.abort(),false):true)));let i=new AbortController;this.zoomaborts.push({z:t.z,controller:i});let s=i.signal,r=yield this.p.getZxy(t.z,t.x,t.y,s);return r?Jt(r.data,e):new Map}))}};Et(Kt,"PmtilesSource");var Qt=Kt,te=class t{constructor(t,e){this.url=t,this.zoomaborts=[],this.shouldCancelZooms=e}get(t,e){return At(this,null,(function*(){this.shouldCancelZooms&&(this.zoomaborts=this.zoomaborts.filter((e=>e.z!==t.z?(e.controller.abort(),false):true)));let i=this.url.replace("{z}",t.z.toString()).replace("{x}",t.x.toString()).replace("{y}",t.y.toString()),s=new AbortController;this.zoomaborts.push({z:t.z,controller:s});let r=s.signal;return new Promise(((t,s)=>{fetch(i,{signal:r}).then((t=>t.arrayBuffer())).then((i=>{let s=Jt(i,e);t(s)})).catch((t=>{s(t)}))}))}))}};Et(te,"ZxySource");var ee=te,ie=6378137,se=85.0511287798,re=ie*Math.PI,ne=Et((t=>{let e=Math.PI/180,i=Math.max(Math.min(se,t[0]),-85.0511287798),s=Math.sin(i*e);return new w(ie*t[1]*e,ie*Math.log((1+s)/(1-s))/2)}),"project");function ae(t){return t*t}Et(ae,"sqr");function oe(t,e){return ae(t.x-e.x)+ae(t.y-e.y)}Et(oe,"dist2");function le(t,e,i){let s=oe(e,i);if(s===0)return oe(t,e);let r=((t.x-e.x)*(i.x-e.x)+(t.y-e.y)*(i.y-e.y))/s;return r=Math.max(0,Math.min(1,r)),oe(t,new w(e.x+r*(i.x-e.x),e.y+r*(i.y-e.y)))}Et(le,"distToSegmentSquared");function he(t,e){let i=false;for(let s=0,r=e.length-1;s<e.length;r=s++){let n=e[s].x,a=e[s].y,o=e[r].x,l=e[r].y;a>t.y!=l>t.y&&t.x<(o-n)*(t.y-a)/(l-a)+n&&(i=!i)}return i}Et(he,"isInRing");function fe(t){let e=0;for(let i=0;i<t.length;i++){let s=(i+1)%t.length;e+=t[i].x*t[s].y,e-=t[s].x*t[i].y}return e<0}Et(fe,"isCcw");function ce(t,e){let i=false;for(let s of e)if(fe(s))he(t,s)&&(i=false);else{if(i)return true;he(t,s)&&(i=true)}return i}Et(ce,"pointInPolygon");function ue(t,e){let i=1/0;for(let s of e){let e=Math.sqrt(oe(t,s[0]));e<i&&(i=e)}return i}Et(ue,"pointMinDistToPoints");function de(t,e){let i=1/0;for(let s of e)for(let e=0;e<s.length-1;e++){let r=Math.sqrt(le(t,s[e],s[e+1]));r<i&&(i=r)}return i}Et(de,"pointMinDistToLines");var me=class t{constructor(t,e){this.source=t,this.cache=new Map,this.inflight=new Map,this.tileSize=e}get(t){return At(this,null,(function*(){let e=Gt(t);return new Promise(((i,s)=>{let r=this.cache.get(e);if(r)r.used=performance.now(),i(r.data);else{let r=this.inflight.get(e);r?r.push({resolve:i,reject:s}):(this.inflight.set(e,[]),this.source.get(t,this.tileSize).then((t=>{this.cache.set(e,{used:performance.now(),data:t});let s=this.inflight.get(e);if(s)for(let e of s)e.resolve(t);if(this.inflight.delete(e),i(t),this.cache.size>=64){let t=1/0,e;this.cache.forEach(((i,s)=>{i.used<t&&(t=i.used,e=s)})),e&&this.cache.delete(e)}})).catch((t=>{let i=this.inflight.get(e);if(i)for(let e of i)e.reject(t);this.inflight.delete(e),s(t)})))}}))}))}queryFeatures(t,e,i,s){let r=ne([e,t]),n=new w((r.x+re)/(re*2),1-(r.y+re)/(re*2));n.x>1&&(n.x=n.x-Math.floor(n.x));let a=n.mult(1<<i),o=Math.floor(a.x),l=Math.floor(a.y),h=Gt({z:i,x:o,y:l}),f=[],c=this.cache.get(h);if(c){let t=new w((a.x-o)*this.tileSize,(a.y-l)*this.tileSize);for(let[e,i]of c.data.entries())for(let r of i)r.geomType===1?ue(t,r.geom)<s&&f.push({feature:r,layerName:e}):r.geomType===2?de(t,r.geom)<s&&f.push({feature:r,layerName:e}):ce(t,r.geom)&&f.push({feature:r,layerName:e})}return f}};Et(me,"TileCache");var be=me;var we=(t=>(t[t.Left=1]="Left",t[t.Center=2]="Center",t[t.Right=3]="Right",t))(we||{}),_e=(t=>(t[t.N=1]="N",t[t.Ne=2]="Ne",t[t.E=3]="E",t[t.Se=4]="Se",t[t.S=5]="S",t[t.Sw=6]="Sw",t[t.W=7]="W",t[t.Nw=8]="Nw",t))(_e||{}),ye=Et(((t,e,i)=>{let s=document.createElement("canvas"),r=s.getContext("2d");return s.width=t,s.height=e,r!==null&&i(s,r),s}),"createPattern"),pe=class t{constructor(t){var e;this.pattern=t.pattern,this.fill=new It(t.fill,"black"),this.opacity=new Ft(t.opacity,1),this.stroke=new It(t.stroke,"black"),this.width=new Ft(t.width,0),this.perFeature=(e=this.fill.perFeature||this.opacity.perFeature||this.stroke.perFeature||this.width.perFeature||t.perFeature)!=null?e:false,this.doStroke=false}before(t,e){if(!this.perFeature){t.globalAlpha=this.opacity.get(e),t.fillStyle=this.fill.get(e),t.strokeStyle=this.stroke.get(e);let i=this.width.get(e);i>0&&(this.doStroke=true),t.lineWidth=i}if(this.pattern){let e=t.createPattern(this.pattern,"repeat");e&&(t.fillStyle=e)}}draw(t,e,i,s){let r=false;if(this.perFeature){t.globalAlpha=this.opacity.get(i,s),t.fillStyle=this.fill.get(i,s);let e=this.width.get(i,s);e&&(r=true,t.strokeStyle=this.stroke.get(i,s),t.lineWidth=e)}let n=Et((()=>{t.fill(),(r||this.doStroke)&&t.stroke()}),"drawPath");t.beginPath();for(let i of e)for(let e=0;e<i.length;e++){let s=i[e];e===0?t.moveTo(s.x,s.y):t.lineTo(s.x,s.y)}n()}};Et(pe,"PolygonSymbolizer");var ge=pe;function ve(t,e){return i=>{let s=i-t;return s>=0&&s<e.length?e[s]:0}}Et(ve,"arr");function xe(t,e){let i=0;for(;e[i+1][0]<t;)i++;return i}Et(xe,"getStopIndex");function ke(t,e,i){return t*(i-e)+e}Et(ke,"interpolate");function Me(t,e,i,s){let r=s[e+1][0]-s[e][0],n=t-s[e][0];return r===0?0:i===1?n/r:($t(i,n)-1)/($t(i,r)-1)}Et(Me,"computeInterpolationFactor");function ze(t,e){return i=>{if(e.length<1)return 0;if(i<=e[0][0])return e[0][1];if(i>=e[e.length-1][0])return e[e.length-1][1];let s=xe(i,e),r=Me(i,s,t,e);return ke(r,e[s][1],e[s+1][1])}}Et(ze,"exp");function je(t,e){return i=>{if(e.length<1)return 0;let s=t;for(let t=0;t<e.length;t++)i>=e[t][0]&&(s=e[t][1]);return s}}Et(je,"step");function Le(t){return ze(1,t)}Et(Le,"linear");var Te=class t{constructor(t){var e;this.color=new It(t.color,"black"),this.width=new Ft(t.width),this.opacity=new Ft(t.opacity),this.dash=t.dash?new Ot(t.dash):null,this.dashColor=new It(t.dashColor,"black"),this.dashWidth=new Ft(t.dashWidth,1),this.lineCap=new It(t.lineCap,"butt"),this.lineJoin=new It(t.lineJoin,"miter"),this.skip=false,this.perFeature=!!((e=this.dash)!=null&&e.perFeature||this.color.perFeature||this.opacity.perFeature||this.width.perFeature||this.lineCap.perFeature||this.lineJoin.perFeature||t.perFeature)}before(t,e){this.perFeature||(t.strokeStyle=this.color.get(e),t.lineWidth=this.width.get(e),t.globalAlpha=this.opacity.get(e),t.lineCap=this.lineCap.get(e),t.lineJoin=this.lineJoin.get(e))}draw(t,e,i,s){if(this.skip)return;let r=Et((()=>{this.perFeature&&(t.globalAlpha=this.opacity.get(i,s),t.lineCap=this.lineCap.get(i,s),t.lineJoin=this.lineJoin.get(i,s)),this.dash?(t.save(),this.perFeature?(t.lineWidth=this.dashWidth.get(i,s),t.strokeStyle=this.dashColor.get(i,s),t.setLineDash(this.dash.get(i,s))):t.setLineDash(this.dash.get(i)),t.stroke(),t.restore()):(t.save(),this.perFeature&&(t.lineWidth=this.width.get(i,s),t.strokeStyle=this.color.get(i,s)),t.stroke(),t.restore())}),"strokePath");t.beginPath();for(let i of e)for(let e=0;e<i.length;e++){let s=i[e];e===0?t.moveTo(s.x,s.y):t.lineTo(s.x,s.y)}r()}};Et(Te,"LineSymbolizer");var Pe=Te,Se=class t{constructor(t){this.name=t.name,this.sheet=t.sheet,this.dpr=window.devicePixelRatio}place(t,e,i){let s=new w(e[0][0].x,e[0][0].y),r=this.sheet.get(this.name),n=r.w/this.dpr,a=r.h/this.dpr,o={minX:s.x-n/2,minY:s.y-a/2,maxX:s.x+n/2,maxY:s.y+a/2};return[{anchor:s,bboxes:[o],draw:Et((t=>{t.globalAlpha=1,t.drawImage(this.sheet.canvas,r.x,r.y,r.w,r.h,-r.w/2/this.dpr,-r.h/2/this.dpr,r.w/2,r.h/2)}),"draw")}]}};Et(Se,"IconSymbolizer");var $e=Se,Ee=class t{constructor(t){this.radius=new Ft(t.radius,3),this.fill=new It(t.fill,"black"),this.stroke=new It(t.stroke,"white"),this.width=new Ft(t.width,0),this.opacity=new Ft(t.opacity)}draw(t,e,i,s){t.globalAlpha=this.opacity.get(i,s);let r=this.radius.get(i,s),n=this.width.get(i,s);n>0&&(t.strokeStyle=this.stroke.get(i,s),t.lineWidth=n,t.beginPath(),t.arc(e[0][0].x,e[0][0].y,r+n/2,0,2*Math.PI),t.stroke()),t.fillStyle=this.fill.get(i,s),t.beginPath(),t.arc(e[0][0].x,e[0][0].y,r,0,2*Math.PI),t.fill()}place(t,e,i){let s=new w(e[0][0].x,e[0][0].y),r=this.radius.get(t.zoom,i),n={minX:s.x-r,minY:s.y-r,maxX:s.x+r,maxY:s.y+r};return[{anchor:s,bboxes:[n],draw:Et((e=>{this.draw(e,[[new w(0,0)]],t.zoom,i)}),"draw")}]}};Et(Ee,"CircleSymbolizer");var Ae=Ee,Ce=class t{constructor(t){this.font=new Vt(t),this.text=new Rt(t),this.fill=new It(t.fill,"black"),this.background=new It(t.background,"white"),this.padding=new Ft(t.padding,0)}place(t,e,i){let s=this.text.get(t.zoom,i);if(!s)return;let r=this.font.get(t.zoom,i);t.scratch.font=r;let n=t.scratch.measureText(s),a=n.width,o=n.actualBoundingBoxAscent,l=n.actualBoundingBoxDescent,h=new w(e[0][0].x,e[0][0].y),f=this.padding.get(t.zoom,i),c={minX:h.x-a/2-f,minY:h.y-o-f,maxX:h.x+a/2+f,maxY:h.y+l+f};return[{anchor:h,bboxes:[c],draw:Et((e=>{e.globalAlpha=1,e.fillStyle=this.background.get(t.zoom,i),e.fillRect(-a/2-f,-o-f,a+2*f,o+l+2*f),e.fillStyle=this.fill.get(t.zoom,i),e.font=r,e.fillText(s,-a/2,0)}),"draw")}]}};Et(Ce,"ShieldSymbolizer");var Ie=Ce,De=class t{constructor(t){this.list=t}place(t,e,i){let s=this.list[0].place(t,e,i);if(!s)return;let r=s[0],n=r.anchor,a=r.bboxes[0],o=a.maxY-a.minY,l=[{draw:r.draw,translate:{x:0,y:0}}],h=[[new w(e[0][0].x,e[0][0].y+o)]];for(let e=1;e<this.list.length;e++)s=this.list[e].place(t,h,i),s&&(r=s[0],a=Be(a,r.bboxes[0]),l.push({draw:r.draw,translate:{x:0,y:o}}));return[{anchor:n,bboxes:[a],draw:Et((t=>{for(let e of l)t.save(),t.translate(e.translate.x,e.translate.y),e.draw(t),t.restore()}),"draw")}]}};Et(De,"FlexSymbolizer");var Fe=De,Be=Et(((t,e)=>({minX:Math.min(t.minX,e.minX),minY:Math.min(t.minY,e.minY),maxX:Math.max(t.maxX,e.maxX),maxY:Math.max(t.maxY,e.maxY)})),"mergeBbox"),Re=class t{constructor(t){this.list=t}place(t,e,i){let s=this.list[0];if(!s)return;let r=s.place(t,e,i);if(!r)return;let n=r[0],a=n.anchor,o=n.bboxes[0],l=[n.draw];for(let s=1;s<this.list.length;s++){if(r=this.list[s].place(t,e,i),!r)return;n=r[0],o=Be(o,n.bboxes[0]),l.push(n.draw)}return[{anchor:a,bboxes:[o],draw:Et((t=>{for(let e of l)e(t)}),"draw")}]}};Et(Re,"GroupSymbolizer");var Ne=Re,Ve=class t{constructor(t){this.symbolizer=t}place(t,e,i){let s=e[0][0],r=this.symbolizer.place(t,[[new w(0,0)]],i);if(!r||r.length===0)return;let n=r[0],a=n.bboxes[0],o=a.maxX-a.minX,l=a.maxY-a.minY,h={minX:s.x-o/2,maxX:s.x+o/2,minY:s.y-l/2,maxY:s.y+l/2};return[{anchor:s,bboxes:[h],draw:Et((t=>{t.translate(-o/2,l/2-a.maxY),n.draw(t,{justify:2})}),"draw")}]}};Et(Ve,"CenteredSymbolizer");var Ue=Ve,Oe=class t{constructor(t,e){this.padding=new Ft(t,0),this.symbolizer=e}place(t,e,i){let s=this.symbolizer.place(t,e,i);if(!s||s.length===0)return;let r=this.padding.get(t.zoom,i);for(let t of s)for(let e of t.bboxes)e.minX-=r,e.minY-=r,e.maxX+=r,e.maxY+=r;return s}};Et(Oe,"Padding");var Xe=Oe,qe=class t{constructor(t){this.font=new Vt(t),this.text=new Rt(t),this.fill=new It(t.fill,"black"),this.stroke=new It(t.stroke,"black"),this.width=new Ft(t.width,0),this.lineHeight=new Ft(t.lineHeight,1),this.letterSpacing=new Ft(t.letterSpacing,0),this.maxLineCodeUnits=new Ft(t.maxLineChars,15),this.justify=t.justify}place(t,e,i){let s=this.text.get(t.zoom,i);if(!s)return;let r=this.font.get(t.zoom,i);t.scratch.font=r;let n=this.letterSpacing.get(t.zoom,i),a=Zt(s,this.maxLineCodeUnits.get(t.zoom,i)),o="",l=0;for(let t of a)t.length>l&&(l=t.length,o=t);let h=t.scratch.measureText(o),f=h.width+n*(l-1),c=h.actualBoundingBoxAscent,u=h.actualBoundingBoxDescent,d=(c+u)*this.lineHeight.get(t.zoom,i),m=new w(e[0][0].x,e[0][0].y),b={minX:m.x,minY:m.y-c,maxX:m.x+f,maxY:m.y+u+(a.length-1)*d};return[{anchor:m,bboxes:[b],draw:Et(((e,s)=>{e.globalAlpha=1,e.font=r,e.fillStyle=this.fill.get(t.zoom,i);let o=this.width.get(t.zoom,i),l=0;for(let r of a){let a=0;if(this.justify===2||s&&s.justify===2?a=(f-e.measureText(r).width)/2:(this.justify===3||s&&s.justify===3)&&(a=f-e.measureText(r).width),o)if(e.lineWidth=o*2,e.strokeStyle=this.stroke.get(t.zoom,i),n>0){let t=a;for(let i of r)e.strokeText(i,t,l),t+=e.measureText(i).width+n}else e.strokeText(r,a,l);if(n>0){let t=a;for(let i of r)e.fillText(i,t,l),t+=e.measureText(i).width+n}else e.fillText(r,a,l);l+=d}}),"draw")}]}};Et(qe,"TextSymbolizer");var Ye=qe,Ze=class t{constructor(t){this.centered=new Ue(new Ye(t))}place(t,e,i){return this.centered.place(t,e,i)}};Et(Ze,"CenteredTextSymbolizer");var He=Ze,Ge=class t{constructor(t,e){var i,s,r;this.symbolizer=t,this.offsetX=new Ft(e.offsetX,0),this.offsetY=new Ft(e.offsetY,0),this.justify=(i=e.justify)!=null?i:void 0,this.placements=(s=e.placements)!=null?s:[2,6,8,4,1,3,5,7],this.ddValues=(r=e.ddValues)!=null?r:()=>({})}place(t,e,i){if(i.geomType!==1)return;let s=e[0][0],r=this.symbolizer.place(t,[[new w(0,0)]],i);if(!r||r.length===0)return;let n=r[0],a=n.bboxes[0],o=this.offsetX,l=this.offsetY,h=this.justify,f=this.placements,{offsetX:c,offsetY:u,justify:d,placements:m}=this.ddValues(t.zoom,i)||{};c&&(o=new Ft(c,0)),u&&(l=new Ft(u,0)),d&&(h=d),m&&(f=m);let b=o.get(t.zoom,i),_=l.get(t.zoom,i),y=Et(((t,e)=>({minX:t.x+e.x+a.minX,minY:t.y+e.y+a.minY,maxX:t.x+e.x+a.maxX,maxY:t.y+e.y+a.maxY})),"getBbox"),p=new w(b,_),g,v=Et((t=>{t.translate(p.x,p.y),n.draw(t,{justify:g})}),"draw"),x=Et(((e,i)=>{let r=y(e,i);if(!t.index.bboxCollides(r,t.order))return[{anchor:s,bboxes:[r],draw:v}]}),"placeLabelInPoint");for(let t of f){let e=this.computeXaxisOffset(b,a,t),i=this.computeYaxisOffset(_,a,t);return g=this.computeJustify(h,t),p=new w(e,i),x(s,p)}}computeXaxisOffset(t,e,i){let s=e.maxX,r=s/2;return[1,5].includes(i)?t-r:[8,7,6].includes(i)?t-s:t}computeYaxisOffset(t,e,i){let s=Math.abs(e.minY),r=e.maxY,n=(e.minY+e.maxY)/2;return[3,7].includes(i)?t-n:[8,2,1].includes(i)?t-r:[6,4,5].includes(i)?t+s:t}computeJustify(t,e){return t||([1,5].includes(e)?2:[2,3,4].includes(e)?1:3)}};Et(Ge,"OffsetSymbolizer");var We=Ge,Je=class t{constructor(t){this.symbolizer=new We(new Ye(t),t)}place(t,e,i){return this.symbolizer.place(t,e,i)}};Et(Je,"OffsetTextSymbolizer");var Ke=Je,Qe=(t=>(t[t.Above=1]="Above",t[t.Center=2]="Center",t[t.Below=3]="Below",t))(Qe||{}),ti=class t{constructor(t){var e;this.font=new Vt(t),this.text=new Rt(t),this.fill=new It(t.fill,"black"),this.stroke=new It(t.stroke,"black"),this.width=new Ft(t.width,0),this.offset=new Ft(t.offset,0),this.position=(e=t.position)!=null?e:1,this.maxLabelCodeUnits=new Ft(t.maxLabelChars,40),this.repeatDistance=new Ft(t.repeatDistance,250)}place(t,e,i){let s=this.text.get(t.zoom,i);if(!s||s.length>this.maxLabelCodeUnits.get(t.zoom,i))return;let r=20,n=i.bbox;if(n.maxY-n.minY<r&&n.maxX-n.minX<r)return;let a=this.font.get(t.zoom,i);t.scratch.font=a;let o=t.scratch.measureText(s),l=o.width,h=o.actualBoundingBoxAscent+o.actualBoundingBoxDescent,f=this.repeatDistance.get(t.zoom,i);t.overzoom>4&&(f*=1<<t.overzoom-4);let c=h*2,u=qt(e,l,f,c);if(u.length===0)return;let d=[];for(let e of u){let r=e.end.x-e.start.x,n=e.end.y-e.start.y,o=Yt(e.start,e.end,l,c/2).map((t=>({minX:t.x-c/2,minY:t.y-c/2,maxX:t.x+c/2,maxY:t.y+c/2}))),u=Et((e=>{e.globalAlpha=1,e.rotate(Math.atan2(n,r)),r<0&&(e.scale(-1,-1),e.translate(-l,0));let o=0;this.position===3?o+=h:this.position===2&&(o+=h/2),e.translate(0,o-this.offset.get(t.zoom,i)),e.font=a;let f=this.width.get(t.zoom,i);f&&(e.lineWidth=f,e.strokeStyle=this.stroke.get(t.zoom,i),e.strokeText(s,0,0)),e.fillStyle=this.fill.get(t.zoom,i),e.fillText(s,0,0)}),"draw");d.push({anchor:e.start,bboxes:o,draw:u,deduplicationKey:s,deduplicationDistance:f})}return d}};Et(ti,"LineLabelSymbolizer");var ei=ti;var ii=Et(((t,e)=>{let i=t[e];return typeof i=="string"?i:""}),"getString"),si=Et(((t,e)=>{let i=t[e];return typeof i=="number"?i:0}),"getNumber"),ri=Et((t=>[{dataLayer:"earth",symbolizer:new ge({fill:t.earth})},{dataLayer:"landuse",symbolizer:new ge({fill:Et(((e,i)=>D(t.park_a,t.park_b,Math.min(Math.max(e/12,12),0))),"fill")}),filter:Et(((t,e)=>{let i=ii(e.props,"pmap:kind");return["allotments","village_green","playground"].includes(i)}),"filter")},{dataLayer:"landuse",symbolizer:new ge({fill:t.park_b,opacity:.7}),filter:Et(((t,e)=>{let i=ii(e.props,"pmap:kind");return["national_park","park","cemetery","protected_area","nature_reserve","forest","golf_course"].includes(i)}),"filter")},{dataLayer:"landuse",symbolizer:new ge({fill:t.hospital}),filter:Et(((t,e)=>e.props["pmap:kind"]==="hospital"),"filter")},{dataLayer:"landuse",symbolizer:new ge({fill:t.industrial}),filter:Et(((t,e)=>e.props["pmap:kind"]==="industrial"),"filter")},{dataLayer:"landuse",symbolizer:new ge({fill:t.school}),filter:Et(((t,e)=>{let i=ii(e.props,"pmap:kind");return["school","university","college"].includes(i)}),"filter")},{dataLayer:"landuse",symbolizer:new ge({fill:t.beach}),filter:Et(((t,e)=>e.props["pmap:kind"]==="beach"),"filter")},{dataLayer:"landuse",symbolizer:new ge({fill:t.zoo}),filter:Et(((t,e)=>e.props["pmap:kind"]==="zoo"),"filter")},{dataLayer:"landuse",symbolizer:new ge({fill:t.zoo}),filter:Et(((t,e)=>{let i=ii(e.props,"pmap:kind");return["military","naval_base","airfield"].includes(i)}),"filter")},{dataLayer:"natural",symbolizer:new ge({fill:Et(((e,i)=>D(t.wood_a,t.wood_b,Math.min(Math.max(e/12,12),0))),"fill")}),filter:Et(((t,e)=>{let i=ii(e.props,"pmap:kind");return["wood","nature_reserve","forest"].includes(i)}),"filter")},{dataLayer:"natural",symbolizer:new ge({fill:Et(((e,i)=>D(t.scrub_a,t.scrub_b,Math.min(Math.max(e/12,12),0))),"fill")}),filter:Et(((t,e)=>{let i=ii(e.props,"pmap:kind");return["scrub","grassland","grass"].includes(i)}),"filter")},{dataLayer:"natural",symbolizer:new ge({fill:t.scrub_b}),filter:Et(((t,e)=>{let i=ii(e.props,"pmap:kind");return["scrub","grassland","grass"].includes(i)}),"filter")},{dataLayer:"natural",symbolizer:new ge({fill:t.glacier}),filter:Et(((t,e)=>e.props["pmap:kind"]==="glacier"),"filter")},{dataLayer:"natural",symbolizer:new ge({fill:t.sand}),filter:Et(((t,e)=>e.props["pmap:kind"]==="sand"),"filter")},{dataLayer:"landuse",symbolizer:new ge({fill:t.aerodrome}),filter:Et(((t,e)=>e.props["pmap:kind"]==="aerodrome"),"filter")},{dataLayer:"water",symbolizer:new ge({fill:t.water})},{dataLayer:"transit",symbolizer:new Pe({color:t.runway,width:Et(((t,e)=>ze(1.6,[[11,0],[13,4],[19,30]])(t)),"width")}),filter:Et(((t,e)=>e.props["pmap:kind_detail"]==="runway"),"filter")},{dataLayer:"transit",symbolizer:new Pe({color:t.runway,width:Et(((t,e)=>ze(1.6,[[14,0],[14.5,1],[16,6]])(t)),"width")}),filter:Et(((t,e)=>e.props["pmap:kind_detail"]==="taxiway"),"filter")},{dataLayer:"transit",symbolizer:new Pe({color:t.pier,width:Et(((t,e)=>ze(1.6,[[13,0],[13.5,0,5],[21,16]])(t)),"width")}),filter:Et(((t,e)=>e.props["pmap:kind"]==="pier"),"filter")},{dataLayer:"physical_line",minzoom:14,symbolizer:new Pe({color:t.water,width:Et(((t,e)=>ze(1.6,[[9,0],[9.5,1],[18,12]])(t)),"width")}),filter:Et(((t,e)=>e.props["pmap:kind"]==="river"),"filter")},{dataLayer:"physical_line",minzoom:14,symbolizer:new Pe({color:t.water,width:.5}),filter:Et(((t,e)=>e.props["pmap:kind"]==="stream"),"filter")},{dataLayer:"landuse",symbolizer:new ge({fill:t.pedestrian}),filter:Et(((t,e)=>e.props["pmap:kind"]==="pedestrian"),"filter")},{dataLayer:"landuse",symbolizer:new ge({fill:t.pier}),filter:Et(((t,e)=>e.props["pmap:kind"]==="pier"),"filter")},{dataLayer:"buildings",symbolizer:new ge({fill:t.buildings,opacity:.5})},{dataLayer:"roads",symbolizer:new Pe({color:t.major,width:Et(((t,e)=>ze(1.6,[[14,0],[20,7]])(t)),"width")}),filter:Et(((t,e)=>{let i=ii(e.props,"pmap:kind");return["other","path"].includes(i)}),"filter")},{dataLayer:"roads",symbolizer:new Pe({color:t.major,width:Et(((t,e)=>ze(1.6,[[13,0],[18,8]])(t)),"width")}),filter:Et(((t,e)=>e.props["pmap:kind"]==="minor_road"),"filter")},{dataLayer:"roads",symbolizer:new Pe({color:t.major,width:Et(((t,e)=>ze(1.6,[[7,0],[12,1.2],[15,3],[18,13]])(t)),"width")}),filter:Et(((t,e)=>e.props["pmap:kind"]==="medium_road"),"filter")},{dataLayer:"roads",symbolizer:new Pe({color:t.major,width:Et(((t,e)=>ze(1.6,[[6,0],[12,1.6],[15,3],[18,13]])(t)),"width")}),filter:Et(((t,e)=>e.props["pmap:kind"]==="major_road"),"filter")},{dataLayer:"roads",symbolizer:new Pe({color:t.major,width:Et(((t,e)=>ze(1.6,[[3,0],[6,1.1],[12,1.6],[15,5],[18,15]])(t)),"width")}),filter:Et(((t,e)=>e.props["pmap:kind"]==="highway"),"filter")},{dataLayer:"boundaries",symbolizer:new Pe({dash:[3,2],color:t.boundaries,width:1}),filter:Et(((t,e)=>{let i=e.props["pmap:min_admin_level"];return typeof i=="number"&&i<=2}),"filter")},{dataLayer:"transit",symbolizer:new Pe({dash:[.3,.75],color:t.railway,dashWidth:Et(((t,e)=>ze(1.6,[[4,0],[7,.15],[19,9]])(t)),"dashWidth"),opacity:.5}),filter:Et(((t,e)=>e.props["pmap:kind"]==="rail"),"filter")},{dataLayer:"boundaries",symbolizer:new Pe({dash:[3,2],color:t.boundaries,width:.5}),filter:Et(((t,e)=>{let i=e.props["pmap:min_admin_level"];return typeof i=="number"&&i>2}),"filter")}]),"paintRules"),ni=Et((t=>{let e=["name"];return[{dataLayer:"roads",symbolizer:new ei({labelProps:e,fill:t.roads_label_minor,font:"400 12px sans-serif",width:2,stroke:t.roads_label_minor_halo}),minzoom:16,filter:Et(((t,e)=>{let i=ii(e.props,"pmap:kind");return["minor_road","other","path"].includes(i)}),"filter")},{dataLayer:"roads",symbolizer:new ei({labelProps:e,fill:t.roads_label_major,font:"400 12px sans-serif",width:2,stroke:t.roads_label_major_halo}),minzoom:12,filter:Et(((t,e)=>{let i=ii(e.props,"pmap:kind");return["highway","major_road","medium_road"].includes(i)}),"filter")},{dataLayer:"roads",symbolizer:new ei({labelProps:e,fill:t.roads_label_major,font:"400 12px sans-serif",width:2,stroke:t.roads_label_major_halo}),minzoom:12,filter:Et(((t,e)=>{let i=ii(e.props,"pmap:kind");return["highway","major_road","medium_road"].includes(i)}),"filter")},{dataLayer:"physical_point",symbolizer:new He({labelProps:e,fill:t.ocean_label,lineHeight:1.5,letterSpacing:1,font:Et(((t,e)=>`400 ${Le([[3,10],[10,12]])(t)}px sans-serif`),"font"),textTransform:"uppercase"}),filter:Et(((t,e)=>{let i=ii(e.props,"pmap:kind");return["ocean","bay","strait","fjord"].includes(i)}),"filter")},{dataLayer:"physical_point",symbolizer:new He({labelProps:e,fill:t.ocean_label,lineHeight:1.5,letterSpacing:1,font:Et(((t,e)=>`400 ${Le([[3,0],[6,12],[10,12]])(t)}px sans-serif`),"font")}),filter:Et(((t,e)=>{let i=ii(e.props,"pmap:kind");return["sea","lake","water"].includes(i)}),"filter")},{dataLayer:"places",symbolizer:new He({labelProps:Et(((t,i)=>t<6?["name:short"]:e),"labelProps"),fill:t.state_label,stroke:t.state_label_halo,width:1,lineHeight:1.5,font:Et(((t,e)=>t<6?"400 16px sans-serif":"400 12px sans-serif"),"font"),textTransform:"uppercase"}),filter:Et(((t,e)=>e.props["pmap:kind"]==="region"),"filter")},{dataLayer:"places",symbolizer:new He({labelProps:e,fill:t.country_label,lineHeight:1.5,font:Et(((t,e)=>"600 12px sans-serif"),"font"),textTransform:"uppercase"}),filter:Et(((t,e)=>e.props["pmap:kind"]==="country"),"filter")},{dataLayer:"places",minzoom:9,symbolizer:new He({labelProps:e,fill:t.city_label,lineHeight:1.5,font:Et(((t,e)=>{if(!e)return"400 12px sans-serif";let i=e.props["pmap:min_zoom"],s=400;i&&i<=5&&(s=600);let r=12,n=e.props["pmap:population_rank"];return n&&n>9&&(r=16),`${s} ${r}px sans-serif`}),"font")}),sort:Et(((t,e)=>{let i=si(t,"pmap:population_rank"),s=si(e,"pmap:population_rank");return i-s}),"sort"),filter:Et(((t,e)=>e.props["pmap:kind"]==="locality"),"filter")},{dataLayer:"places",maxzoom:8,symbolizer:new Ne([new Ae({radius:2,fill:t.city_circle,stroke:t.city_circle_stroke,width:1.5}),new Ke({labelProps:e,fill:t.city_label,stroke:t.city_label_halo,width:1,offsetX:6,offsetY:4.5,font:Et(((t,e)=>"400 12px sans-serif"),"font")})]),filter:Et(((t,e)=>e.props["pmap:kind"]==="locality"),"filter")}]}),"labelRules");var ai={background:"#cccccc",earth:"#e0e0e0",park_a:"#cfddd5",park_b:"#9cd3b4",hospital:"#e4dad9",industrial:"#d1dde1",school:"#e4ded7",wood_a:"#d0ded0",wood_b:"#a0d9a0",pedestrian:"#e3e0d4",scrub_a:"#cedcd7",scrub_b:"#99d2bb",glacier:"#e7e7e7",sand:"#e2e0d7",beach:"#e8e4d0",aerodrome:"#dadbdf",runway:"#e9e9ed",water:"#80deea",pier:"#e0e0e0",zoo:"#c6dcdc",military:"#dcdcdc",tunnel_other_casing:"#e0e0e0",tunnel_minor_casing:"#e0e0e0",tunnel_link_casing:"#e0e0e0",tunnel_medium_casing:"#e0e0e0",tunnel_major_casing:"#e0e0e0",tunnel_highway_casing:"#e0e0e0",tunnel_other:"#d5d5d5",tunnel_minor:"#d5d5d5",tunnel_link:"#d5d5d5",tunnel_medium:"#d5d5d5",tunnel_major:"#d5d5d5",tunnel_highway:"#d5d5d5",transit_pier:"#e0e0e0",buildings:"#cccccc",minor_service_casing:"#e0e0e0",minor_casing:"#e0e0e0",link_casing:"#e0e0e0",medium_casing:"#e0e0e0",major_casing_late:"#e0e0e0",highway_casing_late:"#e0e0e0",other:"#ebebeb",minor_service:"#ebebeb",minor_a:"#ebebeb",minor_b:"#ffffff",link:"#ffffff",medium:"#f5f5f5",major_casing_early:"#e0e0e0",major:"#ffffff",highway_casing_early:"#e0e0e0",highway:"#ffffff",railway:"#a7b1b3",boundaries:"#adadad",waterway_label:"#ffffff",bridges_other_casing:"#e0e0e0",bridges_minor_casing:"#e0e0e0",bridges_link_casing:"#e0e0e0",bridges_medium_casing:"#e0e0e0",bridges_major_casing:"#e0e0e0",bridges_highway_casing:"#e0e0e0",bridges_other:"#ebebeb",bridges_minor:"#ffffff",bridges_link:"#ffffff",bridges_medium:"#f0eded",bridges_major:"#f5f5f5",bridges_highway:"#ffffff",roads_label_minor:"#91888b",roads_label_minor_halo:"#ffffff",roads_label_major:"#938a8d",roads_label_major_halo:"#ffffff",ocean_label:"#ffffff",peak_label:"#7e9aa0",subplace_label:"#8f8f8f",subplace_label_halo:"#e0e0e0",city_circle:"#ffffff",city_circle_stroke:"#a3a3a3",city_label:"#5c5c5c",city_label_halo:"#e0e0e0",state_label:"#b3b3b3",state_label_halo:"#e0e0e0",country_label:"#a3a3a3"},oi={background:"#34373d",earth:"#1f1f1f",park_a:"#232325",park_b:"#232325",hospital:"#252424",industrial:"#222222",school:"#262323",wood_a:"#202121",wood_b:"#202121",pedestrian:"#1e1e1e",scrub_a:"#222323",scrub_b:"#222323",glacier:"#1c1c1c",sand:"#212123",beach:"#28282a",aerodrome:"#1e1e1e",runway:"#333333",water:"#34373d",pier:"#222222",zoo:"#222323",military:"#242323",tunnel_other_casing:"#141414",tunnel_minor_casing:"#141414",tunnel_link_casing:"#141414",tunnel_medium_casing:"#141414",tunnel_major_casing:"#141414",tunnel_highway_casing:"#141414",tunnel_other:"#292929",tunnel_minor:"#292929",tunnel_link:"#292929",tunnel_medium:"#292929",tunnel_major:"#292929",tunnel_highway:"#292929",transit_pier:"#333333",buildings:"#111111",minor_service_casing:"#1f1f1f",minor_casing:"#1f1f1f",link_casing:"#1f1f1f",medium_casing:"#1f1f1f",major_casing_late:"#1f1f1f",highway_casing_late:"#1f1f1f",other:"#333333",minor_service:"#333333",minor_a:"#3d3d3d",minor_b:"#333333",link:"#3d3d3d",medium:"#3d3d3d",major_casing_early:"#1f1f1f",major:"#3d3d3d",highway_casing_early:"#1f1f1f",highway:"#474747",railway:"#000000",boundaries:"#5b6374",waterway_label:"#717784",bridges_other_casing:"#2b2b2b",bridges_minor_casing:"#1f1f1f",bridges_link_casing:"#1f1f1f",bridges_medium_casing:"#1f1f1f",bridges_major_casing:"#1f1f1f",bridges_highway_casing:"#1f1f1f",bridges_other:"#333333",bridges_minor:"#333333",bridges_link:"#3d3d3d",bridges_medium:"#3d3d3d",bridges_major:"#3d3d3d",bridges_highway:"#474747",roads_label_minor:"#525252",roads_label_minor_halo:"#1f1f1f",roads_label_major:"#666666",roads_label_major_halo:"#1f1f1f",ocean_label:"#717784",peak_label:"#898080",subplace_label:"#525252",subplace_label_halo:"#1f1f1f",city_circle:"#000000",city_circle_stroke:"#7a7a7a",city_label:"#7a7a7a",city_label_halo:"#212121",state_label:"#3d3d3d",state_label_halo:"#1f1f1f",country_label:"#5c5c5c"},li={background:"#ffffff",earth:"#ffffff",park_a:"#fcfcfc",park_b:"#fcfcfc",hospital:"#f8f8f8",industrial:"#fcfcfc",school:"#f8f8f8",wood_a:"#fafafa",wood_b:"#fafafa",pedestrian:"#fdfdfd",scrub_a:"#fafafa",scrub_b:"#fafafa",glacier:"#fcfcfc",sand:"#fafafa",beach:"#f6f6f6",aerodrome:"#fdfdfd",runway:"#efefef",water:"#dcdcdc",pier:"#f5f5f5",zoo:"#f7f7f7",military:"#fcfcfc",tunnel_other_casing:"#d6d6d6",tunnel_minor_casing:"#fcfcfc",tunnel_link_casing:"#fcfcfc",tunnel_medium_casing:"#fcfcfc",tunnel_major_casing:"#fcfcfc",tunnel_highway_casing:"#fcfcfc",tunnel_other:"#d6d6d6",tunnel_minor:"#d6d6d6",tunnel_link:"#d6d6d6",tunnel_medium:"#d6d6d6",tunnel_major:"#d6d6d6",tunnel_highway:"#d6d6d6",transit_pier:"#efefef",buildings:"#efefef",minor_service_casing:"#ffffff",minor_casing:"#ffffff",link_casing:"#ffffff",medium_casing:"#ffffff",major_casing_late:"#ffffff",highway_casing_late:"#ffffff",other:"#f5f5f5",minor_service:"#f5f5f5",minor_a:"#ebebeb",minor_b:"#f5f5f5",link:"#ebebeb",medium:"#ebebeb",major_casing_early:"#ffffff",major:"#ebebeb",highway_casing_early:"#ffffff",highway:"#ebebeb",railway:"#d6d6d6",boundaries:"#adadad",waterway_label:"#adadad",bridges_other_casing:"#ffffff",bridges_minor_casing:"#ffffff",bridges_link_casing:"#ffffff",bridges_medium_casing:"#ffffff",bridges_major_casing:"#ffffff",bridges_highway_casing:"#ffffff",bridges_other:"#f5f5f5",bridges_minor:"#f5f5f5",bridges_link:"#ebebeb",bridges_medium:"#ebebeb",bridges_major:"#ebebeb",bridges_highway:"#ebebeb",roads_label_minor:"#adadad",roads_label_minor_halo:"#ffffff",roads_label_major:"#999999",roads_label_major_halo:"#ffffff",ocean_label:"#adadad",peak_label:"#adadad",subplace_label:"#8f8f8f",subplace_label_halo:"#ffffff",city_circle:"#ffffff",city_circle_stroke:"#adadad",city_label:"#5c5c5c",city_label_halo:"#ffffff",state_label:"#b3b3b3",state_label_halo:"#ffffff",country_label:"#b8b8b8"},hi={background:"#a3a3a3",earth:"#cccccc",park_a:"#c2c2c2",park_b:"#c2c2c2",hospital:"#d0d0d0",industrial:"#c6c6c6",school:"#d0d0d0",wood_a:"#c2c2c2",wood_b:"#c2c2c2",pedestrian:"#c4c4c4",scrub_a:"#c2c2c2",scrub_b:"#c2c2c2",glacier:"#d2d2d2",sand:"#d2d2d2",beach:"#d2d2d2",aerodrome:"#c9c9c9",runway:"#f5f5f5",water:"#a3a3a3",pier:"#b8b8b8",zoo:"#c7c7c7",military:"#bfbfbf",tunnel_other_casing:"#b8b8b8",tunnel_minor_casing:"#b8b8b8",tunnel_link_casing:"#b8b8b8",tunnel_medium_casing:"#b8b8b8",tunnel_major_casing:"#b8b8b8",tunnel_highway_casing:"#b8b8b8",tunnel_other:"#d6d6d6",tunnel_minor:"#d6d6d6",tunnel_link:"#d6d6d6",tunnel_medium:"#d6d6d6",tunnel_major:"#d6d6d6",tunnel_highway:"#d6d6d6",transit_pier:"#b8b8b8",buildings:"#e0e0e0",minor_service_casing:"#cccccc",minor_casing:"#cccccc",link_casing:"#cccccc",medium_casing:"#cccccc",major_casing_late:"#cccccc",highway_casing_late:"#cccccc",other:"#e0e0e0",minor_service:"#e0e0e0",minor_a:"#ebebeb",minor_b:"#e0e0e0",link:"#ebebeb",medium:"#ebebeb",major_casing_early:"#cccccc",major:"#ebebeb",highway_casing_early:"#cccccc",highway:"#ebebeb",railway:"#f5f5f5",boundaries:"#5c5c5c",waterway_label:"#7a7a7a",bridges_other_casing:"#cccccc",bridges_minor_casing:"#cccccc",bridges_link_casing:"#cccccc",bridges_medium_casing:"#cccccc",bridges_major_casing:"#cccccc",bridges_highway_casing:"#cccccc",bridges_other:"#e0e0e0",bridges_minor:"#e0e0e0",bridges_link:"#ebebeb",bridges_medium:"#ebebeb",bridges_major:"#ebebeb",bridges_highway:"#ebebeb",roads_label_minor:"#999999",roads_label_minor_halo:"#e0e0e0",roads_label_major:"#8f8f8f",roads_label_major_halo:"#ebebeb",ocean_label:"#7a7a7a",peak_label:"#5c5c5c",subplace_label:"#7a7a7a",subplace_label_halo:"#cccccc",city_circle:"#c2c2c2",city_circle_stroke:"#7a7a7a",city_label:"#474747",city_label_halo:"#cccccc",state_label:"#999999",state_label_halo:"#cccccc",country_label:"#858585"},fi={background:"#2b2b2b",earth:"#141414",park_a:"#181818",park_b:"#181818",hospital:"#1d1d1d",industrial:"#101010",school:"#111111",wood_a:"#1a1a1a",wood_b:"#1a1a1a",pedestrian:"#191919",scrub_a:"#1c1c1c",scrub_b:"#1c1c1c",glacier:"#191919",sand:"#161616",beach:"#1f1f1f",aerodrome:"#191919",runway:"#323232",water:"#333333",pier:"#0a0a0a",zoo:"#191919",military:"#121212",tunnel_other_casing:"#101010",tunnel_minor_casing:"#101010",tunnel_link_casing:"#101010",tunnel_medium_casing:"#101010",tunnel_major_casing:"#101010",tunnel_highway_casing:"#101010",tunnel_other:"#292929",tunnel_minor:"#292929",tunnel_link:"#292929",tunnel_medium:"#292929",tunnel_major:"#292929",tunnel_highway:"#292929",transit_pier:"#0a0a0a",buildings:"#0a0a0a",minor_service_casing:"#141414",minor_casing:"#141414",link_casing:"#141414",medium_casing:"#141414",major_casing_late:"#141414",highway_casing_late:"#141414",other:"#1f1f1f",minor_service:"#1f1f1f",minor_a:"#292929",minor_b:"#1f1f1f",link:"#1f1f1f",medium:"#292929",major_casing_early:"#141414",major:"#292929",highway_casing_early:"#141414",highway:"#292929",railway:"#292929",boundaries:"#707070",waterway_label:"#707070",bridges_other_casing:"#141414",bridges_minor_casing:"#141414",bridges_link_casing:"#141414",bridges_medium_casing:"#141414",bridges_major_casing:"#141414",bridges_highway_casing:"#141414",bridges_other:"#1f1f1f",bridges_minor:"#1f1f1f",bridges_link:"#292929",bridges_medium:"#292929",bridges_major:"#292929",bridges_highway:"#292929",roads_label_minor:"#525252",roads_label_minor_halo:"#141414",roads_label_major:"#5c5c5c",roads_label_major_halo:"#141414",ocean_label:"#707070",peak_label:"#707070",subplace_label:"#5c5c5c",subplace_label_halo:"#141414",city_circle:"#000000",city_circle_stroke:"#666666",city_label:"#999999",city_label_halo:"#141414",state_label:"#3d3d3d",state_label_halo:"#141414",country_label:"#707070"},ci={light:ai,dark:oi,white:li,grayscale:hi,black:fi};var ui=Et(((t,e,i)=>{let s=[];for(let r of t){let t=[];for(let s of r)t.push(s.clone().mult(e).add(i));s.push(t)}return s}),"transformGeom"),di=Et(((t,e)=>{let i=1<<e;return t<0?i+t:t>=i?t%i:t}),"wrap"),mi=class t{constructor(t,e,i){this.tileCache=t,this.maxDataLevel=e,this.levelDiff=i}dataTilesForBounds(t,e){let i=$t(2,t)/$t(2,Math.ceil(t)),s=[],r=1,n=this.tileCache.tileSize;if(t<this.levelDiff)r=1/(1<<this.levelDiff-t)*i,s.push({dataTile:{z:0,x:0,y:0},origin:new w(0,0),scale:r,dim:n*r});else if(t<=this.levelDiff+this.maxDataLevel){let r=1<<this.levelDiff,a=256*i,o=Math.ceil(t)-this.levelDiff,l=Math.floor(e.minX/r/a),h=Math.floor(e.minY/r/a),f=Math.floor(e.maxX/r/a),c=Math.floor(e.maxY/r/a);for(let t=l;t<=f;t++)for(let e=h;e<=c;e++){let l=new w(t*r*a,e*r*a);s.push({dataTile:{z:o,x:di(t,o),y:di(e,o)},origin:l,scale:i,dim:n*i})}}else{let a=1<<this.levelDiff;r=(1<<Math.ceil(t)-this.maxDataLevel-this.levelDiff)*i;let o=Math.floor(e.minX/a/256/r),l=Math.floor(e.minY/a/256/r),h=Math.floor(e.maxX/a/256/r),f=Math.floor(e.maxY/a/256/r);for(let t=o;t<=h;t++)for(let e=l;e<=f;e++){let i=new w(t*a*256*r,e*a*256*r);s.push({dataTile:{z:this.maxDataLevel,x:di(t,this.maxDataLevel),y:di(e,this.maxDataLevel)},origin:i,scale:r,dim:n*r})}}return s}dataTileForDisplayTile(t){let e,i=1,s=this.tileCache.tileSize,r;if(t.z<this.levelDiff)e={z:0,x:0,y:0},i=1/(1<<this.levelDiff-t.z),r=new w(0,0),s=s*i;else if(t.z<=this.levelDiff+this.maxDataLevel){let i=1<<this.levelDiff;e={z:t.z-this.levelDiff,x:Math.floor(t.x/i),y:Math.floor(t.y/i)},r=new w(e.x*i*256,e.y*i*256)}else{i=1<<t.z-this.maxDataLevel-this.levelDiff;let n=1<<this.levelDiff;e={z:this.maxDataLevel,x:Math.floor(t.x/n/i),y:Math.floor(t.y/n/i)},r=new w(e.x*n*i*256,e.y*n*i*256),s=s*i}return{dataTile:e,scale:i,origin:r,dim:s}}getBbox(t,e){return At(this,null,(function*(){let i=this.dataTilesForBounds(t,e);return(yield Promise.all(i.map((t=>this.tileCache.get(t.dataTile))))).map(((e,s)=>{let r=i[s];return{data:e,z:t,dataTile:r.dataTile,scale:r.scale,dim:r.dim,origin:r.origin}}))}))}getDisplayTile(t){return At(this,null,(function*(){let e=this.dataTileForDisplayTile(t);return{data:yield this.tileCache.get(e.dataTile),z:t.z,dataTile:e.dataTile,scale:e.scale,origin:e.origin,dim:e.dim}}))}queryFeatures(t,e,i,s){let r=Math.round(i),n=Math.min(r-this.levelDiff,this.maxDataLevel),a=s/(1<<r-n);return this.tileCache.queryFeatures(t,e,n,a)}};Et(mi,"View");var bi=mi,wi=Et((t=>{let e=Et((t=>{let e=t.levelDiff===void 0?1:t.levelDiff,i=t.maxDataZoom||15,s;if(typeof t.url=="string")new URL(t.url,"http://example.com").pathname.endsWith(".pmtiles")?s=new Qt(t.url,true):s=new ee(t.url,true);else if(t.url)s=new Qt(t.url,true);else throw new Error(`Invalid source ${t.url}`);let r=new be(s,256*1<<e);return new bi(r,i,e)}),"sourceToViews"),i=new Map;if(t.sources)for(let s in t.sources)i.set(s,e(t.sources[s]));else i.set("",e(t));return i}),"sourcesToViews");var _i=Et(((t,e,i)=>{let s=e/256,r=Math.floor(i.minX/256),n=Math.floor(i.minY/256),a=Math.floor(i.maxX/256),o=Math.floor(i.maxY/256),l=Math.log2(s),h=[];for(let e=r;e<=a;e++){let i=e%(1<<t);for(let e=n;e<=o;e++)h.push({display:Gt({z:t,x:i,y:e}),key:Gt({z:t-l,x:Math.floor(i/s),y:Math.floor(e/s)})})}return h}),"covering"),yi=class t{constructor(t,e){this.tree=new Tt,this.current=new Map,this.dim=t,this.maxLabeledTiles=e}hasPrefix(t){for(let e of this.current.keys())if(e.startsWith(t))return true;return false}has(t){return this.current.has(t)}size(){return this.current.size}keys(){return this.current.keys()}searchBbox(t,e){let i=new Set;for(let s of this.tree.search(t))s.indexedLabel.order<=e&&i.add(s.indexedLabel);return i}searchLabel(t,e){let i=new Set;for(let s of t.bboxes)for(let t of this.tree.search(s))t.indexedLabel.order<=e&&i.add(t.indexedLabel);return i}bboxCollides(t,e){for(let i of this.tree.search(t))if(i.indexedLabel.order<=e)return true;return false}labelCollides(t,e){for(let i of t.bboxes)for(let t of this.tree.search(i))if(t.indexedLabel.order<=e)return true;return false}deduplicationCollides(t){if(!t.deduplicationKey||!t.deduplicationDistance)return false;let e=t.deduplicationDistance,i={minX:t.anchor.x-e,minY:t.anchor.y-e,maxX:t.anchor.x+e,maxY:t.anchor.y+e};for(let s of this.tree.search(i))if(s.indexedLabel.deduplicationKey===t.deduplicationKey&&s.indexedLabel.anchor.dist(t.anchor)<e)return true;return false}makeEntry(t){this.current.get(t)&&console.log("consistency error 1");let e=new Set;this.current.set(t,e)}insert(t,e,i){let s={anchor:t.anchor,bboxes:t.bboxes,draw:t.draw,order:e,tileKey:i,deduplicationKey:t.deduplicationKey,deduplicationDistance:t.deduplicationDistance},r=this.current.get(i);if(!r){let t=new Set;this.current.set(i,t),r=t}r.add(s);let n=false,a=false;for(let e of t.bboxes)this.tree.insert({minX:e.minX,minY:e.minY,maxX:e.maxX,maxY:e.maxY,indexedLabel:s}),e.minX<0&&(n=true),e.maxX>this.dim&&(a=true);if(n||a){let s=n?this.dim:-this.dim,r=[];for(let e of t.bboxes)r.push({minX:e.minX+s,minY:e.minY,maxX:e.maxX+s,maxY:e.maxY});let a={anchor:new w(t.anchor.x+s,t.anchor.y),bboxes:r,draw:t.draw,order:e,tileKey:i},o=this.current.get(i);o&&o.add(a);for(let t of r)this.tree.insert({minX:t.minX,minY:t.minY,maxX:t.maxX,maxY:t.maxY,indexedLabel:a})}}pruneOrNoop(t){let e=t.split(":"),i,s=0,r=0;for(let t of this.current.keys()){let n=t.split(":");if(n[3]===e[3]){r++;let a=Math.sqrt($t(+n[0]-+e[0],2)+$t(+n[1]-+e[1],2));a>s&&(s=a,i=t)}i&&r>this.maxLabeledTiles&&this.pruneKey(i)}}pruneKey(t){let e=this.current.get(t);if(!e)return;let i=[];for(let t of this.tree.all())e.has(t.indexedLabel)&&i.push(t);for(let t of i)this.tree.remove(t);this.current.delete(t)}removeLabel(t){let e=[];for(let i of this.tree.all())t===i.indexedLabel&&e.push(i);for(let t of e)this.tree.remove(t);let i=this.current.get(t.tileKey);i&&i.delete(t)}};Et(yi,"Index");var pi=yi,gi=class t{constructor(t,e,i,s,r){this.index=new pi(256*1<<t,s),this.z=t,this.scratch=e,this.labelRules=i,this.callback=r}layout(t){let e=performance.now(),i=new Set;for(let[e,s]of t)for(let t of s){let s=`${Gt(t.dataTile)}:${e}`;this.index.has(s)||(this.index.makeEntry(s),i.add(s))}let s=new Set;for(let[e,r]of this.labelRules.entries()){if(r.visible===false||r.minzoom&&this.z<r.minzoom||r.maxzoom&&this.z>r.maxzoom)continue;let n=r.dataSource||"",a=t.get(n);if(a)for(let t of a){let a=`${Gt(t.dataTile)}:${n}`;if(!i.has(a))continue;let o=t.data.get(r.dataLayer);if(o===void 0)continue;let l=o;r.sort&&l.sort(((t,e)=>r.sort?r.sort(t.props,e.props):0));let h={index:this.index,zoom:this.z,scratch:this.scratch,order:e,overzoom:this.z-t.dataTile.z};for(let i of l){if(r.filter&&!r.filter(this.z,i))continue;let n=ui(i.geom,t.scale,t.origin),o=r.symbolizer.place(h,n,i);if(o)for(let i of o){let r=false;if(!(i.deduplicationKey&&this.index.deduplicationCollides(i))){if(this.index.labelCollides(i,1/0)){if(!this.index.labelCollides(i,e)){let n=this.index.searchLabel(i,1/0);for(let e of n){this.index.removeLabel(e);for(let i of e.bboxes)this.findInvalidatedTiles(s,t.dim,i,a)}this.index.insert(i,e,a),r=true}}else this.index.insert(i,e,a),r=true;if(r)for(let e of i.bboxes)(e.maxX>t.origin.x+t.dim||e.minX<t.origin.x||e.minY<t.origin.y||e.maxY>t.origin.y+t.dim)&&this.findInvalidatedTiles(s,t.dim,e,a)}}}}}for(let t of i)this.index.pruneOrNoop(t);return s.size>0&&this.callback&&this.callback(s),performance.now()-e}findInvalidatedTiles(t,e,i,s){let r=_i(this.z,e,i);for(let e of r)e.key!==s&&this.index.hasPrefix(e.key)&&t.add(e.display)}add(t){let e=true;for(let[i,s]of t)for(let t of s)this.index.has(`${Gt(t.dataTile)}:${i}`)||(e=false);return e?0:this.layout(t)}};Et(gi,"Labeler");var vi=gi,xi=class t{constructor(t,e,i,s){this.labelers=new Map,this.scratch=t,this.labelRules=e,this.maxLabeledTiles=i,this.callback=s}add(t,e){let i=this.labelers.get(t);return i||(i=new vi(t,this.scratch,this.labelRules,this.maxLabeledTiles,this.callback),this.labelers.set(t,i)),i.add(e)}getIndex(t){let e=this.labelers.get(t);if(e)return e.index}};Et(xi,"Labelers");var ki=xi;function Mi(t,e,i,s,r,n,a,o,l){let h=performance.now();t.save(),t.miterLimit=2;for(let s of r){if(s.minzoom&&e<s.minzoom||s.maxzoom&&e>s.maxzoom)continue;let r=i.get(s.dataSource||"");if(r)for(let e of r){let i=e.data.get(s.dataLayer);if(i===void 0)continue;s.symbolizer.before&&s.symbolizer.before(t,e.z);let r=e.origin,l=e.dim,h=e.scale;if(t.save(),o){t.beginPath();let e=Math.max(r.x-a.x,n.minX-a.x),i=Math.max(r.y-a.y,n.minY-a.y),s=Math.min(r.x-a.x+l,n.maxX-a.x),o=Math.min(r.y-a.y+l,n.maxY-a.y);t.rect(e,i,s-e,o-i),t.clip()}t.translate(r.x-a.x,r.y-a.y);for(let a of i){let i=a.geom,o=a.bbox;o.maxX*h+r.x<n.minX||o.minX*h+r.x>n.maxX||o.minY*h+r.y>n.maxY||o.maxY*h+r.y<n.minY||s.filter&&!s.filter(e.z,a)||(h!==1&&(i=ui(i,h,new w(0,0))),s.symbolizer.draw(t,i,e.z,a))}t.restore()}}if(o&&(t.beginPath(),t.rect(n.minX-a.x,n.minY-a.y,n.maxX-n.minX,n.maxY-n.minY),t.clip()),s){let e=s.searchBbox(n,1/0);for(let i of e)if(t.save(),t.translate(i.anchor.x-a.x,i.anchor.y-a.y),i.draw(t),t.restore(),l){t.lineWidth=.5,t.strokeStyle=l,t.fillStyle=l,t.globalAlpha=1,t.fillRect(i.anchor.x-a.x-2,i.anchor.y-a.y-2,4,4);for(let e of i.bboxes)t.strokeRect(e.minX-a.x,e.minY-a.y,e.maxX-e.minX,e.maxY-e.minY)}}return t.restore(),performance.now()-h}Et(Mi,"paint");var zi=6378137,ji=85.0511287798,Li=zi*Math.PI,Ti=Et((t=>{let e=Math.PI/180,i=Math.max(Math.min(ji,t.y),-85.0511287798),s=Math.sin(i*e);return new w(zi*t.x*e,zi*Math.log((1+s)/(1-s))/2)}),"project"),Pi=Et((t=>{let e=180/Math.PI;return{lat:(2*Math.atan(Math.exp(t.y/zi))-Math.PI/2)*e,lng:t.x*e/zi}}),"unproject"),Si=Et(((t,e)=>i=>{let s=Ti(i);return new w((s.x+Li)/(Li*2),1-(s.y+Li)/(Li*2)).mult($t(2,e)*256).sub(t)}),"instancedProject"),$i=Et(((t,e)=>i=>{let s=new w(i.x,i.y).add(t).div($t(2,e)*256),r=new w(s.x*(Li*2)-Li,(1-s.y)*(Li*2)-Li);return Pi(r)}),"instancedUnproject"),Ei=Et(((t,e)=>{let i=e*(360/t);return Math.log2(i/256)}),"getZoom"),Ai=class t{constructor(t){if(t.theme){let e=ci[t.theme];this.paintRules=ri(e),this.labelRules=ni(e),this.backgroundColor=e.background}else this.paintRules=t.paintRules||[],this.labelRules=t.labelRules||[],this.backgroundColor=t.backgroundColor;this.views=wi(t),this.debug=t.debug||""}drawContext(t,e,i,s,r){return At(this,null,(function*(){let n=Ti(s),a=new w((n.x+Li)/(Li*2),1-(n.y+Li)/(Li*2)).clone().mult($t(2,r)*256).sub(new w(e/2,i/2)),o={minX:a.x,minY:a.y,maxX:a.x+e,maxY:a.y+i},l=[];for(let[t,e]of this.views){let i=e.getBbox(r,o);l.push({key:t,promise:i})}let h=yield Promise.all(l.map((t=>t.promise.then((e=>({status:"fulfilled",value:e,key:t.key})),(e=>({status:"rejected",value:[],reason:e,key:t.key})))))),f=new Map;for(let t of h)t.status==="fulfilled"&&f.set(t.key,t.value);let c=performance.now(),u=new vi(r,t,this.labelRules,16,void 0);u.add(f);this.backgroundColor&&(t.save(),t.fillStyle=this.backgroundColor,t.fillRect(0,0,e,i),t.restore());let d=this.paintRules;Mi(t,r,f,u.index,d,o,a,true,this.debug);if(this.debug){t.save(),t.translate(-a.x,-a.y),t.strokeStyle=this.debug,t.fillStyle=this.debug,t.font="12px sans-serif";let e=0;for(let[i,s]of f){for(let r of s){t.strokeRect(r.origin.x,r.origin.y,r.dim,r.dim);let s=r.dataTile;t.fillText(`${i+(i?" ":"")+s.z} ${s.x} ${s.y}`,r.origin.x+4,r.origin.y+14*(1+e))}e++}t.restore()}return{elapsed:performance.now()-c,project:Si(a,r),unproject:$i(a,r)}}))}drawCanvas(t,e,i){return At(this,arguments,(function*(t,e,i,s={}){let r=window.devicePixelRatio,n=t.clientWidth,a=t.clientHeight;t.width===n*r&&t.height===a*r||(t.width=n*r,t.height=a*r),s.lang&&(t.lang=s.lang);let o=t.getContext("2d");if(!o){console.error("Failed to initialize canvas2d context.");return}return o.setTransform(r,0,0,r,0,0),this.drawContext(o,n,a,e,i)}))}drawContextBounds(t,e,i,s,r){return At(this,null,(function*(){let n=i.x-e.x,a=new w((e.x+i.x)/2,(e.y+i.y)/2);return this.drawContext(t,s,r,a,Ei(n,s))}))}drawCanvasBounds(t,e,i,s){return At(this,arguments,(function*(t,e,i,s,r={}){let n=i.x-e.x,a=new w((e.x+i.x)/2,(e.y+i.y)/2);return this.drawCanvas(t,a,Ei(n,s),r)}))}};Et(Ai,"Static");var Ci=Ai;var Ii=Et((t=>new Promise((e=>{setTimeout((()=>{e()}),t)}))),"timer"),Di=Et((t=>t.then((t=>({status:"fulfilled",value:t})),(t=>({status:"rejected",reason:t})))),"reflect"),Fi=Et(((t={})=>{let e=class t extends L.GridLayer{constructor(t={}){if(t.noWrap&&!t.bounds&&(t.bounds=[[-90,-180],[90,180]]),t.attribution==null&&(t.attribution='<a href="https://protomaps.com">Protomaps</a>  <a href="https://openstreetmap.org/copyright">OpenStreetMap</a>'),super(t),t.theme){let e=ci[t.theme];this.paintRules=ri(e),this.labelRules=ni(e),this.backgroundColor=e.background}else this.paintRules=t.paintRules||[],this.labelRules=t.labelRules||[],this.backgroundColor=t.backgroundColor;this.lastRequestedZ=void 0,this.tasks=t.tasks||[],this.views=wi(t),this.debug=t.debug;let e=document.createElement("canvas").getContext("2d");this.scratch=e,this.onTilesInvalidated=t=>{for(let e of t)this.rerenderTile(e)},this.labelers=new ki(this.scratch,this.labelRules,16,this.onTilesInvalidated),this.tileSize=256*window.devicePixelRatio,this.tileDelay=t.tileDelay||3,this.lang=t.lang}renderTile(t,e,i,s=()=>{}){return At(this,null,(function*(){this.lastRequestedZ=t.z;let r=[];for(let[e,i]of this.views){let s=i.getDisplayTile(t);r.push({key:e,promise:s})}let n=yield Promise.all(r.map((t=>t.promise.then((e=>({status:"fulfilled",value:e,key:t.key})),(e=>({status:"rejected",reason:e,key:t.key})))))),a=new Map;for(let t of n)t.status==="fulfilled"?a.set(t.key,[t.value]):t.reason.name==="AbortError"||console.error(t.reason);if(e.key!==i||this.lastRequestedZ!==t.z||(yield Promise.all(this.tasks.map(Di)),e.key!==i)||this.lastRequestedZ!==t.z)return;let o=this.labelers.add(t.z,a);if(e.key!==i||this.lastRequestedZ!==t.z)return;let l=this.labelers.getIndex(t.z);if(!this._map)return;let h=this._map.getCenter().wrap(),f=this._getTiledPixelBounds(h),c=this._pxBoundsToTileRange(f).getCenter(),u=t.distanceTo(c)*this.tileDelay;if(yield Ii(u),e.key!==i||this.lastRequestedZ!==t.z)return;let d=16,m={minX:256*t.x-d,minY:256*t.y-d,maxX:256*(t.x+1)+d,maxY:256*(t.y+1)+d},b=new w(256*t.x,256*t.y);e.width=this.tileSize,e.height=this.tileSize;let _=e.getContext("2d");if(!_){console.error("Failed to get Canvas context");return}_.setTransform(this.tileSize/256,0,0,this.tileSize/256,0,0),_.clearRect(0,0,256,256),this.backgroundColor&&(_.save(),_.fillStyle=this.backgroundColor,_.fillRect(0,0,256,256),_.restore());let y=0,p=this.paintRules;if(y=Mi(_,t.z,a,this.xray?null:l,p,m,b,false,this.debug),this.debug){_.save(),_.fillStyle=this.debug,_.font="600 12px sans-serif",_.fillText(`${t.z} ${t.x} ${t.y}`,4,14),_.font="12px sans-serif";let e=28;for(let[t,i]of a){let s=i[0].dataTile;_.fillText(`${t+(t?" ":"")+s.z} ${s.x} ${s.y}`,4,e),e+=14}_.font="600 10px sans-serif",y>8&&(_.fillText(`${y.toFixed()} ms paint`,4,e),e+=14),o>8&&_.fillText(`${o.toFixed()} ms layout`,4,e),_.strokeStyle=this.debug,_.lineWidth=.5,_.beginPath(),_.moveTo(0,0),_.lineTo(0,256),_.stroke(),_.lineWidth=.5,_.beginPath(),_.moveTo(0,0),_.lineTo(256,0),_.stroke(),_.restore()}s()}))}rerenderTile(t){for(let e in this._tiles){let i=this._wrapCoords(this._keyToTileCoords(e));t===this._tileCoordsToKey(i)&&this.renderTile(i,this._tiles[e].el,t)}}queryTileFeaturesDebug(t,e,i=16){let s=new Map;for(let[r,n]of this.views)s.set(r,n.queryFeatures(t,e,this._map.getZoom(),i));return s}clearLayout(){this.labelers=new ki(this.scratch,this.labelRules,16,this.onTilesInvalidated)}rerenderTiles(){for(let t in this._tiles){let e=this._wrapCoords(this._keyToTileCoords(t)),i=this._tileCoordsToKey(e);this.renderTile(e,this._tiles[t].el,i)}}createTile(t,e){let i=L.DomUtil.create("canvas","leaflet-tile");i.lang=this.lang;let s=this._tileCoordsToKey(t);return i.key=s,this.renderTile(t,i,s,(()=>{e(void 0,i)})),i}_removeTile(t){let e=this._tiles[t];e&&(e.el.removed=true,e.el.key=void 0,L.DomUtil.removeClass(e.el,"leaflet-tile-loaded"),e.el.width=e.el.height=0,L.DomUtil.remove(e.el),delete this._tiles[t],this.fire("tileunload",{tile:e.el,coords:this._keyToTileCoords(t)}))}};Et(e,"LeafletLayer");let i=e;return new i(t)}),"leafletLayer");var Bi=Et(((t,e,i)=>{let s=new FontFace(t,`url(${e})`,{weight:i});return document.fonts.add(s),s.load()}),"Font"),Ri=Et((t=>At(void 0,null,(function*(){return new Promise(((e,i)=>{let s=new Image;s.onload=()=>e(s),s.onerror=()=>i("Invalid SVG"),s.src=t}))}))),"mkimg"),Ni=`\n<svg width="20px" height="20px" viewBox="0 0 50 50" version="1.1" xmlns="http://www.w3.org/2000/svg">\n    <rect width="50" height="50" fill="#cccccc"/>\n    <g transform="translate(5,5)">\n        <path fill="none" stroke="#666666" stroke-width="7" d="m11,12a8.5,8 0 1,1 17,0q0,4-4,6t-4.5,4.5-.4,4v.2m0,3v7"/>\n    </g>\n</svg>\n`,Vi=class t{constructor(t){this.src=t,this.canvas=document.createElement("canvas"),this.mapping=new Map,this.missingBox={x:0,y:0,w:0,h:0}}load(){return At(this,null,(function*(){let t=this.src,e=window.devicePixelRatio;t.endsWith(".html")&&(t=yield(yield fetch(t)).text());let i=(new window.DOMParser).parseFromString(t,"text/html"),s=Array.from(i.body.children),r=yield Ri(`data:image/svg+xml;base64,${btoa(Ni)}`),n=[{w:r.width*e,h:r.height*e,img:r,id:""}],a=new XMLSerializer;for(let t of s){let i=`data:image/svg+xml;base64,${btoa(a.serializeToString(t))}`,s=yield Ri(i);n.push({w:s.width*e,h:s.height*e,img:s,id:t.id})}let o=Pt(n);this.canvas.width=o.w,this.canvas.height=o.h;let l=this.canvas.getContext("2d");if(l)for(let t of n)t.x!==void 0&&t.y!==void 0&&(l.drawImage(t.img,t.x,t.y,t.w,t.h),t.id?this.mapping.set(t.id,{x:t.x,y:t.y,w:t.w,h:t.h}):this.missingBox={x:t.x,y:t.y,w:t.w,h:t.h});return this}))}get(t){let e=this.mapping.get(t);return e||(e=this.missingBox),e}};Et(Vi,"Sheet");var Ui=Vi;var Oi=Object.freeze({__proto__:null,CenteredSymbolizer:Ue,CenteredTextSymbolizer:He,CircleSymbolizer:Ae,FlexSymbolizer:Fe,Font:Bi,GeomType:Ht,GroupSymbolizer:Ne,IconSymbolizer:$e,Index:pi,Justify:we,Labeler:vi,Labelers:ki,LineLabelPlacement:Qe,LineLabelSymbolizer:ei,LineSymbolizer:Pe,OffsetSymbolizer:We,OffsetTextSymbolizer:Ke,Padding:Xe,PmtilesSource:Qt,PolygonSymbolizer:ge,Sheet:Ui,ShieldSymbolizer:Ie,Static:Ci,TextPlacements:_e,TextSymbolizer:Ye,TileCache:be,View:bi,ZxySource:ee,arr:ve,covering:_i,createPattern:ye,exp:ze,getZoom:Ei,isCcw:fe,isInRing:he,labelRules:ni,leafletLayer:Fi,linear:Le,paint:Mi,paintRules:ri,pointInPolygon:ce,pointMinDistToLines:de,pointMinDistToPoints:ue,sourcesToViews:wi,step:je,toIndex:Gt,transformGeom:ui,wrap:di});const Xi={GridLayer:t.GridLayer,DomUtil:t.DomUtil};window.L=Xi;window.protomapsL=Oi;var qi=t.Layer.extend({initialize:function(e,i){this._template=e;this._container=t.DomUtil.create("div","leaflet-layer mapml-pmtiles-container");this._pmtilesOptions={pane:this._container,maxDataZoom:e.zoom?.max??15,url:this._mapInputNamesToProtomapsUrl(e),noWrap:true};let s=i?.pmtilesRules?.get(this._template.template);if(s?.rules){t.extend(this._pmtilesOptions,{paintRules:s.rules.PAINT_RULES});t.extend(this._pmtilesOptions,{labelRules:s.rules.LABEL_RULES});if(s.sheet){t.extend(this._pmtilesOptions,{tasks:[s.sheet.load()]})}}else if(s?.theme?.theme){t.extend(this._pmtilesOptions,{theme:s.theme.theme})}else{console.warn("pmtiles symbolizer rules or theme not found for map-link@tref ->  "+this._template.template)}this.zoomBounds=i.zoomBounds;this.extentBounds=i.extentBounds;delete i.zoomBounds;delete i.extentBounds;this._linkEl=i.linkEl;t.setOptions(this,i)},_mapInputNamesToProtomapsUrl:function(t){let e=t.template;let i=new RegExp(t.zoom?.name?"{"+t.zoom.name+"}":"{z}","ig");e=e.replace(i,"{z}");let s=t.values.find((t=>t.type==="location"&&t.axis==="row"))?.name;i=new RegExp(s?"{"+s+"}":"{y}","ig");e=e.replace(i,"{y}");let r=t.values.find((t=>t.type==="location"&&t.axis==="column"))?.name;i=new RegExp(r?"{"+r+"}":"{x}","ig");e=e.replace(i,"{x}");return e},onAdd:function(t){this._map=t;this.options.pane.appendChild(this._container);this.setZIndex(this.options.zIndex);this._pmtilesLayer=Fi(this._pmtilesOptions).addTo(t)},onRemove:function(e){this._pmtilesLayer.remove();t.DomUtil.remove(this._container)},isVisible:function(){if(this._template.projection!=="OSMTILE")return false;let t=this._linkEl.getMapEl()._map;let i=t.getZoom();let s=e.pixelToPCRSBounds(t.getPixelBounds(),i,t.options.projection);return i<=this.zoomBounds.maxZoom&&i>=this.zoomBounds.minZoom&&this.extentBounds.overlaps(s)},setZIndex:function(t){this.options.zIndex=t;if(this._container&&this.options.zIndex!==undefined&&this.options.zIndex!==null){this._container.style.zIndex=this.options.zIndex}return this}});var Yi=function(t,e){return new qi(t,e)};const Zi=class{constructor(t){r(this,t)}get el(){return n(this)}type;get typeValue(){return this.type||"image/*"}rel;href;hreflang;tref;get trefValue(){return this.tref||M.BLANK_TT_TREF}media;tms;projection;disabled;_templatedLayer;_templateVars;_alternate;_styleOption;_stylesheetHost;_pmtilesRules;_mql;_changeHandler;_layerRegistry=new Map;parentExtent;mapEl;zoomInput;zIndex;link;typeChanged(t,e){}relChanged(t,e){}hrefChanged(t,e){}hreflangChanged(t,e){}trefChanged(t,e){if(e!==t){this._initTemplateVars()}}mediaChanged(t,e){if(e!==t){this._registerMediaQuery(t)}}tmsChanged(t,e){}projectionChanged(t,e){}disabledChanged(t){if(t){this._disableLink()}else{this._enableLink()}}get extent(){return this._templateVars?Object.assign(e._convertAndFormatPCRS(this.getBounds(),M[this.parentExtent.units],this.parentExtent.units),{zoom:this.getZoomBounds()}):null}getMapEl(){return e.getClosest(this.el,"gcds-map")}getLayerEl(){return e.getClosest(this.el,"map-layer,layer-")}getBase(){const t=this.el.getRootNode();if(t instanceof ShadowRoot){const e=t.querySelector("map-base[href]");if(e){return e.getAttribute("href")}const i=t.host;return new URL(i.src,i.baseURI).href}const e=this.el.getRootNode().querySelector("map-base[href]");return e?e.getAttribute("href"):this.el.baseURI}async connectedCallback(){if(this.getLayerEl()?.hasAttribute("data-moving")||this.parentExtent&&this.parentExtent.hasAttribute("data-moving"))return;this.el._layerRegistry=this._layerRegistry;this.el.getMapEl=this.getMapEl.bind(this);this.el.getLayerEl=this.getLayerEl.bind(this);this.el.zoomTo=this.zoomTo.bind(this);this.el.getZoomBounds=this.getZoomBounds.bind(this);this.el.getBounds=this.getBounds.bind(this);this.el.isVisible=this.isVisible.bind(this);this.el.getLayerControlOption=this.getLayerControlOption.bind(this);Object.defineProperty(this.el,"extent",{get:()=>this.extent,configurable:true,enumerable:true});switch(this.rel?.toLowerCase()){case"tile":case"image":case"features":case"query":if(!this.disabled){this._initTemplateVars();await this._createTemplatedLink()}break;case"style":case"self":case"style self":case"self style":this._createSelfOrStyleLink();break;case"zoomin":case"zoomout":break;case"legend":break;case"stylesheet":if(!this.disabled){this._createStylesheetLink()}break;case"alternate":this._createAlternateLink();break}await this._registerMediaQuery(this.media)}disconnectedCallback(){switch(this.rel?.toLowerCase()){case"stylesheet":if(this._stylesheetHost){this.link?.remove()}break}this._layerRegistry.clear()}_disableLink(){switch(this.rel?.toLowerCase()){case"tile":case"image":case"features":if(this._templatedLayer&&this.parentExtent?._extentLayer?.hasLayer(this._templatedLayer)){this.parentExtent._extentLayer.removeLayer(this._templatedLayer);delete this._templatedLayer;if(this.el.shadowRoot){this.el.shadowRoot.innerHTML=""}this.getLayerEl()?._validateDisabled()}break;case"query":delete this._templateVars;if(this.el.shadowRoot){this.el.shadowRoot.innerHTML=""}this.getLayerEl()?._validateDisabled();break;case"stylesheet":delete this._pmtilesRules;delete this._stylesheetHost;if(this.link){this.link.remove();delete this.link}break}}async _enableLink(){switch(this.rel?.toLowerCase()){case"tile":case"image":case"features":case"query":this._initTemplateVars();await this._createTemplatedLink();this.getLayerEl()?._validateDisabled();break;case"stylesheet":this._createStylesheetLink();break}}async _registerMediaQuery(t){if(!this._changeHandler){this._changeHandler=()=>{this.disabled=!this._mql.matches}}if(t){const e=this.getMapEl();if(!e)return;await e.whenReady();if(this._mql){this._mql.removeEventListener("change",this._changeHandler)}this._mql=e.matchMedia(t);this._changeHandler();this._mql.addEventListener("change",this._changeHandler)}else if(this._mql){this._mql.removeEventListener("change",this._changeHandler);delete this._mql;this.disabled=false}}_createAlternateLink(){if(this.href&&this.projection)this._alternate=true}_createStylesheetLink(){if(this.type==="application/pmtiles+stylesheet"){const t=new URL(this.href,this.getBase()).href;import(t).then((t=>t.pmtilesRulesReady)).then((t=>{this._pmtilesRules=t;this.el._pmtilesRules=t})).catch((t=>{console.error("Error importing pmtiles symbolizer rules or theme: \n"+t)}))}else{this._stylesheetHost=this.el.getRootNode()instanceof ShadowRoot?this.el.getRootNode().host:this.el.parentElement;if(this._stylesheetHost===undefined)return;this.link=document.createElement("link");this.el.link=this.link;this.link.mapLink=this.el;this.link.setAttribute("href",new URL(this.href,this.getBase()).href);this._copyAttributes(this.el,this.link);this.link.disabled=this.disabled||false;if(this._stylesheetHost._layer){this._stylesheetHost._layer.renderStyles(this.el)}else if(this._stylesheetHost._templatedLayer){this._stylesheetHost._templatedLayer.renderStyles(this.el)}else if(this._stylesheetHost._extentLayer){this._stylesheetHost._extentLayer.renderStyles(this.el)}}}_copyAttributes(t,e){Array.from(t.attributes).forEach((t=>{if(t.nodeName!=="href"&&t.nodeName!=="media"&&t.nodeName!=="disabled")e.setAttribute(t.nodeName,t.nodeValue)}))}async _createTemplatedLink(){this.parentExtent=this.el.parentNode?.nodeName.toUpperCase()==="MAP-EXTENT"?this.el.parentNode:this.el.parentNode?.host;if(this.disabled||!this.parentExtent){return}try{await this.parentExtent.whenReady();await(this._templateVars?.inputsReady)}catch(t){console.log("Error while creating templated link: "+t);return}this.mapEl=this.getMapEl();this.zIndex=Array.from(this.parentExtent.querySelectorAll("map-link[rel=image],map-link[rel=tile],map-link[rel=features]")).indexOf(this.el);if(this.rel==="tile"&&this.type==="application/pmtiles"||this.type==="application/vnd.mapbox-vector-tile"){const t='map-link[rel="stylesheet"][type="application/pmtiles+stylesheet"]:not([disabled])';let i=this.getLayerEl()?.src?this.el.closest("map-extent")?.querySelector(t)??this.el.getRootNode().querySelector(":host > "+t):e.getClosest(this.el,"map-extent:has("+t+"),map-layer:has("+t+"),layer-:has("+t+")")?.querySelector(t);if(i){await i.whenReady();const t={zoomBounds:this.getZoomBounds(),extentBounds:this.getBounds(),crs:M[this.parentExtent.units],zIndex:this.zIndex,pane:this.parentExtent._extentLayer.getContainer(),linkEl:this.el,pmtilesRules:i?._pmtilesRules};this._templatedLayer=Yi(this._templateVars,t).addTo(this.parentExtent._extentLayer);this.el._templatedLayer=this._templatedLayer}else{console.warn("Stylesheet not found for "+this._templateVars.template)}}else if(this.rel==="tile"){this._templatedLayer=d(this._templateVars,{zoomBounds:this.getZoomBounds(),extentBounds:this.getBounds(),crs:M[this.parentExtent.units],errorTileUrl:"data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==",zIndex:this.zIndex,pane:this.parentExtent._extentLayer.getContainer(),linkEl:this.el}).addTo(this.parentExtent._extentLayer);this.el._templatedLayer=this._templatedLayer}else if(this.rel==="image"){this._templatedLayer=c(this._templateVars,{zoomBounds:this.getZoomBounds(),extentBounds:this.getBounds(),zIndex:this.zIndex,pane:this.parentExtent._extentLayer.getContainer(),linkEl:this.el}).addTo(this.parentExtent._extentLayer);this.el._templatedLayer=this._templatedLayer}else if(this.rel==="features"){if(!this.el.shadowRoot){this.el.attachShadow({mode:"open"})}this._templatedLayer=b(this._templateVars,{zoomBounds:this.getZoomBounds(),extentBounds:this.getBounds(),zIndex:this.zIndex,pane:this.parentExtent._extentLayer.getContainer(),linkEl:this.el,projection:this.mapEl._map.options.projection}).addTo(this.parentExtent._extentLayer);this.el._templatedLayer=this._templatedLayer}else if(this.rel==="query"){if(!this.el.shadowRoot){this.el.attachShadow({mode:"open"})}Object.assign(this._templateVars,this._setupQueryVars(this._templateVars));Object.assign(this._templateVars,{extentBounds:this.getBounds()})}}_setupQueryVars(t){const e={query:{}};const i=t.values;for(let s=0;s<t.values.length;s++){const t=i[s].getAttribute("type");const r=i[s].getAttribute("units");const n=i[s].getAttribute("axis");const a=i[s].getAttribute("name");const o=i[s].getAttribute("position");const l=i[s].getAttribute("rel");const h=i[s].tagName.toLowerCase()==="map-select";if(t==="width"){e.query.width=a}else if(t==="height"){e.query.height=a}else if(t==="location"){switch(n){case"x":case"y":case"column":case"row":e.query[n]=a;break;case"longitude":case"easting":if(o){if(o.match(/.*?-left/i)){if(l==="pixel"){e.query.pixelleft=a}else if(l==="tile"){e.query.tileleft=a}else{e.query.mapleft=a}}else if(o.match(/.*?-right/i)){if(l==="pixel"){e.query.pixelright=a}else if(l==="tile"){e.query.tileright=a}else{e.query.mapright=a}}}else{e.query[n]=a}break;case"latitude":case"northing":if(o){if(o.match(/top-.*?/i)){if(l==="pixel"){e.query.pixeltop=a}else if(l==="tile"){e.query.tiletop=a}else{e.query.maptop=a}}else if(o.match(/bottom-.*?/i)){if(l==="pixel"){e.query.pixelbottom=a}else if(l==="tile"){e.query.tilebottom=a}else{e.query.mapbottom=a}}}else{e.query[n]=a}break;case"i":if(r==="tile"){e.query.tilei=a}else{e.query.mapi=a}break;case"j":if(r==="tile"){e.query.tilej=a}else{e.query.mapj=a}break}}else if(t==="zoom"){e.query.zoom=a}else if(h){const t=i[s].htmlselect;e.query[a]=function(){return t.value}}else{const t=i[s];e.query[a]=function(){return t.getAttribute("value")}}}return e}_initTemplateVars(){const t=new RegExp("(?:{)(.*?)(?:})","g");const e=this.el.parentElement?.querySelector('map-input[type="zoom" i]');let i=false;let s;let r=this.trefValue;if(r===M.BLANK_TT_TREF){const t=this.el.parentElement?.querySelectorAll("map-input");if(t){t.forEach((t=>{r+=`{${t.getAttribute("name")}}`}))}}this.zoomInput=e;this.el.zoomInput=e;let n;const a=r.match(t)||[];const o=[];const l=[];while((n=t.exec(r))!==null){const t=n[1];const e=this.el.parentElement?.querySelector(`map-input[name=${t}],map-select[name=${t}]`);if(e){o.push(e);l.push(e.whenReady());if(e.hasAttribute("type")&&e.getAttribute("type").toLowerCase()==="zoom"){s=e;i=true}}else{console.log("input with name="+t+" not found for template variable of same name")}}if(r&&a.length===o.length){if(!i&&e){o.push(e);l.push(e.whenReady());s=e}const t=e?e.getAttribute("step"):1;let n=t;if(!t||t==="0"||isNaN(t))n=1;this._templateVars={template:decodeURI(new URL(r,this.getBase()).href),linkEl:this.el,rel:this.rel,type:this.typeValue,values:o,inputsReady:Promise.allSettled(l),zoom:s,projection:this.el.parentElement?.getAttribute("units"),tms:this.tms,step:n};this.el._templateVars=this._templateVars}}getZoomBounds(){return this._getZoomBounds(this._templateVars?.zoom)}_getZoomBounds(t){const i={};const s=this.el.parentElement?.getMeta?.("zoom");const r=s?+e._metaContentToObject(s.getAttribute("content"))?.min:null;i.minZoom=r||(t?+t.getAttribute("min"):0);i.minNativeZoom=t?+t.getAttribute("min"):i.minZoom;const n=s?+e._metaContentToObject(s.getAttribute("content"))?.max:null;i.maxZoom=n||(t?+t.getAttribute("max"):M[this.el.parentElement?.getAttribute("units")]?.options.resolutions.length-1);i.maxNativeZoom=t?+t.getAttribute("max"):i.maxZoom;return i}getBounds(){const t=this._templateVars;if(!t)return null;const i=t.values;const s=this.el.parentElement?.getAttribute("units");const r={};r.name=M.FALLBACK_CS;let n=M[s].options.crs.tilematrix.bounds(0);let a=false;for(let t=0;t<i.length;t++){if(i[t].getAttribute("type")==="location"){if(!i[t].getAttribute("max")||!i[t].getAttribute("min"))continue;const s=+i[t].getAttribute("max");const a=+i[t].getAttribute("min");switch(i[t].getAttribute("axis")?.toLowerCase()){case"x":case"longitude":case"column":case"easting":r.name=e.axisToCS(i[t].getAttribute("axis").toLowerCase());n.min.x=a;n.max.x=s;r.horizontalAxis=i[t].getAttribute("axis").toLowerCase();break;case"y":case"latitude":case"row":case"northing":r.name=e.axisToCS(i[t].getAttribute("axis").toLowerCase());n.min.y=a;n.max.y=s;r.verticalAxis=i[t].getAttribute("axis").toLowerCase();break}}}if(r.horizontalAxis&&r.verticalAxis&&(r.horizontalAxis==="x"&&r.verticalAxis==="y"||r.horizontalAxis==="longitude"&&r.verticalAxis==="latitude"||r.horizontalAxis==="column"&&r.verticalAxis==="row"||r.horizontalAxis==="easting"&&r.verticalAxis==="northing")){a=true}if(a){const t=this._templateVars.zoom?.hasAttribute("value")?+this._templateVars.zoom.getAttribute("value"):0;n=e.boundsToPCRSBounds(n,t,s,r.name)}else if(!a){n=this.getFallbackBounds(s)}return n}getFallbackBounds(i){let s;let r=0;const n=this.el.parentElement?.getMeta?.("extent");if(n){const a=e._metaContentToObject(n.getAttribute("content"));let o;r=a.zoom||r;const l=Object.keys(a);for(let t=0;t<l.length;t++){if(!l[t].includes("zoom")){o=e.axisToCS(l[t].split("-")[2]);break}}const h=e.csToAxes(o);s=e.boundsToPCRSBounds(t.bounds(t.point(+a[`top-left-${h[0]}`],+a[`top-left-${h[1]}`]),t.point(+a[`bottom-right-${h[0]}`],+a[`bottom-right-${h[1]}`])),r,i,o)}else{const t=M[i];s=t?.options.crs.pcrs.bounds}return s}isVisible(){if(this.disabled)return false;let e=false;const i=this.getMapEl();const s=i?.zoom;const r=i?.extent;if(!r)return false;const n=r.topLeft.pcrs.horizontal;const a=r.bottomRight.pcrs.horizontal;const o=r.bottomRight.pcrs.vertical;const l=r.topLeft.pcrs.vertical;const h=t.bounds(t.point(n,o),t.point(a,l));if(this._templatedLayer){e=this._templatedLayer.isVisible()}else if(this.rel==="query"){const t=this.extent?.zoom.minZoom;const i=this.extent?.zoom.maxZoom;const r=e=>t<=e&&e<=i;const n=this.getBounds();if(n?.overlaps(h)&&r(s)){e=true}}return e}zoomTo(){const i=this.extent;if(!i)return;const s=this.getMapEl()._map;const r=i.topLeft.pcrs.horizontal;const n=i.bottomRight.pcrs.horizontal;const a=i.bottomRight.pcrs.vertical;const o=i.topLeft.pcrs.vertical;const l=t.bounds(t.point(r,a),t.point(n,o));const h=s.options.crs.unproject(l.getCenter(true));const f=i.zoom.maxZoom;const c=i.zoom.minZoom;s.setView(h,e.getMaxZoom(l,s,c,f),{animate:false})}_createSelfOrStyleLink(){const e=this.getLayerEl();const i=function(i){t.DomEvent.stop(i);e.dispatchEvent(new CustomEvent("changestyle",{detail:{src:i.target.getAttribute("data-href")}}))};const s=document.createElement("div");const r=s.appendChild(document.createElement("input"));r.setAttribute("type","radio");r.setAttribute("id","rad-"+t.stamp(r));r.setAttribute("name","styles-"+t.stamp(s));r.setAttribute("value",this.el.getAttribute("title"));r.setAttribute("data-href",new URL(this.href,this.getBase()).href);const n=s.appendChild(document.createElement("label"));n.setAttribute("for","rad-"+t.stamp(r));n.innerText=this.el.getAttribute("title");if(this.rel==="style self"||this.rel==="self style"){r.checked=true}this._styleOption=s;r.addEventListener("click",i.bind(this))}getLayerControlOption(){return this._styleOption}resolve(){if(this.trefValue!==M.BLANK_TT_TREF){const e={};const i=this.el.parentElement?.querySelectorAll("map-input");if(this.rel==="image"){for(let t=0;t<i.length;t++){const s=i[t];e[s.getAttribute("name")]=s.value}return t.Util.template(this.trefValue,e)}else if(this.rel==="tile"){return e}else;}}async whenReady(){return new Promise(((t,e)=>{let i,s,r;switch(this.rel?.toLowerCase()){case"tile":case"image":case"features":r="_templatedLayer";if(this.disabled)t();break;case"style":case"self":case"style self":case"self style":r="_styleOption";break;case"query":r="shadowRoot";if(this.disabled)t();break;case"alternate":r="_alternate";break;case"stylesheet":if(this.type==="application/pmtiles+stylesheet"){r="_pmtilesRules"}else{r="_stylesheetHost"}break;case"zoomin":case"zoomout":case"legend":case"license":t();return;default:t();return}if(this[r]){t();return}i=setInterval(n,300,this);s=setTimeout(a,1e3);function n(n){if(n.el[r]){clearInterval(i);clearTimeout(s);t()}else if(!n.el.isConnected){clearInterval(i);clearTimeout(s);e("map-link was disconnected while waiting to be ready")}}function a(){clearInterval(i);clearTimeout(s);e("Timeout reached waiting for link to be ready")}}))}render(){return null}static get watchers(){return{type:["typeChanged"],rel:["relChanged"],href:["hrefChanged"],hreflang:["hreflangChanged"],tref:["trefChanged"],media:["mediaChanged"],tms:["tmsChanged"],projection:["projectionChanged"],disabled:["disabledChanged"]}}};export{Zi as map_link};
//# sourceMappingURL=p-e941f8fd.entry.js.map