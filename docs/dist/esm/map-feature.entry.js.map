{"version":3,"file":"map-feature.entry.js","sources":["src/components/map-feature/map-feature.tsx"],"sourcesContent":["import { Component, Element, Prop, Watch, Method } from '@stencil/core';\nimport { bounds, point, extend } from 'leaflet';\n\nimport { MapFeatureLayer } from '../utils/mapml/layers/MapFeatureLayer.js';\nimport { featureRenderer } from '../utils/mapml/features/featureRenderer.js';\nimport { Util } from '../utils/mapml/Util.js';\nimport proj4 from 'proj4';\nimport { calculatePosition } from '../utils/mapml/elementSupport/layers/calculatePosition.js';\n\ndeclare const M: any;\n\n@Component({\n  tag: 'map-feature',\n  shadow: true\n})\nexport class MapFeature {\n  @Element() el: HTMLElement;\n\n  @Prop({ reflect: false, mutable: true }) zoom?: number;\n  @Prop({ reflect: true, mutable: true }) min?: number;\n  @Prop({ reflect: true, mutable: true }) max?: number;\n\n  _featureLayer: any;\n  _geometry: any;\n  _groupEl: any;\n  _observer: MutationObserver;\n  _parentEl: any;\n  _initialZoom: number;\n  _getFeatureExtent: any;\n\n  @Watch('zoom')\n  zoomChanged(newValue: number, oldValue: number) {\n    if (oldValue !== newValue && this._featureLayer) {\n      this.reRender(this._featureLayer);\n    }\n  }\n\n  @Watch('min')\n  minChanged(newValue: number, oldValue: number) {\n    if (oldValue !== newValue && this._featureLayer) {\n      this.reRender(this._featureLayer);\n    }\n  }\n\n  @Watch('max')\n  maxChanged(newValue: number, oldValue: number) {\n    if (oldValue !== newValue && this._featureLayer) {\n      this.reRender(this._featureLayer);\n    }\n  }\n\n  get zoomValue(): number {\n    // for templated or queried features ** native zoom is only used for zoomTo() **\n    let meta = {},\n      metaEl = this.getMeta('zoom');\n    if (metaEl)\n      meta = Util._metaContentToObject(metaEl.getAttribute('content'));\n    if (this._parentEl?.nodeName === 'MAP-LINK') {\n      // nativeZoom = zoom attribute || (sd.map-meta zoom 'value'  || 'max') || this._initialZoom\n      return +(this.el.hasAttribute('zoom')\n        ? this.el.getAttribute('zoom')\n        : meta['value']\n        ? meta['value']\n        : meta['max']\n        ? meta['max']\n        : this._initialZoom ?? this.getMapEl()?.zoom ?? 0);\n    } else {\n      // for \"static\" features\n      // nativeZoom zoom attribute || this._initialZoom\n      return +(this.el.hasAttribute('zoom')\n        ? this.el.getAttribute('zoom')\n        : this._initialZoom ?? this.getMapEl()?.zoom ?? 0);\n    }\n  }\n\n  get minValue(): number {\n    // for templated or queried features\n    let meta = {},\n      metaEl = this.getMeta('zoom');\n    if (metaEl)\n      meta = Util._metaContentToObject(metaEl.getAttribute('content'));\n    let projectionMinZoom = 0;\n    if (this._parentEl?.nodeName === 'MAP-LINK') {\n      // minZoom = min attribute || sd.map-meta min zoom || map-link minZoom\n      return +(this.el.hasAttribute('min')\n        ? this.el.getAttribute('min')\n        : meta['min']\n        ? meta['min']\n        : this._parentEl.getZoomBounds().minZoom);\n    } else {\n      // for \"static\" features\n      // minZoom = min attribute || map-meta zoom || projection minZoom\n      return +(this.el.hasAttribute('min')\n        ? this.el.getAttribute('min')\n        : meta['min']\n        ? meta['min']\n        : projectionMinZoom);\n    }\n  }\n\n  get maxValue(): number {\n    // for templated or queried features\n    let meta = {},\n      metaEl = this.getMeta('zoom');\n    if (metaEl)\n      meta = Util._metaContentToObject(metaEl.getAttribute('content'));\n    let projectionMaxZoom =\n      this.getMapEl()?._map?.options.crs.options.resolutions.length - 1;\n    if (this._parentEl?.nodeName === 'MAP-LINK') {\n      // maxZoom = max attribute || sd.map-meta max zoom || map-link maxZoom\n      return +(this.el.hasAttribute('max')\n        ? this.el.getAttribute('max')\n        : meta['max']\n        ? meta['max']\n        : this._parentEl.getZoomBounds().maxZoom);\n    } else {\n      // for \"static\" features\n      // maxZoom = max attribute || map-meta zoom max || projection maxZoom\n      return +(this.el.hasAttribute('max')\n        ? this.el.getAttribute('max')\n        : meta['max']\n        ? meta['max']\n        : projectionMaxZoom);\n    }\n  }\n\n  get extent() {\n    if (this.el.isConnected) {\n      // if the feature extent is the first time to be calculated or the feature extent is changed\n      if (!this._getFeatureExtent) {\n        this._getFeatureExtent = this._memoizeExtent();\n      }\n      return this._getFeatureExtent();\n    }\n  }\n\n  get position() {\n    return calculatePosition(this.el);\n  }\n\n  getMapEl() {\n    return Util.getClosest(this.el, 'gcds-map');\n  }\n\n  getLayerEl() {\n    return Util.getClosest(this.el, 'map-layer,layer-');\n  }\n\n  async connectedCallback() {\n    // set the initial zoom of the map when features connected\n    // used for fallback zoom getter for static features\n    this._initialZoom = this.getMapEl()?.zoom;\n    this._parentEl =\n      this.el.parentNode?.nodeName === 'MAP-LAYER' ||\n      this.el.parentNode?.nodeName === 'LAYER-' ||\n      this.el.parentNode?.nodeName === 'MAP-LINK'\n        ? this.el.parentNode\n        : (this.el.parentNode as any)?.host;\n\n    if (\n      this.getLayerEl()?.hasAttribute('data-moving') ||\n      this._parentEl?.parentElement?.hasAttribute('data-moving')\n    )\n      return;\n\n    // Publish MapML compatibility methods on element\n    (this.el as any).getMapEl = this.getMapEl.bind(this);\n    (this.el as any).getLayerEl = this.getLayerEl.bind(this);\n    (this.el as any).zoomTo = this.zoomTo.bind(this);\n    (this.el as any).getZoomToZoom = this.getZoomToZoom.bind(this);\n    (this.el as any).click = this.click.bind(this);\n    (this.el as any).focus = this.focus.bind(this);\n    (this.el as any).blur = this.blur.bind(this);\n    (this.el as any).mapml2geojson = this.mapml2geojson.bind(this);\n    (this.el as any).addFeature = this.addFeature.bind(this);\n    (this.el as any).removeFeature = this.removeFeature.bind(this);\n    (this.el as any).reRender = this.reRender.bind(this);\n\n    Object.defineProperty(this.el, 'zoom', {\n        get: () => this.zoomValue,\n        configurable: true,\n        enumerable: true\n    });\n\n    Object.defineProperty(this.el, 'extent', {\n      get: () => this.extent,\n      configurable: true,\n      enumerable: true\n    });\n\n    Object.defineProperty(this.el, 'position', {\n      get: () => this.position,\n      configurable: true,\n      enumerable: true\n    });\n\n    // Note: zoom, min, max are already exposed as @Prop with reflect: true\n    // so they don't need Object.defineProperty - they're already accessible on the element\n\n    if (\n      this._parentEl?.nodeName === 'MAP-LAYER' ||\n      this._parentEl?.nodeName === 'LAYER-' ||\n      this._parentEl?.nodeName === 'MAP-LINK'\n    ) {\n      this._createOrGetFeatureLayer();\n    }\n\n    // Expose properties on DOM element for MapML compatibility\n    Object.defineProperty(this.el, '_featureLayer', {\n      get: () => this._featureLayer,\n      configurable: true,\n      enumerable: true\n    });\n\n    Object.defineProperty(this.el, '_geometry', {\n      get: () => this._geometry,\n      configurable: true,\n      enumerable: true\n    });\n    // use observer to monitor the changes in mapFeature's subtree\n    this._observer = new MutationObserver((mutationList) => {\n      for (let mutation of mutationList) {\n        // the attributes changes of <map-feature> element should be handled by watchers\n        if (mutation.type === 'attributes' && mutation.target === this.el) {\n          return;\n        }\n        // re-render feature if there is any observed change\n        this.reRender(this._featureLayer);\n      }\n    });\n    this._observer.observe(this.el, {\n      childList: true,\n      subtree: true,\n      attributes: true,\n      attributeOldValue: true,\n      characterData: true\n    });\n  }\n\n  disconnectedCallback() {\n    if (\n      this.getLayerEl()?.hasAttribute('data-moving') ||\n      this._parentEl?.parentElement?.hasAttribute('data-moving')\n    )\n      return;\n    this._observer?.disconnect();\n    if (this._featureLayer) {\n      this.removeFeature(this._featureLayer);\n      // If this was the last feature in the layer, clean up the layer\n      if (this._featureLayer.getLayers().length === 0) {\n        if (this._featureLayer.options.renderer) {\n          // manually remove the shared renderer\n          this._featureLayer.options.renderer.remove();\n        }\n        this._featureLayer.remove();\n        this._featureLayer = null;\n        delete this._featureLayer;\n      }\n    }\n    // Clean up the layer registry if not data-moving\n    const entry = this?._parentEl?._layerRegistry?.get(this.position);\n    if (entry) {\n      entry.count--;\n      if (entry.count === 0) {\n        this._parentEl._layerRegistry.delete(this.position);\n      }\n    }\n  }\n\n  reRender(layerToRenderOn: any) {\n    if (this._groupEl?.isConnected) {\n      let fallbackCS = this._getFallbackCS();\n      let placeholder = document.createElement('span');\n      this._groupEl.insertAdjacentElement('beforebegin', placeholder);\n      if (layerToRenderOn._staticFeature) {\n        layerToRenderOn._removeFromFeaturesList(this._geometry);\n      }\n      layerToRenderOn.removeLayer(this._geometry);\n      // Garbage collection needed\n      this._geometry = layerToRenderOn\n        .createGeometry(this.el, fallbackCS)\n        .addTo(layerToRenderOn);\n      // createGeometry sets _groupEl on the DOM element as a side effect\n      this._groupEl = (this.el as any)._groupEl;\n      placeholder.replaceWith(this._geometry.options.group);\n      layerToRenderOn._validateRendering();\n      delete this._getFeatureExtent;\n      this._setUpEvents();\n    }\n  }\n\n  removeFeature(layerToRemoveFrom: any) {\n    layerToRemoveFrom.removeLayer(this._geometry);\n    if (layerToRemoveFrom._staticFeature) {\n      layerToRemoveFrom._removeFromFeaturesList(this._geometry);\n    }\n    layerToRemoveFrom.options.properties = null;\n    delete this._geometry;\n    if (this._getFeatureExtent) delete this._getFeatureExtent;\n  }\n\n  addFeature(layerToAddTo: any) {\n    this._featureLayer = layerToAddTo;\n    if (!this.el.querySelector('map-geometry')) return;\n    let fallbackCS = this._getFallbackCS();\n    this._geometry = layerToAddTo.createGeometry(this.el, fallbackCS);\n    if (!this._geometry) return;\n    // createGeometry sets _groupEl on the DOM element as a side effect\n    this._groupEl = (this.el as any)._groupEl;\n    this._geometry._layerEl = this.getLayerEl();\n    layerToAddTo.addLayer(this._geometry);\n    this._setUpEvents();\n  }\n\n\n  getPrevious(): any {\n    if (this.isFirst()) {\n      return null;\n    }\n    return this.el.previousElementSibling;\n  }\n\n  isFirst(): boolean {\n    return !this._parentEl._layerRegistry.has(this.position);\n  }\n\n  _createOrGetFeatureLayer() {\n    // Wait for parent layer to be ready before proceeding\n    this._parentEl\n      .whenReady()\n      .then(() => {\n        // Detect parent context and get the appropriate layer container\n        const isMapLink = this._parentEl.nodeName === 'MAP-LINK';\n        const parentLayer = isMapLink\n          ? this._parentEl._templatedLayer\n          : this._parentEl._layer;\n\n        const parentElement = this._parentEl;\n        if (this.isFirst() && parentLayer) {\n\n          let map = parentElement.getMapEl()._map;\n\n          this._featureLayer = new MapFeatureLayer(null, {\n            renderer: featureRenderer(),\n            pane: parentLayer.getContainer(),\n            ...(isMapLink && parentElement.getBounds()\n              ? { layerBounds: parentElement.getBounds() }\n              : {}),\n            ...(isMapLink ? { zoomBounds: this._getZoomBounds() } : {}),\n            ...(isMapLink ? {} : { _leafletLayer: parentElement._layer }),\n            zIndex: this.position,\n            projection: map.options.projection,\n            mapEl: parentElement.getMapEl(),\n            onEachFeature: function (properties: any, geometry: any) {\n              if (properties) {\n                const popupOptions = {\n                  autoClose: false,\n                  autoPan: true,\n                  maxHeight: map.getSize().y * 0.5 - 50,\n                  maxWidth: map.getSize().x * 0.7,\n                  minWidth: 165\n                };\n                var c = document.createElement('div');\n                c.classList.add('mapml-popup-content');\n                c.insertAdjacentHTML('afterbegin', properties.innerHTML);\n                geometry.bindPopup(c, popupOptions);\n              }\n            }\n          });\n\n          extend(this._featureLayer.options, {\n            _leafletLayer: Object.assign(this._featureLayer, {\n              _layerEl: this.getLayerEl()\n            })\n          });\n\n          // Add this position to the parent's _layerRegistry with layer reference and count = 1\n          parentElement._layerRegistry.set(this.position, { layer: this._featureLayer, count: 1 });\n\n          this.addFeature(this._featureLayer);\n\n          // add MapFeatureLayer to appropriate parent layer\n          parentLayer.addLayer(this._featureLayer);\n        } else {\n          // get the previously registered FeatureLayer for this position\n          const entry = parentElement._layerRegistry.get(this.position);\n          this._featureLayer = entry?.layer;\n          if (entry) {\n            entry.count++;\n          }\n          \n          if (this._featureLayer) {\n            this.addFeature(this._featureLayer);\n          }\n        }\n      })\n      .catch((error: any) => {\n        console.log('Error waiting for parent layer to be ready:', error);\n      });\n  }\n\n  _setUpEvents() {\n    ['click', 'focus', 'blur', 'keyup', 'keydown'].forEach((name) => {\n      this._groupEl.addEventListener(name, (e: Event) => {\n        if (name === 'click') {\n          let clickEv = new PointerEvent(name, { cancelable: true });\n          (clickEv as any).originalEvent = e;\n          this.el.dispatchEvent(clickEv);\n        } else if (name === 'keyup' || name === 'keydown') {\n          let keyEv = new KeyboardEvent(name, { cancelable: true });\n          (keyEv as any).originalEvent = e;\n          this.el.dispatchEvent(keyEv);\n        } else {\n          let focusEv = new FocusEvent(name, { cancelable: true });\n          (focusEv as any).originalEvent = e;\n          this.el.dispatchEvent(focusEv);\n        }\n      });\n    });\n  }\n\n  _getFallbackCS(): string {\n    let csMeta;\n    if (this._parentEl?.nodeName === 'MAP-LINK') {\n      csMeta =\n        this._parentEl.shadowRoot?.querySelector('map-meta[name=cs][content]') ||\n        (this._parentEl.parentElement as any)?.getMeta?.('cs');\n    } else {\n      let layerEl = this.getLayerEl();\n      csMeta = layerEl?.src\n        ? layerEl.shadowRoot?.querySelector('map-meta[name=cs][content]')\n        : layerEl?.querySelector('map-meta[name=cs][content]');\n    }\n    return csMeta\n      ? Util._metaContentToObject(csMeta.getAttribute('content')).content\n      : 'gcrs';\n  }\n\n  _memoizeExtent() {\n    let extentCache: any;\n    return () => {\n      if (extentCache && this._getFeatureExtent) {\n        return extentCache;\n      } else {\n        // calculate feature extent\n        let map = this.getMapEl()._map,\n          geometry = this.el.querySelector('map-geometry'),\n          cs = geometry?.getAttribute('cs') || this._getFallbackCS(),\n          zoom = this.zoomValue,\n          shapes = geometry?.querySelectorAll(\n            'map-point, map-linestring, map-polygon, map-multipoint, map-multilinestring'\n          ),\n          bboxExtent = [\n            Infinity,\n            Infinity,\n            Number.NEGATIVE_INFINITY,\n            Number.NEGATIVE_INFINITY\n          ];\n        \n        if (shapes) {\n          for (let shape of Array.from(shapes)) {\n            let coord = shape.querySelectorAll('map-coordinates');\n            for (let i = 0; i < coord.length; ++i) {\n              bboxExtent = this._updateExtent(shape, coord[i], bboxExtent);\n            }\n          }\n        }\n        \n        let topLeft = point(bboxExtent[0], bboxExtent[1]);\n        let bottomRight = point(bboxExtent[2], bboxExtent[3]);\n        let pcrsBound = Util.boundsToPCRSBounds(\n          bounds(topLeft, bottomRight),\n          zoom,\n          map.options.projection,\n          cs\n        );\n        \n        if (\n          shapes?.length === 1 &&\n          shapes[0].tagName.toUpperCase() === 'MAP-POINT'\n        ) {\n          let projection = map.options.projection,\n            maxZoom = this.el.hasAttribute('max')\n              ? +this.el.getAttribute('max')\n              : M[projection].options.resolutions.length - 1,\n            tileCenter = M[projection].options.crs.tile.bounds.getCenter(),\n            pixel = M[projection].transformation.transform(\n              pcrsBound.min,\n              M[projection].scale(+this.zoomValue || maxZoom)\n            );\n          pcrsBound = Util.pixelToPCRSBounds(\n            bounds(pixel.subtract(tileCenter), pixel.add(tileCenter)),\n            this.zoomValue || maxZoom,\n            projection\n          );\n        }\n        \n        let result = Object.assign(\n          Util._convertAndFormatPCRS(\n            pcrsBound,\n            map.options.crs,\n            map.options.projection\n          ),\n          { zoom: this._getZoomBounds() }\n        );\n        extentCache = result;\n        return result;\n      }\n    };\n  }\n\n  _updateExtent(shape: Element, coord: Element, bboxExtent: number[]): number[] {\n    let data = coord.innerHTML\n      .trim()\n      .replace(/<[^>]+>/g, '')\n      .replace(/\\s+/g, ' ')\n      .split(/[<>\\ ]/g);\n    switch (shape.tagName.toUpperCase()) {\n      case 'MAP-POINT':\n        bboxExtent = Util._updateExtent(bboxExtent, +data[0], +data[1]);\n        break;\n      case 'MAP-LINESTRING':\n      case 'MAP-POLYGON':\n      case 'MAP-MULTIPOINT':\n      case 'MAP-MULTILINESTRING':\n        for (let i = 0; i < data.length; i += 2) {\n          bboxExtent = Util._updateExtent(bboxExtent, +data[i], +data[i + 1]);\n        }\n        break;\n      default:\n        break;\n    }\n    return bboxExtent;\n  }\n\n  _getZoomBounds() {\n    return {\n      minZoom: this.minValue,\n      maxZoom: this.maxValue,\n      minNativeZoom: this.zoomValue,\n      maxNativeZoom: this.zoomValue\n    };\n  }\n\n  getZoomToZoom(): number {\n    let tL = this.extent.topLeft.pcrs,\n      bR = this.extent.bottomRight.pcrs,\n      bound = bounds(\n        point(tL.horizontal, tL.vertical),\n        point(bR.horizontal, bR.vertical)\n      );\n    let projection = this.getMapEl()._map.options.projection,\n      layerZoomBounds = this.getLayerEl().extent.zoom,\n      minZoom = layerZoomBounds.minZoom ? layerZoomBounds.minZoom : 0,\n      maxZoom = layerZoomBounds.maxZoom\n        ? layerZoomBounds.maxZoom\n        : M[projection].options.resolutions.length - 1;\n    let newZoom;\n    if (this.el.hasAttribute('zoom')) {\n      newZoom = this.zoomValue;\n    } else {\n      newZoom = Util.getMaxZoom(bound, this.getMapEl()._map, minZoom, maxZoom);\n      if (this.maxValue < newZoom) {\n        newZoom = this.maxValue;\n      } else if (this.minValue > newZoom) {\n        newZoom = this.minValue;\n      }\n    }\n    if (newZoom < minZoom) {\n      newZoom = minZoom;\n    } else if (newZoom > maxZoom) {\n      newZoom = maxZoom;\n    }\n    return newZoom;\n  }\n\n  getMeta(metaName: string): Element | null {\n    let name = metaName.toLowerCase();\n    if (name !== 'cs' && name !== 'zoom' && name !== 'projection') return null;\n    let sdMeta = this._parentEl?.shadowRoot?.querySelector(\n      `map-meta[name=${name}][content]`\n    );\n    if (this._parentEl?.nodeName === 'MAP-LINK') {\n      return sdMeta || (this._parentEl.parentElement as any)?.getMeta?.(metaName);\n    } else {\n      return this._parentEl?.src\n        ? this._parentEl.shadowRoot?.querySelector(\n            `map-meta[name=${name}][content]`\n          )\n        : this._parentEl?.querySelector(`map-meta[name=${name}][content]`);\n    }\n  }\n\n  mapml2geojson(options?: any): any {\n    let defaults = {\n      propertyFunction: null,\n      transform: true\n    };\n    options = Object.assign({}, defaults, options);\n\n    let json: any = {\n      type: 'Feature',\n      properties: {},\n      geometry: {}\n    };\n    \n    let el = this.el.querySelector('map-properties');\n    if (!el) {\n      json.properties = null;\n    } else if (typeof options.propertyFunction === 'function') {\n      json.properties = options.propertyFunction(el);\n    } else if (el.querySelector('table')) {\n      let table = el.querySelector('table').cloneNode(true);\n      json.properties = Util._table2properties(table as HTMLTableElement);\n    } else {\n      json.properties = {\n        prop0: el.innerHTML.replace(/(<([^>]+)>)/gi, '').replace(/\\s/g, '')\n      };\n    }\n\n    let source = null,\n      dest = null,\n      map = this.getMapEl()._map;\n    if (options.transform) {\n      source = new proj4.Proj(map.options.crs.code);\n      dest = new proj4.Proj('EPSG:4326');\n      if (\n        map.options.crs.code === 'EPSG:3857' ||\n        map.options.crs.code === 'EPSG:4326'\n      ) {\n        options.transform = false;\n      }\n    }\n\n    let collection = this.el.querySelector('map-geometry')?.querySelector(\n        'map-geometrycollection'\n      ),\n      shapes = this.el.querySelector('map-geometry')?.querySelectorAll(\n        'map-point, map-polygon, map-linestring, map-multipoint, map-multipolygon, map-multilinestring'\n      );\n\n    if (collection) {\n      json.geometry.type = 'GeometryCollection';\n      json.geometry.geometries = [];\n      if (shapes) {\n        for (let shape of Array.from(shapes)) {\n          json.geometry.geometries.push(\n            Util._geometry2geojson(shape, source, dest, options.transform)\n          );\n        }\n      }\n    } else if (shapes && shapes.length > 0) {\n      json.geometry = Util._geometry2geojson(\n        shapes[0],\n        source,\n        dest,\n        options.transform\n      );\n    }\n    return json;\n  }\n\n  click() {\n    let g = this._groupEl,\n      rect = g.getBoundingClientRect();\n    let event = new MouseEvent('click', {\n      clientX: rect.x + rect.width / 2,\n      clientY: rect.y + rect.height / 2,\n      button: 0\n    });\n    let properties = this.el.querySelector('map-properties');\n    if (g.getAttribute('role') === 'link') {\n      for (let path of g.children) {\n        (path as any).mousedown?.call(this._geometry, event);\n        (path as any).mouseup?.call(this._geometry, event);\n      }\n    }\n    let clickEv = new PointerEvent('click', { cancelable: true });\n    (clickEv as any).originalEvent = event;\n    this.el.dispatchEvent(clickEv);\n    if (properties && this.el.isConnected) {\n      let geometry = this._geometry,\n        shapes = geometry._layers;\n      for (let id in shapes) {\n        if (shapes[id].isPopupOpen()) {\n          shapes[id].closePopup();\n        }\n      }\n      if (geometry.isPopupOpen()) {\n        geometry.closePopup();\n      } else if (!(clickEv as any).originalEvent.cancelBubble) {\n        geometry.openPopup();\n      }\n    }\n  }\n\n  focus(options?: FocusOptions) {\n    this._groupEl?.focus(options);\n  }\n\n  blur() {\n    if (\n      document.activeElement?.shadowRoot?.activeElement === this._groupEl ||\n      (document.activeElement?.shadowRoot?.activeElement as any)?.parentNode ===\n        this._groupEl\n    ) {\n      this._groupEl.blur();\n      this.getMapEl()?._map?.getContainer().focus();\n    }\n  }\n\n  zoomTo() {\n    let extent = this.extent,\n      map = this.getMapEl()._map;\n    let tL = extent.topLeft.pcrs,\n      bR = extent.bottomRight.pcrs,\n      bound = bounds(\n        point(tL.horizontal, tL.vertical),\n        point(bR.horizontal, bR.vertical)\n      ),\n      center = map.options.crs.unproject(bound.getCenter(true));\n    map.setView(center, this.getZoomToZoom(), { animate: false });\n  }\n\n  @Method()\n  async whenReady(): Promise<void> {\n    return new Promise((resolve, reject) => {\n      let interval: any, failureTimer: any;\n      // Check if addFeature has been published (indicating connectedCallback completed)\n      if ((this.el as any).addFeature) {\n        resolve();\n      } else {\n        let featureElement = this.el;\n        interval = setInterval(testForFeature, 200, featureElement);\n        failureTimer = setTimeout(featureNotDefined, 5000);\n      }\n      function testForFeature(featureElement: HTMLElement) {\n        if ((featureElement as any).addFeature) {\n          clearInterval(interval);\n          clearTimeout(failureTimer);\n          resolve();\n        }\n      }\n      function featureNotDefined() {\n        clearInterval(interval);\n        clearTimeout(failureTimer);\n        reject('Timeout reached waiting for feature to be ready');\n      }\n    });\n  }\n\n  render() {\n    return null;\n  }\n}\n"],"names":["extend","point","bounds"],"mappings":"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"}