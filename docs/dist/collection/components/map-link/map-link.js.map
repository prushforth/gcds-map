{"version":3,"file":"map-link.js","sourceRoot":"","sources":["../../../src/components/map-link/map-link.tsx"],"names":[],"mappings":"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","sourcesContent":["import { Component, Element, Prop, Watch, Method } from '@stencil/core';\nimport {\n  bounds,\n  point,\n  DomEvent,\n  stamp,\n  Util as LeafletUtil\n} from 'leaflet';\nimport { Util } from '../utils/mapml/Util';\nimport { templatedImageLayer } from '../utils/mapml/layers/TemplatedImageLayer';\nimport { templatedTileLayer } from '../utils/mapml/layers/TemplatedTileLayer';\nimport { templatedFeaturesOrTilesLayer } from '../utils/mapml/layers/TemplatedFeaturesOrTilesLayer';\nimport { templatedPMTilesLayer } from '../utils/mapml/layers/TemplatedPMTilesLayer';\n\ndeclare const M: any;\n\n@Component({\n  tag: 'map-link',\n  shadow: true\n})\nexport class MapLink {\n  @Element() el: HTMLElement;\n  \n  // Core attributes - using getters/setters pattern from MapML\n  @Prop({ reflect: true }) type?: string;\n  \n  // Getter that provides default value without reflecting it to the DOM attribute\n  get typeValue(): string {\n    return this.type || 'image/*';\n  }\n  @Prop({ reflect: true }) rel?: string;\n  @Prop({ reflect: true }) href?: string;\n  @Prop({ reflect: true }) hreflang?: string;\n  @Prop({ reflect: true }) tref?: string;\n  \n  // Getter that provides default value (matching MapML behavior)\n  get trefValue(): string {\n    return this.tref || M.BLANK_TT_TREF;\n  }\n  \n  @Prop({ reflect: true }) media?: string;\n  @Prop({ reflect: true }) tms?: boolean;\n  @Prop({ reflect: true }) projection?: string;\n  @Prop({ reflect: true, mutable: true }) disabled?: boolean;\n\n  _templatedLayer: any;\n  _templateVars: any;\n  _alternate: boolean;\n  _styleOption: any;\n  _stylesheetHost: any;\n  _pmtilesRules: any;\n  _mql: any;\n  _changeHandler: any;\n  // the layer registry is a semi-private Map stored on each map-link and map-layer element\n  // structured as follows: position -> {layer: layerInstance, count: number}\n  // where layer is either a MapTileLayer or a MapFeatureLayer, \n  // and count is the number of tiles or features in that layer\n  _layerRegistry: Map<number, { layer: any; count: number }> = new Map();\n  parentExtent: any;\n  mapEl: any;\n  zoomInput: any;\n  zIndex: number;\n  link: any;\n\n  @Watch('type')\n  typeChanged(newValue: string, oldValue: string) {\n    if (oldValue !== newValue) {\n      // Handle side effects if needed\n    }\n  }\n\n  @Watch('rel')\n  relChanged(newValue: string, oldValue: string) {\n    if (oldValue !== newValue) {\n      // Handle side effects\n    }\n  }\n\n  @Watch('href')\n  hrefChanged(newValue: string, oldValue: string) {\n    if (oldValue !== newValue) {\n      // Handle side effects\n    }\n  }\n\n  @Watch('hreflang')\n  hreflangChanged(newValue: string, oldValue: string) {\n    if (oldValue !== newValue) {\n      // Handle side effects\n    }\n  }\n\n  @Watch('tref')\n  trefChanged(newValue: string, oldValue: string) {\n    if (oldValue !== newValue) {\n      this._initTemplateVars();\n    }\n  }\n\n  @Watch('media')\n  mediaChanged(newValue: string, oldValue: string) {\n    if (oldValue !== newValue) {\n      this._registerMediaQuery(newValue);\n    }\n  }\n\n  @Watch('tms')\n  tmsChanged(newValue: boolean, oldValue: boolean) {\n    if (oldValue !== newValue) {\n      // Handle side effects\n    }\n  }\n\n  @Watch('projection')\n  projectionChanged(newValue: string, oldValue: string) {\n    if (oldValue !== newValue) {\n      // Handle side effects\n    }\n  }\n\n  @Watch('disabled')\n  disabledChanged(newValue: boolean) {\n    if (newValue) {\n      this._disableLink();\n    } else {\n      this._enableLink();\n    }\n  }\n\n  get extent() {\n    return this._templateVars\n      ? Object.assign(\n          Util._convertAndFormatPCRS(\n            this.getBounds(),\n            M[this.parentExtent.units],\n            this.parentExtent.units\n          ),\n          { zoom: this.getZoomBounds() }\n        )\n      : null;\n  }\n\n  getMapEl() {\n    return Util.getClosest(this.el, 'gcds-map');\n  }\n\n  getLayerEl() {\n    return Util.getClosest(this.el, 'map-layer,layer-');\n  }\n\n  getBase(): string {\n    // Look for map-base element in the shadow root (for remote content)\n    const shadowRoot = this.el.getRootNode();\n    if (shadowRoot instanceof ShadowRoot) {\n      const mapBase = shadowRoot.querySelector('map-base[href]');\n      if (mapBase) {\n        return mapBase.getAttribute('href')!;\n      }\n      // Fallback: resolve against the layer's src\n      const layer = (shadowRoot as any).host;\n      return new URL(layer.src, layer.baseURI).href;\n    }\n    \n    // Light DOM: check for map-base or use element's baseURI\n    const mapBase = (this.el.getRootNode() as Document).querySelector('map-base[href]');\n    return mapBase ? mapBase.getAttribute('href')! : this.el.baseURI;\n  }\n\n  async connectedCallback() {\n    if (\n      this.getLayerEl()?.hasAttribute('data-moving') ||\n      (this.parentExtent && this.parentExtent.hasAttribute('data-moving'))\n    )\n      return;\n\n    (this.el as any)._layerRegistry = this._layerRegistry;\n\n    // Publish MapML compatibility methods on element\n    // Note: Methods decorated with @Method() (whenReady) \n    // are automatically available on the element\n    (this.el as any).getMapEl = this.getMapEl.bind(this);\n    (this.el as any).getLayerEl = this.getLayerEl.bind(this);\n    (this.el as any).zoomTo = this.zoomTo.bind(this);\n    (this.el as any).getZoomBounds = this.getZoomBounds.bind(this);\n    (this.el as any).getBounds = this.getBounds.bind(this);\n    (this.el as any).isVisible = this.isVisible.bind(this);\n    (this.el as any).getLayerControlOption = this.getLayerControlOption.bind(this);\n    \n    // Expose extent property on DOM element for MapML compatibility\n    Object.defineProperty(this.el, 'extent', {\n      get: () => this.extent,\n      configurable: true,\n      enumerable: true\n    });\n\n    switch (this.rel?.toLowerCase()) {\n      case 'tile':\n      case 'image':\n      case 'features':\n      case 'query':\n        if (!this.disabled) {\n          this._initTemplateVars();\n          await this._createTemplatedLink();\n        }\n        break;\n      case 'style':\n      case 'self':\n      case 'style self':\n      case 'self style':\n        this._createSelfOrStyleLink();\n        break;\n      case 'zoomin':\n      case 'zoomout':\n        break;\n      case 'legend':\n        break;\n      case 'stylesheet':\n        if (!this.disabled) {\n          this._createStylesheetLink();\n        }\n        break;\n      case 'alternate':\n        this._createAlternateLink();\n        break;\n      case 'license':\n        break;\n    }\n\n    await this._registerMediaQuery(this.media);\n  }\n\n  disconnectedCallback() {\n    switch (this.rel?.toLowerCase()) {\n      case 'stylesheet':\n        if (this._stylesheetHost) {\n          this.link?.remove();\n        }\n        break;\n      default:\n        break;\n    }\n    this._layerRegistry.clear();\n  }\n\n  _disableLink() {\n    switch (this.rel?.toLowerCase()) {\n      case 'tile':\n      case 'image':\n      case 'features':\n        if (\n          this._templatedLayer &&\n          this.parentExtent?._extentLayer?.hasLayer(this._templatedLayer)\n        ) {\n          this.parentExtent._extentLayer.removeLayer(this._templatedLayer);\n          delete this._templatedLayer;\n          if (this.el.shadowRoot) {\n            this.el.shadowRoot.innerHTML = '';\n          }\n          this.getLayerEl()?._validateDisabled();\n        }\n        break;\n      case 'query':\n        delete this._templateVars;\n        if (this.el.shadowRoot) {\n          this.el.shadowRoot.innerHTML = '';\n        }\n        this.getLayerEl()?._validateDisabled();\n        break;\n      case 'stylesheet':\n        delete this._pmtilesRules;\n        delete this._stylesheetHost;\n        if (this.link) {\n          this.link.remove();\n          delete this.link;\n        }\n        break;\n    }\n  }\n\n  async _enableLink() {\n    switch (this.rel?.toLowerCase()) {\n      case 'tile':\n      case 'image':\n      case 'features':\n      case 'query':\n        this._initTemplateVars();\n        await this._createTemplatedLink();\n        this.getLayerEl()?._validateDisabled();\n        break;\n      case 'stylesheet':\n        this._createStylesheetLink();\n        break;\n    }\n  }\n\n  async _registerMediaQuery(mq: string) {\n    if (!this._changeHandler) {\n      this._changeHandler = () => {\n        this.disabled = !this._mql.matches;\n      };\n    }\n\n    if (mq) {\n      const map = this.getMapEl();\n      if (!map) return;\n\n      await map.whenReady();\n\n      if (this._mql) {\n        this._mql.removeEventListener('change', this._changeHandler);\n      }\n\n      this._mql = map.matchMedia(mq);\n      this._changeHandler();\n      this._mql.addEventListener('change', this._changeHandler);\n    } else if (this._mql) {\n      this._mql.removeEventListener('change', this._changeHandler);\n      delete this._mql;\n      this.disabled = false;\n    }\n  }\n\n  _createAlternateLink() {\n    if (this.href && this.projection) this._alternate = true;\n  }\n\n  _createStylesheetLink() {\n    if (this.type === 'application/pmtiles+stylesheet') {\n      const pmtilesStyles = new URL(this.href, this.getBase()).href;\n      // Use webpackIgnore magic comment to prevent storybook Webpack from analyzing this dynamic import\n      import(/* webpackIgnore: true */ pmtilesStyles)\n        .then((module) => module.pmtilesRulesReady)\n        .then((initializedRules) => {\n          this._pmtilesRules = initializedRules;\n          (this.el as any)._pmtilesRules = initializedRules;\n        })\n        .catch((reason) => {\n          console.error(\n            'Error importing pmtiles symbolizer rules or theme: \\n' + reason\n          );\n        });\n    } else {\n      this._stylesheetHost =\n        this.el.getRootNode() instanceof ShadowRoot\n          ? (this.el.getRootNode() as any).host\n          : this.el.parentElement;\n      if (this._stylesheetHost === undefined) return;\n\n      this.link = document.createElement('link');\n      (this.el as any).link = this.link;\n      (this.link as any).mapLink = this.el;\n      this.link.setAttribute('href', new URL(this.href, this.getBase()).href);\n      this._copyAttributes(this.el, this.link);\n      // Explicitly set disabled based on the property value, not the attribute\n      // (which may be stale during re-enabling)\n      this.link.disabled = this.disabled || false;\n\n      // Try to render immediately if parent is ready\n      // If parent isn't ready yet, the parent's mutation observer will pick this up\n      // and render it after the parent becomes ready\n      if (this._stylesheetHost._layer) {\n        this._stylesheetHost._layer.renderStyles(this.el);\n      } else if (this._stylesheetHost._templatedLayer) {\n        this._stylesheetHost._templatedLayer.renderStyles(this.el);\n      } else if (this._stylesheetHost._extentLayer) {\n        this._stylesheetHost._extentLayer.renderStyles(this.el);\n      }\n      // If none of the above exist yet, the parent's mutation observer\n      // or initialization will call renderStyles when it's ready\n    }\n  }\n\n  _copyAttributes(source: Element, target: Element) {\n    Array.from(source.attributes).forEach((attribute) => {\n      // Don't copy href, media, or disabled - these are handled separately\n      if (attribute.nodeName !== 'href' && \n          attribute.nodeName !== 'media' && \n          attribute.nodeName !== 'disabled')\n        target.setAttribute(attribute.nodeName, attribute.nodeValue);\n    });\n  }\n\n  // Create templated layer based on rel type\n  async _createTemplatedLink() {\n    // conditions check\n    // the tms and type attributes are optional, may need to be checked in future\n    this.parentExtent =\n      this.el.parentNode?.nodeName.toUpperCase() === 'MAP-EXTENT'\n        ? this.el.parentNode\n        : (this.el.parentNode as any)?.host;\n    if (this.disabled || !this.parentExtent) {\n      return;\n    }\n    \n    try {\n      await this.parentExtent.whenReady();\n      await this._templateVars?.inputsReady;\n    } catch (error) {\n      console.log('Error while creating templated link: ' + error);\n      return;\n    }\n    \n    this.mapEl = this.getMapEl();\n    // create the layer type appropriate to the rel value\n    this.zIndex = Array.from(\n      this.parentExtent.querySelectorAll(\n        'map-link[rel=image],map-link[rel=tile],map-link[rel=features]'\n      )\n    ).indexOf(this.el);\n    \n    if (\n      (this.rel === 'tile' && this.type === 'application/pmtiles') ||\n      this.type === 'application/vnd.mapbox-vector-tile'\n    ) {\n      const s =\n        'map-link[rel=\"stylesheet\"][type=\"application/pmtiles+stylesheet\"]:not([disabled])';\n      let pmtilesStylesheetLink = this.getLayerEl()?.src\n        ? this.el.closest('map-extent')?.querySelector(s) ??\n          (this.el.getRootNode() as any).querySelector(':host > ' + s)\n        : Util.getClosest(\n            this.el,\n            'map-extent:has(' +\n              s +\n              '),map-layer:has(' +\n              s +\n              '),layer-:has(' +\n              s +\n              ')'\n          )?.querySelector(s);\n      if (pmtilesStylesheetLink) {\n        await (pmtilesStylesheetLink as any).whenReady();\n        const options = {\n          zoomBounds: this.getZoomBounds(),\n          extentBounds: this.getBounds(),\n          crs: M[this.parentExtent.units],\n          zIndex: this.zIndex,\n          pane: this.parentExtent._extentLayer.getContainer(),\n          linkEl: this.el,\n          pmtilesRules: (pmtilesStylesheetLink as any)?._pmtilesRules\n        };\n        this._templatedLayer = templatedPMTilesLayer(\n          this._templateVars,\n          options\n        ).addTo(this.parentExtent._extentLayer);\n        // Publish for MapML compatibility\n        (this.el as any)._templatedLayer = this._templatedLayer;\n      } else {\n        console.warn('Stylesheet not found for ' + this._templateVars.template);\n      }\n    } else if (this.rel === 'tile') {\n      this._templatedLayer = templatedTileLayer(this._templateVars, {\n        zoomBounds: this.getZoomBounds(),\n        extentBounds: this.getBounds(),\n        crs: M[this.parentExtent.units],\n        errorTileUrl:\n          'data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==',\n        zIndex: this.zIndex,\n        pane: this.parentExtent._extentLayer.getContainer(),\n        linkEl: this.el\n      }).addTo(this.parentExtent._extentLayer);\n      // Publish for MapML compatibility\n      (this.el as any)._templatedLayer = this._templatedLayer;\n    } else if (this.rel === 'image') {\n      this._templatedLayer = templatedImageLayer(this._templateVars, {\n        zoomBounds: this.getZoomBounds(),\n        extentBounds: this.getBounds(),\n        zIndex: this.zIndex,\n        pane: this.parentExtent._extentLayer.getContainer(),\n        linkEl: this.el\n      }).addTo(this.parentExtent._extentLayer);\n      // Publish for MapML compatibility\n      (this.el as any)._templatedLayer = this._templatedLayer;\n    } else if (this.rel === 'features') {\n      // map-feature retrieved by link will be stored in shadowRoot owned by link\n      if (!this.el.shadowRoot) {\n        this.el.attachShadow({ mode: 'open' });\n      }\n      // Use the FeaturesTilesLayerGroup to handle both map-feature and map-tile elements\n      this._templatedLayer = templatedFeaturesOrTilesLayer(this._templateVars, {\n        zoomBounds: this.getZoomBounds(),\n        extentBounds: this.getBounds(),\n        zIndex: this.zIndex,\n        pane: this.parentExtent._extentLayer.getContainer(),\n        linkEl: this.el,\n        projection: this.mapEl._map.options.projection\n      }).addTo(this.parentExtent._extentLayer);\n      // Publish for MapML compatibility\n      (this.el as any)._templatedLayer = this._templatedLayer;\n    } else if (this.rel === 'query') {\n      if (!this.el.shadowRoot) {\n        this.el.attachShadow({ mode: 'open' });\n      }\n      Object.assign(this._templateVars, this._setupQueryVars(this._templateVars));\n      Object.assign(this._templateVars, { extentBounds: this.getBounds() });\n    }\n  }\n\n  _setupQueryVars(template: any) {\n    // process the inputs associated to template and create an object named\n    // query with member properties as follows:\n    // {width: 'widthvarname',\n    //  height: 'heightvarname',\n    //  left: 'leftvarname',\n    //  right: 'rightvarname',\n    //  top: 'topvarname',\n    //  bottom: 'bottomvarname'\n    //  i: 'ivarname'\n    //  j: 'jvarname'}\n    //  x: 'xvarname' x being the tcrs x axis\n    //  y: 'yvarname' y being the tcrs y axis\n    //  z: 'zvarname' zoom\n    //  title: link title\n\n    const queryVarNames: any = { query: {} };\n    const inputs = template.values;\n\n    for (let i = 0; i < template.values.length; i++) {\n      const type = inputs[i].getAttribute('type');\n      const units = inputs[i].getAttribute('units');\n      const axis = inputs[i].getAttribute('axis');\n      const name = inputs[i].getAttribute('name');\n      const position = inputs[i].getAttribute('position');\n      const rel = inputs[i].getAttribute('rel');\n      const select = inputs[i].tagName.toLowerCase() === 'map-select';\n      \n      if (type === 'width') {\n        queryVarNames.query.width = name;\n      } else if (type === 'height') {\n        queryVarNames.query.height = name;\n      } else if (type === 'location') {\n        switch (axis) {\n          case 'x':\n          case 'y':\n          case 'column':\n          case 'row':\n            queryVarNames.query[axis] = name;\n            break;\n          case 'longitude':\n          case 'easting':\n            if (position) {\n              if (position.match(/.*?-left/i)) {\n                if (rel === 'pixel') {\n                  queryVarNames.query.pixelleft = name;\n                } else if (rel === 'tile') {\n                  queryVarNames.query.tileleft = name;\n                } else {\n                  queryVarNames.query.mapleft = name;\n                }\n              } else if (position.match(/.*?-right/i)) {\n                if (rel === 'pixel') {\n                  queryVarNames.query.pixelright = name;\n                } else if (rel === 'tile') {\n                  queryVarNames.query.tileright = name;\n                } else {\n                  queryVarNames.query.mapright = name;\n                }\n              }\n            } else {\n              queryVarNames.query[axis] = name;\n            }\n            break;\n          case 'latitude':\n          case 'northing':\n            if (position) {\n              if (position.match(/top-.*?/i)) {\n                if (rel === 'pixel') {\n                  queryVarNames.query.pixeltop = name;\n                } else if (rel === 'tile') {\n                  queryVarNames.query.tiletop = name;\n                } else {\n                  queryVarNames.query.maptop = name;\n                }\n              } else if (position.match(/bottom-.*?/i)) {\n                if (rel === 'pixel') {\n                  queryVarNames.query.pixelbottom = name;\n                } else if (rel === 'tile') {\n                  queryVarNames.query.tilebottom = name;\n                } else {\n                  queryVarNames.query.mapbottom = name;\n                }\n              }\n            } else {\n              queryVarNames.query[axis] = name;\n            }\n            break;\n          case 'i':\n            if (units === 'tile') {\n              queryVarNames.query.tilei = name;\n            } else {\n              queryVarNames.query.mapi = name;\n            }\n            break;\n          case 'j':\n            if (units === 'tile') {\n              queryVarNames.query.tilej = name;\n            } else {\n              queryVarNames.query.mapj = name;\n            }\n            break;\n          default:\n          // unsupported axis value\n        }\n      } else if (type === 'zoom') {\n        //<input name=\"...\" type=\"zoom\" value=\"0\" min=\"0\" max=\"17\">\n        queryVarNames.query.zoom = name;\n      } else if (select) {\n        const parsedselect = (inputs[i] as any).htmlselect;\n        queryVarNames.query[name] = function () {\n          return parsedselect.value;\n        };\n      } else {\n        const input = inputs[i];\n        queryVarNames.query[name] = function () {\n          return input.getAttribute('value');\n        };\n      }\n    }\n    return queryVarNames;\n  }\n\n  _initTemplateVars() {\n    const varNamesRe = new RegExp('(?:{)(.*?)(?:})', 'g');\n    const zoomInput = this.el.parentElement?.querySelector('map-input[type=\"zoom\" i]');\n    let includesZoom = false;\n    let linkedZoomInput: any;\n\n    let template = this.trefValue;\n    if (template === M.BLANK_TT_TREF) {\n      const mapInputs = this.el.parentElement?.querySelectorAll('map-input');\n      if (mapInputs) {\n        mapInputs.forEach((i) => {\n          template += `{${i.getAttribute('name')}}`;\n        });\n      }\n    }\n    this.zoomInput = zoomInput;\n    // Publish for MapML compatibility\n    (this.el as any).zoomInput = zoomInput;\n\n    let v: any;\n    const vcount = template.match(varNamesRe) || [];\n    const inputs: any[] = [];\n    const inputsReady: Promise<any>[] = [];\n\n    while ((v = varNamesRe.exec(template)) !== null) {\n      const varName = v[1];\n      const inp = this.el.parentElement?.querySelector(\n        `map-input[name=${varName}],map-select[name=${varName}]`\n      );\n      if (inp) {\n        inputs.push(inp);\n        inputsReady.push((inp as any).whenReady());\n\n        if (\n          inp.hasAttribute('type') &&\n          inp.getAttribute('type').toLowerCase() === 'zoom'\n        ) {\n          linkedZoomInput = inp;\n          includesZoom = true;\n        }\n      } else {\n        console.log(\n          'input with name=' +\n            varName +\n            ' not found for template variable of same name'\n        );\n      }\n    }\n\n    if (template && vcount.length === inputs.length) {\n      if (!includesZoom && zoomInput) {\n        inputs.push(zoomInput);\n        inputsReady.push((zoomInput as any).whenReady());\n        linkedZoomInput = zoomInput;\n      }\n      const step = zoomInput ? zoomInput.getAttribute('step') : 1;\n      // Validate step: if not set, is '0', or not a number, default to 1\n      let validStep = step;\n      if (!step || step === '0' || isNaN(step as any)) validStep = 1;\n\n      this._templateVars = {\n        template: decodeURI(new URL(template, this.getBase()).href),\n        linkEl: this.el,\n        rel: this.rel,\n        type: this.typeValue,\n        values: inputs,\n        inputsReady: Promise.allSettled(inputsReady),\n        zoom: linkedZoomInput,\n        projection: this.el.parentElement?.getAttribute('units'),\n        tms: this.tms,\n        step: validStep\n      };\n      \n      // Publish for MapML compatibility\n      (this.el as any)._templateVars = this._templateVars;\n    }\n  }\n\n  // Stub implementations for bounds methods - to be completed\n  getZoomBounds() {\n    return this._getZoomBounds(this._templateVars?.zoom);\n  }\n\n  _getZoomBounds(zoomInput: any) {\n    const zoomBounds: any = {};\n    const meta = (this.el.parentElement as any)?.getMeta?.('zoom');\n    const metaMin = meta\n      ? +Util._metaContentToObject(meta.getAttribute('content'))?.min\n      : null;\n    zoomBounds.minZoom =\n      metaMin || (zoomInput ? +zoomInput.getAttribute('min') : 0);\n    zoomBounds.minNativeZoom = zoomInput\n      ? +zoomInput.getAttribute('min')\n      : zoomBounds.minZoom;\n    const metaMax = meta\n      ? +Util._metaContentToObject(meta.getAttribute('content'))?.max\n      : null;\n    zoomBounds.maxZoom =\n      metaMax ||\n      (zoomInput\n        ? +zoomInput.getAttribute('max')\n        : M[this.el.parentElement?.getAttribute('units')]?.options.resolutions.length - 1);\n    zoomBounds.maxNativeZoom = zoomInput\n      ? +zoomInput.getAttribute('max')\n      : zoomBounds.maxZoom;\n\n    return zoomBounds;\n  }\n\n  getBounds() {\n    const template = this._templateVars;\n    if (!template) return null;\n    \n    const inputs = template.values;\n    const projection = this.el.parentElement?.getAttribute('units');\n    const boundsUnit: any = {};\n    boundsUnit.name = M.FALLBACK_CS;\n    \n    let bnds = M[projection].options.crs.tilematrix.bounds(0);\n    let locInputs = false;\n    \n    for (let i = 0; i < inputs.length; i++) {\n      if (inputs[i].getAttribute('type') === 'location') {\n        if (!inputs[i].getAttribute('max') || !inputs[i].getAttribute('min'))\n          continue;\n        const max = +inputs[i].getAttribute('max');\n        const min = +inputs[i].getAttribute('min');\n        \n        switch (inputs[i].getAttribute('axis')?.toLowerCase()) {\n          case 'x':\n          case 'longitude':\n          case 'column':\n          case 'easting':\n            boundsUnit.name = Util.axisToCS(\n              inputs[i].getAttribute('axis').toLowerCase()\n            );\n            bnds.min.x = min;\n            bnds.max.x = max;\n            boundsUnit.horizontalAxis = inputs[i]\n              .getAttribute('axis')\n              .toLowerCase();\n            break;\n          case 'y':\n          case 'latitude':\n          case 'row':\n          case 'northing':\n            boundsUnit.name = Util.axisToCS(\n              inputs[i].getAttribute('axis').toLowerCase()\n            );\n            bnds.min.y = min;\n            bnds.max.y = max;\n            boundsUnit.verticalAxis = inputs[i]\n              .getAttribute('axis')\n              .toLowerCase();\n            break;\n          default:\n            break;\n        }\n      }\n    }\n    \n    if (\n      boundsUnit.horizontalAxis &&\n      boundsUnit.verticalAxis &&\n      ((boundsUnit.horizontalAxis === 'x' && boundsUnit.verticalAxis === 'y') ||\n        (boundsUnit.horizontalAxis === 'longitude' &&\n          boundsUnit.verticalAxis === 'latitude') ||\n        (boundsUnit.horizontalAxis === 'column' &&\n          boundsUnit.verticalAxis === 'row') ||\n        (boundsUnit.horizontalAxis === 'easting' &&\n          boundsUnit.verticalAxis === 'northing'))\n    ) {\n      locInputs = true;\n    }\n    \n    if (locInputs) {\n      const zoomValue = this._templateVars.zoom?.hasAttribute('value')\n        ? +this._templateVars.zoom.getAttribute('value')\n        : 0;\n      bnds = Util.boundsToPCRSBounds(\n        bnds,\n        zoomValue,\n        projection,\n        boundsUnit.name\n      );\n    } else if (!locInputs) {\n      bnds = this.getFallbackBounds(projection);\n    }\n    \n    return bnds;\n  }\n\n  getFallbackBounds(projection: string) {\n    let bnds: any;\n    let zoom = 0;\n    const metaExtent = (this.el.parentElement as any)?.getMeta?.('extent');\n    \n    if (metaExtent) {\n      const content = Util._metaContentToObject(\n        metaExtent.getAttribute('content')\n      );\n      let cs;\n      \n      zoom = content.zoom || zoom;\n      \n      const metaKeys = Object.keys(content);\n      for (let i = 0; i < metaKeys.length; i++) {\n        if (!metaKeys[i].includes('zoom')) {\n          cs = Util.axisToCS(metaKeys[i].split('-')[2]);\n          break;\n        }\n      }\n      \n      const axes = Util.csToAxes(cs);\n      bnds = Util.boundsToPCRSBounds(\n        bounds(\n          point(\n            +content[`top-left-${axes[0]}`],\n            +content[`top-left-${axes[1]}`]\n          ),\n          point(\n            +content[`bottom-right-${axes[0]}`],\n            +content[`bottom-right-${axes[1]}`]\n          )\n        ),\n        zoom,\n        projection,\n        cs\n      );\n    } else {\n      const crs = M[projection];\n      bnds = crs?.options.crs.pcrs.bounds;\n    }\n    return bnds;\n  }\n\n  isVisible(): boolean {\n    if (this.disabled) return false;\n    let isVisible = false;\n    const map = this.getMapEl();\n    const mapZoom = map?.zoom;\n    const extent = map?.extent;\n    \n    if (!extent) return false;\n\n    const xmin = extent.topLeft.pcrs.horizontal;\n    const xmax = extent.bottomRight.pcrs.horizontal;\n    const ymin = extent.bottomRight.pcrs.vertical;\n    const ymax = extent.topLeft.pcrs.vertical;\n    const mapBounds = bounds(point(xmin, ymin), point(xmax, ymax));\n\n    if (this._templatedLayer) {\n      isVisible = this._templatedLayer.isVisible();\n    } else if (this.rel === 'query') {\n      const minZoom = this.extent?.zoom.minZoom;\n      const maxZoom = this.extent?.zoom.maxZoom;\n      const withinZoomBounds = (z: number) => {\n        return minZoom <= z && z <= maxZoom;\n      };\n\n      const linkBounds = this.getBounds();\n      if (linkBounds?.overlaps(mapBounds) && withinZoomBounds(mapZoom)) {\n        isVisible = true;\n      }\n    }\n    return isVisible;\n  }\n\n  zoomTo() {\n    const extent = this.extent;\n    if (!extent) return;\n    \n    const map = this.getMapEl()._map;\n    const xmin = extent.topLeft.pcrs.horizontal;\n    const xmax = extent.bottomRight.pcrs.horizontal;\n    const ymin = extent.bottomRight.pcrs.vertical;\n    const ymax = extent.topLeft.pcrs.vertical;\n    const newBounds = bounds(point(xmin, ymin), point(xmax, ymax));\n    const center = map.options.crs.unproject(newBounds.getCenter(true));\n    const maxZoom = extent.zoom.maxZoom;\n    const minZoom = extent.zoom.minZoom;\n    \n    map.setView(center, Util.getMaxZoom(newBounds, map, minZoom, maxZoom), {\n      animate: false\n    });\n  }\n\n  _createSelfOrStyleLink() {\n    const layerEl = this.getLayerEl();\n    const changeStyle = function (e: Event) {\n      DomEvent.stop(e);\n      layerEl.dispatchEvent(\n        new CustomEvent('changestyle', {\n          detail: {\n            src: (e.target as any).getAttribute('data-href')\n          }\n        })\n      );\n    };\n\n    const styleOption = document.createElement('div');\n    const styleOptionInput = styleOption.appendChild(\n      document.createElement('input')\n    );\n    styleOptionInput.setAttribute('type', 'radio');\n    styleOptionInput.setAttribute('id', 'rad-' + stamp(styleOptionInput));\n    styleOptionInput.setAttribute(\n      'name',\n      'styles-' + stamp(styleOption)\n    );\n    styleOptionInput.setAttribute('value', this.el.getAttribute('title'));\n    styleOptionInput.setAttribute(\n      'data-href',\n      new URL(this.href, this.getBase()).href\n    );\n    const styleOptionLabel = styleOption.appendChild(\n      document.createElement('label')\n    );\n    styleOptionLabel.setAttribute('for', 'rad-' + stamp(styleOptionInput));\n    styleOptionLabel.innerText = this.el.getAttribute('title');\n    if (this.rel === 'style self' || this.rel === 'self style') {\n      styleOptionInput.checked = true;\n    }\n    this._styleOption = styleOption;\n    styleOptionInput.addEventListener('click', changeStyle.bind(this));\n  }\n\n  getLayerControlOption() {\n    return this._styleOption;\n  }\n\n  resolve() {\n    if (this.trefValue !== M.BLANK_TT_TREF) {\n      const obj: any = {};\n      const inputs = this.el.parentElement?.querySelectorAll('map-input');\n      if (this.rel === 'image') {\n        for (let i = 0; i < inputs.length; i++) {\n          const inp = inputs[i];\n          obj[inp.getAttribute('name')] = (inp as any).value;\n        }\n        return LeafletUtil.template(this.trefValue, obj);\n      } else if (this.rel === 'tile') {\n        return obj;\n      } else if (this.rel === 'query') {\n        // TODO\n      } else if (this.rel === 'features') {\n        // TODO\n      }\n    }\n  }\n\n  @Method()\n  async whenReady(): Promise<void> {\n    return new Promise((resolve, reject) => {\n      let interval: any, failureTimer: any, ready: string;\n      \n      switch (this.rel?.toLowerCase()) {\n        case 'tile':\n        case 'image':\n        case 'features':\n          ready = '_templatedLayer';\n          if (this.disabled) resolve();\n          break;\n        case 'style':\n        case 'self':\n        case 'style self':\n        case 'self style':\n          ready = '_styleOption';\n          break;\n        case 'query':\n          ready = 'shadowRoot';\n          if (this.disabled) resolve();\n          break;\n        case 'alternate':\n          ready = '_alternate';\n          break;\n        case 'stylesheet':\n          if (this.type === 'application/pmtiles+stylesheet') {\n            ready = '_pmtilesRules';\n          } else {\n            ready = '_stylesheetHost';\n          }\n          break;\n        case 'zoomin':\n        case 'zoomout':\n        case 'legend':\n        case 'license':\n          resolve();\n          return;\n        default:\n          resolve();\n          return;\n      }\n      \n      if (this[ready]) {\n        resolve();\n        return;\n      }\n      \n      interval = setInterval(testForLinkReady, 300, this);\n      failureTimer = setTimeout(linkNotDefined, 1000);\n      \n      function testForLinkReady(linkElement: MapLink) {\n        if (linkElement.el[ready]) {\n          clearInterval(interval);\n          clearTimeout(failureTimer);\n          resolve();\n        } else if (!linkElement.el.isConnected) {\n          clearInterval(interval);\n          clearTimeout(failureTimer);\n          reject('map-link was disconnected while waiting to be ready');\n        }\n      }\n      \n      function linkNotDefined() {\n        clearInterval(interval);\n        clearTimeout(failureTimer);\n        reject('Timeout reached waiting for link to be ready');\n      }\n    });\n  }\n\n  render() {\n    return null;\n  }\n}"]}