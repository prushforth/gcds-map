import{r as t,a as i}from"./p-PZrWUcjo.js";const s=class{constructor(i){t(this,i)}get el(){return i(this)}media;_mql;_changeHandler;_observer;styleElement;_stylesheetHost;async mediaChanged(t,i){if(i!==t){await this._registerMediaQuery(t)}}getMapEl(){return window.M?.Util?.getClosest?.(this.el,"gcds-map")||this.el.closest("gcds-map")}_connect(){this.styleElement=document.createElement("style");this.styleElement.mapStyle=this.el;this.styleElement.textContent=this.el.textContent;this._copyAttributes(this.el,this.styleElement);Object.defineProperty(this.el,"styleElement",{get:()=>this.styleElement,configurable:true,enumerable:true});if(!this._stylesheetHost)return;if(this._stylesheetHost._layer){this._stylesheetHost._layer.renderStyles?.(this.el)}else if(this._stylesheetHost._templatedLayer){this._stylesheetHost._templatedLayer.renderStyles?.(this.el)}else if(this._stylesheetHost._extentLayer){this._stylesheetHost._extentLayer.renderStyles?.(this.el)}this._observer=new MutationObserver((()=>{this.styleElement.textContent=this.el.textContent}));this._observer.observe(this.el,{childList:true,subtree:true,characterData:true})}_disconnect(){if(this._observer){this._observer.disconnect();this._observer=undefined}if(this._stylesheetHost&&this.styleElement){this.styleElement.remove();this.styleElement=undefined}}_copyAttributes(t,i){Array.from(t.attributes).forEach((t=>{if(t.nodeName!=="media"&&t.nodeName!=="data-testid"){i.setAttribute(t.nodeName,t.nodeValue)}}))}async _registerMediaQuery(t){if(!this._changeHandler){this._changeHandler=()=>{this._disconnect();if(this._mql&&this._mql.matches){this._connect()}}}if(t){const i=this.getMapEl();if(!i)return;if(typeof i.whenReady==="function")await i.whenReady();if(this._mql){this._mql.removeEventListener("change",this._changeHandler)}this._mql=i.matchMedia(t);this._changeHandler();this._mql.addEventListener("change",this._changeHandler)}else if(this._mql){this._mql.removeEventListener("change",this._changeHandler);this._mql=undefined;this._disconnect();this._connect()}}async connectedCallback(){this._stylesheetHost=this.el.getRootNode()instanceof ShadowRoot?this.el.getRootNode().host:this.el.parentElement;if(!this._stylesheetHost)return;if(this.media){await this._registerMediaQuery(this.media)}else{this._connect()}}disconnectedCallback(){this._disconnect()}static get watchers(){return{media:["mediaChanged"]}}};export{s as map_style};
//# sourceMappingURL=p-b8f9f3e7.entry.js.map