import{l as t,d as e,U as n,r as i,a as r,e as s,i as o,M as l}from"./p-PZrWUcjo.js";import{g as a}from"./p-B85MJLTf.js";import{M as h}from"./p-C8xJJwPc.js";import{r as c}from"./p-EYVT9Efh.js";class f{element;valueSet;attribute;domain;domtokenlist;constructor(t,e,n,i){const r=document.createElement("div");this.domtokenlist=r.classList;this.valueSet=false;this.domtokenlist.value=t??"";this.element=e;this.attribute=n;this.domain=i}get isValueSet(){return this.valueSet}get length(){return this.domtokenlist.length}get value(){return this.domtokenlist.value}set value(t){if(t===null){this.domtokenlist.value=""}else{this.domtokenlist.value=t.toLowerCase();this.valueSet=true;this.element.setAttribute(this.attribute,this.domtokenlist.value);this.valueSet=false}}item(t){return this.domtokenlist.item(t)}contains(t){return this.domtokenlist.contains(t)}add(t){this.domtokenlist.add(t);this.element.setAttribute(this.attribute,this.domtokenlist.value)}remove(t){this.domtokenlist.remove(t);this.element.setAttribute(this.attribute,this.domtokenlist.value)}replace(t,e){const n=this.domtokenlist.replace(t,e);this.element.setAttribute(this.attribute,this.domtokenlist.value);return n}supports(t){return this.domain.includes(t)}toggle(t,e){const n=this.domtokenlist.toggle(t,e);this.element.setAttribute(this.attribute,this.domtokenlist.value);return n}entries(){const t=this.domtokenlist;return t.entries?t.entries():this._manualEntries()}forEach(t,e){if(this.domtokenlist.forEach){this.domtokenlist.forEach(((n,i)=>t.call(e,n,i,this)))}else{for(let n=0;n<this.domtokenlist.length;n++){t.call(e,this.domtokenlist[n],n,this)}}}keys(){const t=this.domtokenlist;return t.keys?t.keys():this._manualKeys()}values(){const t=this.domtokenlist;return t.values?t.values():this._manualValues()}[Symbol.iterator](){return this.values()}*_manualEntries(){for(let t=0;t<this.domtokenlist.length;t++){yield[t,this.domtokenlist[t]]}}*_manualKeys(){for(let t=0;t<this.domtokenlist.length;t++){yield t}}*_manualValues(){for(let t=0;t<this.domtokenlist.length;t++){yield this.domtokenlist[t]}}}const u="<".codePointAt(0),d=">".codePointAt(0),p="=".codePointAt(0),m="/".codePointAt(0),g=(t,e=0)=>{const n=t.at(e);if("delim"===(null==n?void 0:n._t)&&n.value===u){const n=t.at(e+1),i="delim"===(null==n?void 0:n._t)&&n.value===p&&!n.isAfterSpace;return{t:{t:"lt",isIncl:i},i:e+(i?2:1)}}},b=(t,e=0)=>{const n=t.at(e);if("delim"===(null==n?void 0:n._t)&&n.value===d){const n=t.at(e+1),i="delim"===(null==n?void 0:n._t)&&n.value===p&&!n.isAfterSpace;return{t:{t:"gt",isIncl:i},i:e+(i?2:1)}}},v=(t,e=0)=>{var n,i;return null!==(i=null!==(n=g(t,e))&&void 0!==n?n:b(t,e))&&void 0!==i?i:((t,e=0)=>{const n=t.at(e);if("delim"===(null==n?void 0:n._t)&&n.value===p)return{t:{t:"eq"},i:e+1}})(t,e)},w=(t,e=0)=>{const n=((t,e=0)=>{const n=t.at(e);if("number"===(null==n?void 0:n._t)&&n.value>=0){const i=t.at(e+1);if("delim"===(null==i?void 0:i._t)&&i.value===m){const i=t.at(e+2);if("number"===(null==i?void 0:i._t)&&i.value>=0)return{t:{_t:"ratio",left:n.value,right:i.value,start:n.start,end:i.end},i:e+3}}}})(t,e);if(n)return n;const i=t.at(e);if(i&&("number"===i._t||"dimension"===i._t)){return{t:"number"===i._t?{_t:"number",value:i.value,flag:i.flag,start:i.start,end:i.end}:{_t:"dimension",value:i.value,unit:i.unit,start:i.start,end:i.end},i:e+1}}},x=(t,e=0)=>{const n=w(t,e);if(n)return n;const i=t.at(e);return"ident"===(null==i?void 0:i._t)?{t:{_t:"ident",value:i.value,start:i.start,end:i.end},i:e+1}:void 0};const y=(t,e=0)=>{const n=t.at(e);if("ident"===(null==n?void 0:n._t)){const i=t.at(e+1);if("colon"===(null==i?void 0:i._t)){const i=x(t,e+2);if(i)return{t:{_t:"feature",context:"value",feature:n.value,value:i.t,start:n.start,end:i.t.end},i:i.i}}}};const k=(t,e=0)=>{const n=t.at(e);if("ident"===(null==n?void 0:n._t))return{t:{_t:"feature",context:"boolean",feature:n.value,start:n.start,end:n.end},i:e+1}};const _=(t,e=0)=>{var n,i;const r=t.at(e);if("("===(null==r?void 0:r._t)){const r=null!==(i=null!==(n=y(t,e+1))&&void 0!==n?n:((t,e=0)=>{var n;const i=x(t,e);if(i){const e=v(t,i.i);if(e){const r=x(t,e.i);if(r){const s=null!==(n=g(t,r.i))&&void 0!==n?n:b(t,r.i);if(s){const n=x(t,s.i);if(n&&"ident"===r.t._t&&"ident"!==i.t._t&&"ident"!==n.t._t){if("lt"===e.t.t&&"lt"===s.t.t)return{t:{_t:"feature",context:"range",ops:2,feature:r.t.value,minValue:i.t,minOp:e.t.isIncl?"<=":"<",maxOp:s.t.isIncl?"<=":"<",maxValue:n.t,start:i.t.start,end:n.t.end},i:n.i};if("gt"===e.t.t&&"gt"===s.t.t)return{t:{_t:"feature",context:"range",ops:2,feature:r.t.value,minValue:n.t,minOp:s.t.isIncl?"<=":"<",maxOp:e.t.isIncl?"<=":"<",maxValue:i.t,start:i.t.start,end:n.t.end},i:n.i}}}let o="=";if("lt"===e.t.t?o=e.t.isIncl?"<=":"<":"gt"===e.t.t&&(o=e.t.isIncl?">=":">"),"ident"===i.t._t&&"ident"!==r.t._t)return{t:{_t:"feature",context:"range",feature:i.t.value,ops:1,op:o,value:r.t,start:i.t.start,end:r.t.end},i:r.i};if("ident"===r.t._t&&"ident"!==i.t._t){let t="=";return"<"===o?t=">":"<="===o?t=">=":">"===o?t="<":">="===o&&(t="<="),{t:{_t:"feature",context:"range",feature:r.t.value,ops:1,op:t,value:i.t,start:i.t.start,end:r.t.end},i:r.i}}}}}})(t,e+1))&&void 0!==i?i:k(t,e+1);if(r){const e=t.at(r.i);if(")"===(null==e?void 0:e._t))return{t:r.t,i:r.i+1}}}};const z=(t,e=0)=>{var n;const i=t.at(e);if(i&&("function"===i._t||"("===i._t)){const r=["("];let s=e+1,o=t.at(s);t:for(;o;){switch(o._t){case"function":case"(":r.push("(");break;case"{":case"[":r.push(o._t);break;case")":if("("===r.at(-1)&&r.pop(),0===r.length)break t;break;case"]":"["===r.at(-1)&&r.pop();break;case"}":"{"===r.at(-1)&&r.pop()}o=t.at(++s)}if(0===r.length)return{t:{_t:"general-enclosed",tokens:t.slice(e,s),start:i.start,end:(null!==(n=t.at(s))&&void 0!==n?n:t[s-1]).end},i:s}}};const C=(t,e=0)=>{const n=_(t,e);if(n)return{t:{_t:"in-parens",node:n.t},i:n.i};const i=t.at(e);if("("===(null==i?void 0:i._t)){const n=S(t,e+1);if(n){const e=t.at(n.i);if(")"===(null==e?void 0:e._t))return{t:{_t:"in-parens",node:n.t},i:n.i+1}}}const r=z(t,e);return r?{t:{_t:"in-parens",node:r.t},i:r.i}:void 0};const E=(t,e=0)=>{const n=t.at(e);if("ident"===(null==n?void 0:n._t)&&"or"===n.value){const n=C(t,e+1);if(n)return{t:n.t,i:n.i}}};const j=(t,e=0)=>{const n=t.at(e);if("ident"===(null==n?void 0:n._t)&&"and"===n.value){const n=C(t,e+1);if(n)return{t:n.t,i:n.i}}};const T=(t,e=0)=>{const n=t.at(e);if("ident"===(null==n?void 0:n._t)&&"not"===n.value){const n=C(t,e+1);if(n)return{t:n.t,i:n.i}}};const S=(t,e=0)=>{const n=T(t,e);if(n)return{t:{_t:"condition",op:"not",nodes:[n.t],start:t[e].start,end:t[n.i-1].end},i:n.i};{const n=C(t,e);if(n){const i=j(t,n.i);if(i){const r=[i.t];let s=i.i,o=j(t,i.i);for(;o;)r.push(o.t),s=o.i,o=j(t,o.i);return{t:{_t:"condition",op:"and",nodes:[n.t,...r],start:t[e].start,end:t[s-1].end},i:s}}const r=E(t,n.i);if(r){const i=[r.t];let s=r.i,o=E(t,r.i);for(;o;)i.push(o.t),s=o.i,o=E(t,o.i);return{t:{_t:"condition",op:"or",nodes:[n.t,...i],start:t[e].start,end:t[s-1].end},i:s}}return{t:{_t:"condition",op:"and",nodes:[n.t],start:t[e].start,end:t[n.i-1].end},i:n.i}}}};const O=(t,e=0)=>{const n=T(t,e);if(n)return{t:{_t:"condition",op:"not",nodes:[n.t],start:t[e].start,end:t[n.i-1].end},i:n.i};{const n=C(t,e);if(n){const i=j(t,n.i);if(i){const r=[i.t];let s=i.i,o=j(t,i.i);for(;o;)r.push(o.t),s=o.i,o=j(t,o.i);return{t:{_t:"condition",op:"and",nodes:[n.t,...r],start:t[e].start,end:t[s-1].end},i:s}}return{t:{_t:"condition",op:"and",nodes:[n.t],start:t[e].start,end:t[n.i-1].end},i:n.i}}}};const I=t=>{const e=S(t,0);if(e)return{t:{_t:"query",condition:e.t,start:0,end:t[e.i-1].end},i:e.i};{const e=t.at(0);if("ident"===(null==e?void 0:e._t)){if("not"===e.value||"only"===e.value){const n=t.at(1);if("ident"===(null==n?void 0:n._t)){const i=t.at(2);if("ident"===(null==i?void 0:i._t)&&"and"===i.value){const i=O(t,3);if(i)return{t:{_t:"query",condition:i.t,type:n.value,prefix:e.value,start:0,end:t[i.i-1].end},i:i.i}}return{t:{_t:"query",type:n.value,prefix:e.value,start:0,end:n.end},i:2}}}const n=t.at(1);if("ident"===(null==n?void 0:n._t)&&"and"===n.value){const n=O(t,2);if(n)return{t:{_t:"query",condition:n.t,type:e.value,start:0,end:t[n.i-1].end},i:n.i}}return{t:{_t:"query",type:e.value,start:0,end:e.end},i:1}}}};const A=t=>{const e=B(t);if(1===e.length&&0===e[0].length)return{_t:"query-list",nodes:[{_t:"query",type:"all",start:0,end:0}]};{const t=[];for(const n of e){const e=I(n);e&&e.i===n.length?t.push(e.t):t.push(void 0)}return{_t:"query-list",nodes:t}}};const B=t=>{const e=[[]],n=[];for(const i of t)if("comma"===i._t&&0===n.length)e.push([]);else{switch(i._t){case"function":case"(":n.push(")");break;case"[":n.push("]");break;case"{":n.push("}");break;case")":case"]":case"}":n.at(-1)===i._t&&n.pop();break}e[e.length-1].push(i)}return e};const P=t=>"object"==typeof t&&null!==t&&"_errid"in t;let F;const R=t=>{const e=(()=>{let t;return F?t=F:(t=new TextEncoder,F=t),t})().encode(t),n=[],i=e.length;for(let t=0;t<i;t+=1){const i=e.at(t);if(i<128)switch(i){case 0:n.push(65533);break;case 12:n.push(10);break;case 13:n.push(10),10===e.at(t+1)&&(t+=1);break;default:n.push(i)}else i<224?n.push(i<<59>>>53|e[++t]<<58>>>58):i<240?n.push(i<<60>>>48|e[++t]<<58>>>52|e[++t]<<58>>>58):n.push(i<<61>>>43|e[++t]<<58>>>46|e[++t]<<58>>>52|e[++t]<<58>>>58)}return n};const N=t=>{const e=[];let n=false;for(const i of t)switch(i._t){case"{":return{_errid:"NO_LCURLY",start:i.start,end:i.end};case"semicolon":return{_errid:"NO_SEMICOLON",start:i.start,end:i.end};case"whitespace":n=true;break;case"EOF":break;default:e.push({...i,isAfterSpace:n}),n=false}return e};const $=10,q=32,U=45,D=48,Z=57,H=65,V=92,G=97,W=122,Y=128;const J=(t,e=0)=>{const n=[];for(;e<t.length;e+=1){const i=t.at(e),r=e;if(47===i&&42===t.at(e+1)){e+=2;for(let n=t.at(e);void 0!==n;n=t.at(++e))if(42===n&&47===t.at(e+1)){e+=1;break}}else if(9===i||i===q||i===$){let i=t.at(++e);for(;9===i||i===q||i===$;)i=t.at(++e);e-=1;const s=n.at(-1);"whitespace"===(null==s?void 0:s._t)?(n.pop(),n.push({_t:"whitespace",start:s.start,end:e})):n.push({_t:"whitespace",start:r,end:e})}else if(34===i){const i=X(t,e);if(null===i)return{_errid:"INVALID_STRING",start:e,end:e};const[s,o]=i;e=s,n.push({_t:"string",value:o,start:r,end:e})}else if(35===i){if(e+1<t.length){const i=t.at(e+1);if(95===i||i>=H&&i<=90||i>=G&&i<=W||i>=Y||i>=D&&i<=Z||i===V&&e+2<t.length&&t.at(e+2)!==$){const i=K(t,e+1)?"id":"unrestricted",s=nt(t,e+1);if(null!==s){const[t,o]=s;e=t,n.push({_t:"hash",value:o.toLowerCase(),flag:i,start:r,end:e});continue}}}n.push({_t:"delim",value:i,start:r,end:e})}else if(39===i){const i=X(t,e);if(null===i)return{_errid:"INVALID_STRING",start:e,end:e};const[s,o]=i;e=s,n.push({_t:"string",value:o,start:r,end:e})}else if(40===i)n.push({_t:"(",start:r,end:e});else if(41===i)n.push({_t:")",start:r,end:e});else if(43===i){const s=tt(t,e);if(null===s)n.push({_t:"delim",value:i,start:r,end:e});else{const[t,i]=s;e=t,"dimension"===i[0]?n.push({_t:"dimension",value:i[1],unit:i[2].toLowerCase(),flag:"number",start:r,end:e}):"number"===i[0]?n.push({_t:i[0],value:i[1],flag:i[2],start:r,end:e}):n.push({_t:i[0],value:i[1],flag:"number",start:r,end:e})}}else if(44===i)n.push({_t:"comma",start:r,end:e});else if(i===U){const s=tt(t,e);if(null!==s){const[t,i]=s;e=t,"dimension"===i[0]?n.push({_t:"dimension",value:i[1],unit:i[2].toLowerCase(),flag:"number",start:r,end:e}):"number"===i[0]?n.push({_t:i[0],value:i[1],flag:i[2],start:r,end:e}):n.push({_t:i[0],value:i[1],flag:"number",start:r,end:e});continue}if(e+2<t.length){const i=t.at(e+1),s=t.at(e+2);if(i===U&&62===s){e+=2,n.push({_t:"CDC",start:r,end:e});continue}}const o=st(t,e);if(null!==o){const[t,i,s]=o;e=t,n.push({_t:s,value:i,start:r,end:e});continue}n.push({_t:"delim",value:i,start:r,end:e})}else if(46===i){const s=tt(t,e);if(null!==s){const[t,i]=s;e=t,"dimension"===i[0]?n.push({_t:"dimension",value:i[1],unit:i[2].toLowerCase(),flag:"number",start:r,end:e}):"number"===i[0]?n.push({_t:i[0],value:i[1],flag:i[2],start:r,end:e}):n.push({_t:i[0],value:i[1],flag:"number",start:r,end:e});continue}n.push({_t:"delim",value:i,start:r,end:e})}else if(58===i)n.push({_t:"colon",start:r,end:e});else if(59===i)n.push({_t:"semicolon",start:r,end:e});else if(60===i){if(e+3<t.length){const i=t.at(e+1),s=t.at(e+2),o=t.at(e+3);if(33===i&&s===U&&o===U){e+=3,n.push({_t:"CDO",start:r,end:e});continue}}n.push({_t:"delim",value:i,start:r,end:e})}else if(64===i){const s=it(t,e+1);if(null!==s){const[t,i]=s;e=t,n.push({_t:"at-keyword",value:i.toLowerCase(),start:r,end:e});continue}n.push({_t:"delim",value:i,start:r,end:e})}else if(91===i)n.push({_t:"[",start:r,end:e});else if(93===i)n.push({_t:"]",start:r,end:e});else if(123===i)n.push({_t:"{",start:r,end:e});else if(125===i)n.push({_t:"}",start:r,end:e});else if(i>=D&&i<=Z){const i=tt(t,e),[s,o]=i;e=s,"dimension"===o[0]?n.push({_t:"dimension",value:o[1],unit:o[2].toLowerCase(),flag:"number",start:r,end:e}):"number"===o[0]?n.push({_t:o[0],value:o[1],flag:o[2],start:r,end:e}):n.push({_t:o[0],value:o[1],flag:"number",start:r,end:e})}else if(95===i||i>=H&&i<=90||i>=G&&i<=W||i>=Y||i===V){const s=st(t,e);if(null===s)n.push({_t:"delim",value:i,start:r,end:e});else{const[t,i,o]=s;e=t,n.push({_t:o,value:i,start:r,end:e})}}else n.push({_t:"delim",value:i,start:r,end:e})}return n.push({_t:"EOF",start:e,end:e}),n};const X=(t,e)=>{if(t.length<=e+1)return null;const n=t.at(e),i=[];for(let r=e+1;r<t.length;r+=1){const e=t.at(r);if(e===n)return[r,String.fromCodePoint(...i)];if(e===V){const e=Q(t,r);if(null===e)return null;const[n,s]=e;i.push(s),r=n}else{if(e===$)return null;i.push(e)}}return null};const K=(t,e)=>{const n=t.at(e);if(void 0===n)return false;if(n===U){const n=t.at(e+1);if(void 0===n)return false;if(n===U||95===n||n>=H&&n<=90||n>=G&&n<=W||n>=Y)return true;if(n===V){if(t.length<=e+2)return false;return t.at(e+2)!==$}return false}if(95===n||n>=H&&n<=90||n>=G&&n<=W||n>=Y)return true;if(n===V){if(t.length<=e+1)return false;return t.at(e+1)!==$}return false};const Q=(t,e)=>{if(t.length<=e+1)return null;if(t.at(e)!==V)return null;const n=t.at(e+1);if(n===$)return null;if(n>=D&&n<=Z||n>=H&&n<=70||n>=G&&n<=102){const i=[n],r=Math.min(e+7,t.length);let s=e+2;for(;s<r;s+=1){const e=t.at(s);if(!(e>=D&&e<=Z||e>=H&&e<=70||e>=G&&e<=102))break;i.push(e)}if(s<t.length){const e=t.at(s);9!==e&&e!==q&&e!==$||(s+=1)}return[s-1,Number.parseInt(String.fromCodePoint(...i),16)]}return[e+1,n]};const tt=(t,e)=>{const n=et(t,e);if(null===n)return null;const[i,r,s]=n,o=it(t,i+1);if(null!==o){const[t,e]=o;return[t,["dimension",r,e]]}return i+1<t.length&&37===t.at(i+1)?[i+1,["percentage",r]]:[i,["number",r,s]]};const et=(t,e)=>{const n=t.at(e);if(void 0===n)return null;let i="integer";const r=[];for(43!==n&&n!==U||(e+=1,n===U&&r.push(U));e<t.length;){const n=t.at(e);if(!(n>=D&&n<=Z))break;r.push(n),e+=1}if(e+1<t.length){const n=t.at(e),s=t.at(e+1);if(46===n&&s>=D&&s<=Z)for(r.push(n,s),i="number",e+=2;e<t.length;){const n=t.at(e);if(!(n>=D&&n<=Z))break;r.push(n),e+=1}}if(e+1<t.length){const n=t.at(e),s=t.at(e+1),o=t.at(e+2);if(69===n||101===n){let n=false;if(s>=D&&s<=Z?(r.push(69,s),e+=2,n=true):(s===U||43===s)&&void 0!==o&&o>=D&&o<=Z&&(r.push(69),s===U&&r.push(U),r.push(o),e+=3,n=true),n)for(i="number";e<t.length;){const n=t.at(e);if(!(n>=D&&n<=Z))break;r.push(n),e+=1}}}const s=String.fromCodePoint(...r);let o="number"===i?Number.parseFloat(s):Number.parseInt(s);return 0===o&&(o=0),Number.isNaN(o)?null:[e-1,o,i]};const nt=(t,e)=>{if(t.length<=e)return null;const n=[];for(let i=t.at(e);e<t.length;i=t.at(++e)){if(!(i===U||95===i||i>=H&&i<=90||i>=G&&i<=W||i>=Y||i>=D&&i<=Z)){{const i=Q(t,e);if(null!==i){const[t,r]=i;n.push(r),e=t;continue}}break}n.push(i)}return 0===e?null:[e-1,String.fromCodePoint(...n)]};const it=(t,e)=>K(t,e)?nt(t,e):null;const rt=(t,e)=>{let n=t.at(e);for(;9===n||n===q||n===$;)n=t.at(++e);const i=[];let r=false;for(;e<t.length;){if(41===n)return[e,String.fromCodePoint(...i)];if(34===n||39===n||40===n)return null;if(9===n||n===q||n===$)!r&&i.length>0&&(r=true);else if(n===V){const n=Q(t,e);if(null===n||r)return null;const[s,o]=n;i.push(o),e=s}else{if(r)return null;i.push(n)}n=t.at(++e)}return null};const st=(t,e)=>{const n=it(t,e);if(null===n)return null;const[i,r]=n;if("url"===r.toLowerCase()){if(t.length>i+1){if(40===t.at(i+1)){for(let e=2;i+e<t.length;e+=1){const n=t.at(i+e);if(34===n||39===n)return[i+1,r.toLowerCase(),"function"];if(9!==n&&n!==q&&n!==$){const n=rt(t,i+e);if(null===n)return null;const[r,s]=n;return[r,s,"url"]}}return[i+1,r.toLowerCase(),"function"]}}}else if(t.length>i+1){if(40===t.at(i+1))return[i+1,r.toLowerCase(),"function"]}return[i,r.toLowerCase(),"ident"]};const ot=t=>{const e=J(R(t));return P(e)?e:N(e)};
/**! media-query-parser | Tom Golden <oss@tom.bio> (https://tom.bio) | @license MIT  */
/*! v3.0.2 */const lt=t=>{const e=ot(t);return P(e)?e:A(e)};const at=t=>"number"===t._t&&"integer"===t.flag;const ht=t=>"dimension"===t._t&&mt(t.unit)||"number"===t._t&&"integer"===t.flag&&0===t.value;const ct=t=>"dimension"===t._t&&yt(t.unit);const ft=t=>"ratio"===t._t||at(t)&&t.value>=0;const ut=new Set(["cm","mm","q","in","pc","pt","px"]),dt=t=>ut.has(t.unit),pt=new Set([...ut,"em","ex","cap","ch","ic","rem","lh","rlh","vw","vh","vi","vb","vmin","vmax","svw","svh","svi","svb","svmin","svmax","lvw","lvh","lvi","lvb","lvmin","lvmax","dvw","dvh","dvi","dvb","dvmin","dvmax","cqw","cqh","cqi","cqb","cqmin","cqmax"]),mt=t=>pt.has(t);const gt=(t,e)=>{const n="number"===t._t?{_t:"dimension",value:0,unit:"px"}:t,i="number"===e._t?{_t:"dimension",value:0,unit:"px"}:e;if(dt(n)){const t=vt(n);if(dt(i)){const e=vt(i);return t===e?"eq":t>e?"gt":"lt"}return 0===t&&0===i.value?"eq":"unknown"}if(dt(i)){const t=gt(i,n);return"lt"===t?"gt":"gt"===t?"lt":t}return 0===n.value&&0===i.value?"eq":"unknown"};const bt=new Map([["cm",96/2.54],["mm",96/25.4],["q",96/101.6],["in",96],["pc",16],["pt",96/72]]),vt=t=>{var e;return t.value*(null!==(e=bt.get(t.unit))&&void 0!==e?e:1)};const wt=(t,e)=>{const n="number"===t._t?t.value:t.left,i="number"===t._t?1:t.right,r="number"===e._t?e.value:e.left,s="number"===e._t?1:e.right;if(0===n&&0===i)return 0===r&&0===s?"eq":"incomparable";if(0===r&&0===s)return"incomparable";if(0===n&&0===r)return"eq";if(0===i&&0===s)return"eq";if(0!==n&&0!==r&&0!==i&&0!==s&&n*s==r*i)return"eq";const o=n/i,l=r/s;return o>l?"gt":o<l?"lt":"eq"};const xt=new Set(["dpi","dpcm","dppx","x"]),yt=t=>xt.has(t);const kt=(t,e)=>{const n=zt(t),i=zt(e);return n===i?"eq":n>i?"gt":"lt"};const _t=new Map([["dpi",96],["dpcm",96/2.54],["dppx",1]]),zt=t=>{var e;return t.value*(null!==(e=_t.get(t.unit))&&void 0!==e?e:1)};const Mt=(t,e)=>{const n=t.feature.startsWith("min-"),i=t.feature.startsWith("max-");if((n||i)&&"value"===t.context&&"ident"!==t.value._t)return Mt({_t:"feature",context:"range",ops:1,feature:t.feature.slice(4),op:n?">=":"<=",value:t.value,start:t.start,end:t.end},e);{const n=e.features.get(t.feature);if(n){if("boolean"===t.context){return"discrete"===n.type&&(n.values.has("none")||n.values.has(0))||"range"===n.type&&("ratio"===n.valueType?n.canNumeratorBeZero:n.canBeZero)?e.solveUnknownFeature(t):"true"}if("value"===t.context){if("discrete"===n.type){let i;if("ident"===t.value._t)i=t.value.value;else{if("number"!==t.value._t||"integer"!==t.value.flag)return"false";i=t.value.value}return n.values.has(i)?e.solveUnknownFeature(t):"false"}if("integer"===n.valueType){if(at(t.value)){return t.value.value<0&&!n.canBeNegative||0===t.value.value&&!n.canBeZero?"false":e.solveUnknownFeature(t)}return"false"}if("length"===n.valueType){if(ht(t.value)){const i=gt(t.value,{_t:"number",value:0});return"lt"===i&&!n.canBeNegative||"eq"===i&&!n.canBeZero?"false":e.solveUnknownFeature(t)}return"false"}if("ratio"===n.valueType){if(ft(t.value)){return"eq"===wt(t.value,{_t:"number",value:0})&&!n.canNumeratorBeZero?"false":e.solveUnknownFeature(t)}return"false"}if(ct(t.value)){const i=kt(t.value,{value:0,unit:"x"});return"lt"===i&&!n.canBeNegative||"eq"===i&&!n.canBeZero?"false":e.solveUnknownFeature(t)}return"false"}if("discrete"===n.type)return"false";if(2===t.ops)return Lt({op:"and",nodes:[{_t:"in-parens",node:{_t:"feature",context:"range",ops:1,feature:t.feature,op:"<"===t.minOp?">":">=",value:t.minValue,start:t.minValue.start,end:t.minValue.end}},{_t:"in-parens",node:{_t:"feature",context:"range",ops:1,feature:t.feature,op:t.maxOp,value:t.maxValue,start:t.maxValue.start,end:t.maxValue.end}}]},e);if("ratio"===n.valueType){if(ft(t.value)){const i="number"===t.value._t?t.value.value:t.value.left,r="number"===t.value._t?1:t.value.right;if(0===i&&0!==r&&("="===t.op&&!n.canNumeratorBeZero||"<="===t.op&&!n.canNumeratorBeZero||"<"===t.op)||0===i&&0===r&&(!n.canNumeratorBeZero||!n.canDenominatorBeZero)&&("<"===t.op||">"===t.op))return"false";return">="===t.op&&0===i&&0!==r&&!n.canDenominatorBeZero||">"===t.op&&0===i&&0!==r&&!n.canNumeratorBeZero&&n.canDenominatorBeZero||"<="===t.op&&0!==i&&0===r&&!(n.canNumeratorBeZero&&n.canDenominatorBeZero)||"<"===t.op&&0!==i&&0===r&&!n.canDenominatorBeZero?"true":e.solveUnknownFeature(t)}return"false"}if("integer"===n.valueType){if(at(t.value)){if("="===t.op&&!n.canBeNegative&&t.value.value<0||"="===t.op&&!n.canBeZero&&0===t.value.value||"<="===t.op&&!n.canBeNegative&&t.value.value<0||"<="===t.op&&!n.canBeNegative&&!n.canBeZero&&0===t.value.value||"<"===t.op&&!n.canBeNegative&&t.value.value<=0||"<"===t.op&&!n.canBeNegative&&!n.canBeZero&&1===t.value.value)return"false";return">="===t.op&&!n.canBeNegative&&t.value.value<=0||">="===t.op&&!n.canBeNegative&&!n.canBeZero&&1===t.value.value||">"===t.op&&!n.canBeNegative&&t.value.value<0||">"===t.op&&!n.canBeNegative&&!n.canBeZero&&0===t.value.value?"true":e.solveUnknownFeature(t)}return"false"}if("length"===n.valueType){if(ht(t.value)){if("="===t.op&&!n.canBeNegative&&t.value.value<0||"="===t.op&&!n.canBeZero&&0===t.value.value||"<="===t.op&&!n.canBeNegative&&t.value.value<0||"<="===t.op&&!n.canBeNegative&&!n.canBeZero&&0===t.value.value||"<"===t.op&&!n.canBeNegative&&t.value.value<=0)return"false";return">="===t.op&&!n.canBeNegative&&t.value.value<=0||">"===t.op&&!n.canBeNegative&&t.value.value<0||">"===t.op&&!n.canBeNegative&&!n.canBeZero&&0===t.value.value?"true":e.solveUnknownFeature(t)}return"false"}if(ct(t.value)){if("="===t.op&&!n.canBeNegative&&t.value.value<0||"="===t.op&&!n.canBeZero&&0===t.value.value||"<="===t.op&&!n.canBeNegative&&t.value.value<0||"<="===t.op&&!n.canBeNegative&&!n.canBeZero&&0===t.value.value||"<"===t.op&&!n.canBeNegative&&t.value.value<=0)return"false";return">="===t.op&&!n.canBeNegative&&t.value.value<=0||">"===t.op&&!n.canBeNegative&&t.value.value<0||">"===t.op&&!n.canBeNegative&&!n.canBeZero&&0===t.value.value?"true":e.solveUnknownFeature(t)}return"false"}return"false"}};const Ct=(t,e)=>"condition"===t.node._t?Lt(t.node,e):"feature"===t.node._t?Mt(t.node,e):e.solveGeneralEnclosed(t.node);const Lt=(t,e)=>"and"===t.op?Tt(...t.nodes.map((t=>Ct(t,e)))):"or"===t.op?St(...t.nodes.map((t=>Ct(t,e)))):jt(Ct(t.nodes[0],e));const Et=(t,e)=>{if("true"===e.isLegacyBrowser&&"only"===t.prefix)return"false";let n;n=void 0===t.type||"all"===t.type?"true":"screen"===t.type?e.isMediaTypeScreen:"print"===t.type?jt(e.isMediaTypeScreen):"false";const i=void 0===t.condition?"true":Lt(t.condition,e),r=Tt(n,i);return"not"===t.prefix?jt(r):r};const jt=t=>"true"===t?"false":"false"===t?"true":"unknown";const Tt=(...t)=>t.reduce(((t,e)=>"false"===t||"false"===e?"false":"unknown"===t||"unknown"===e?"unknown":"true"),"true");const St=(...t)=>t.reduce(((t,e)=>"true"===t||"true"===e?"true":"unknown"===t||"unknown"===e?"unknown":"false"),"false");const Ot={"color-gamut":{type:"discrete",values:["srgb","p3","rec2020"]},"display-mode":{type:"discrete",values:["fullscreen","standalone","minimal-ui","browser"]},"dynamic-range":{type:"discrete",values:["standard","high"]},"environment-blending":{type:"discrete",values:["opaque","additive","subtractive"]},orientation:{type:"discrete",values:["portrait","landscape"]},"prefers-color-scheme":{type:"discrete",values:["light","dark"]},"prefers-contrast":{type:"discrete",values:["no-preference","less","more","custom"]},"prefers-reduced-data":{type:"discrete",values:["no-preference","reduce"]},"prefers-reduced-motion":{type:"discrete",values:["no-preference","reduce"]},"prefers-reduced-transparency":{type:"discrete",values:["no-preference","reduce"]},scan:{type:"discrete",values:["interlace","progressive"]},"video-color-gamut":{type:"discrete",values:["srgb","p3","rec2020"]},"video-dynamic-range":{type:"discrete",values:["standard","high"]},"any-hover":{type:"discrete",values:["none","hover"]},"any-pointer":{type:"discrete",values:["none","coarse","fine"]},"forced-colors":{type:"discrete",values:["none","active"]},hover:{type:"discrete",values:["none","hover"]},"inverted-colors":{type:"discrete",values:["none","inverted"]},"nav-controls":{type:"discrete",values:["none","back"]},"overflow-block":{type:"discrete",values:["none","scroll","paged"]},"overflow-inline":{type:"discrete",values:["none","scroll"]},pointer:{type:"discrete",values:["none","coarse","fine"]},update:{type:"discrete",values:["none","slow","fast"]},scripting:{type:"discrete",values:["none","initial-only","enabled"]},grid:{type:"discrete",values:[0,1]},resolution:{type:"range",valueType:"resolution",canBeZero:true,canBeNegative:false,extraValues:{infinite:Number.POSITIVE_INFINITY}},"device-height":{type:"range",valueType:"length",canBeZero:true,canBeNegative:false},"device-width":{type:"range",valueType:"length",canBeZero:true,canBeNegative:false},height:{type:"range",valueType:"length",canBeZero:true,canBeNegative:false},width:{type:"range",valueType:"length",canBeZero:true,canBeNegative:false},"device-aspect-ratio":{type:"range",valueType:"ratio",canNumeratorBeZero:true,canDenominatorBeZero:true},"aspect-ratio":{type:"range",valueType:"ratio",canNumeratorBeZero:true,canDenominatorBeZero:true},color:{type:"range",valueType:"integer",canBeZero:true,canBeNegative:false},"horizontal-viewport-segments":{type:"range",valueType:"integer",canBeZero:true,canBeNegative:false},"color-index":{type:"range",valueType:"integer",canBeZero:true,canBeNegative:false},monochrome:{type:"range",valueType:"integer",canBeZero:true,canBeNegative:false},"vertical-viewport-segments":{type:"range",valueType:"integer",canBeZero:true,canBeNegative:false}};const It=t=>Object.entries(t);const At=t=>{var e,n,i,r,s,o;const l=new Map;for(const[i,r]of It({...Ot,...null==t?void 0:t.features}))"discrete"===r.type?l.set(i,{...r,values:new Set(null!==(e=r.values)&&void 0!==e?e:[])}):l.set(i,{...r,extraValues:new Map(It(null!==(n=null==r?void 0:r.extraValues)&&void 0!==n?n:{}))});return{solveUnknownFeature:null!==(i=null==t?void 0:t.solveUnknownFeature)&&void 0!==i?i:()=>"unknown",solveGeneralEnclosed:null!==(r=null==t?void 0:t.solveGeneralEnclosed)&&void 0!==r?r:()=>"unknown",isMediaTypeScreen:null!==(s=null==t?void 0:t.isMediaTypeScreen)&&void 0!==s?s:"unknown",isLegacyBrowser:null!==(o=null==t?void 0:t.isLegacyBrowser)&&void 0!==o?o:"unknown",features:l}};const Bt=(t,e)=>{const n="string"==typeof t?lt(t):t;return P(n)?"false":Pt(n,At(e))};const Pt=(t,e)=>{const n=t.nodes.map((t=>void 0===t?"false":Et(t,e)));if(0===n.length)return"true";{let t="false";for(const e of n){if("true"===e)return"true";"unknown"===e&&(t="unknown")}return t}};const Ft=function(t){const e=lt(t);const n=this;const i={"prefers-lang":{type:"discrete",get values(){return[navigator.language.substring(0,2)]}},"map-projection":{type:"discrete",get values(){return[n.projection.toLowerCase()]}},"map-zoom":{type:"range",valueType:"integer",canBeNegative:false,canBeZero:true,get extraValues(){return{min:0,max:n.zoom}}},"map-top-left-easting":{type:"range",valueType:"integer",canBeNegative:true,canBeZero:true,get values(){return[Math.trunc(n.extent.topLeft.pcrs.horizontal)]}},"map-top-left-northing":{type:"range",valueType:"integer",canBeNegative:true,canBeZero:true,get values(){return[Math.trunc(n.extent.topLeft.pcrs.vertical)]}},"map-bottom-right-easting":{type:"range",valueType:"integer",canBeNegative:true,canBeZero:true,get values(){return[Math.trunc(n.extent.bottomRight.pcrs.horizontal)]}},"map-bottom-right-northing":{type:"range",valueType:"integer",canBeNegative:true,canBeZero:true,get values(){return[Math.trunc(n.extent.bottomRight.pcrs.vertical)]}},"prefers-color-scheme":{type:"discrete",get values(){return[window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"]}},"prefers-map-content":{type:"discrete",get values(){return M.options.contentPreference}}};const r=t=>{let e=t.feature;let n=t.value.value;if(e==="prefers-lang"){return i["prefers-lang"].values.includes(n).toString()}else if(e==="map-zoom"||e==="map-top-left-easting"||e==="map-top-left-northing"||e==="map-bottom-right-easting"||e==="map-bottom-right-northing"){return o(t)}else if(e==="map-projection"){return i["map-projection"].values.some((t=>t===n)).toString()}else if(e==="prefers-color-scheme"){return i["prefers-color-scheme"].values.some((t=>t===n)).toString()}else if(e==="prefers-map-content"){return i[e].values.some((t=>t===n)).toString()}return"false"};let s=Bt(e,{features:i,solveUnknownFeature:r})==="true"?true:false;function o(t){const{context:e,feature:n,value:i,op:r}=t;if(!n.startsWith("map-")){return"unknown"}const s=l(n);if(s===undefined){return"unknown"}if(e==="value"){return s===i.value?"true":"false"}if(e==="range"){switch(r){case"<":return s<i.value?"true":"false";case"<=":return s<=i.value?"true":"false";case">":return s>i.value?"true":"false";case">=":return s>=i.value?"true":"false";case"=":return s===i.value?"true":"false";default:return"unknown"}}return"unknown"}function l(t){switch(t){case"map-zoom":return n.zoom;case"map-top-left-easting":return Math.trunc(n.extent.topLeft.pcrs.horizontal);case"map-top-left-northing":return Math.trunc(n.extent.topLeft.pcrs.vertical);case"map-bottom-right-easting":return Math.trunc(n.extent.bottomRight.pcrs.horizontal);case"map-bottom-right-northing":return Math.trunc(n.extent.bottomRight.pcrs.vertical);default:return undefined}}const a=Object.assign(new EventTarget,{matches:s,media:t,listeners:[],addEventListener(t,e){if(t==="change"){this.listeners.push(e);if(this.listeners.length!==0){h()}EventTarget.prototype.addEventListener.call(this,t,e)}},removeEventListener(t,e){if(t==="change"){this.listeners=this.listeners.filter((t=>t!==e));if(this.listeners.length===0){c()}EventTarget.prototype.removeEventListener.call(this,t,e)}}});const h=()=>{const t=()=>{const t=Bt(e,{features:i,solveUnknownFeature:r})==="true"?true:false;if(t!==a.matches){a.matches=t;a.dispatchEvent(new Event("change"))}};t.bind(this);this.addEventListener("map-projectionchange",t);this.addEventListener("map-moveend",t);const n=window.matchMedia("(prefers-color-scheme: dark)");n.addEventListener("change",t);c=()=>{this.removeEventListener("map-projectionchange",t);this.removeEventListener("map-moveend",t);n.removeEventListener("change",t)}};let c;return a};var Rt=t.Control.Layers.extend({options:{autoZIndex:false,sortLayers:true,sortFunction:function(t,e){return t.options.zIndex<e.options.zIndex?-1:t.options.zIndex>e.options.zIndex?1:0}},initialize:function(e,n){t.setOptions(this,n);this._layerControlInputs=[];this._layers=[];this._lastZIndex=0;this._handlingClick=false;for(var i in e){this._addLayer(e[i],i,true)}},onAdd:function(){this._initLayout();t.DomEvent.on(this._container.getElementsByTagName("a")[0],"keydown",this._focusFirstLayer,this._container);t.DomEvent.on(this._container,"contextmenu",this._preventDefaultContextMenu,this);this._update();if(this._layers.length<1&&!this._map._showControls){this._container.setAttribute("hidden","")}else{this._map._showControls=true}return this._container},onRemove:function(e){t.DomEvent.off(this._container.getElementsByTagName("a")[0],"keydown",this._focusFirstLayer,this._container)},addOrUpdateOverlay:function(t,e){var n=false;for(var i=0;i<this._layers.length;i++){if(this._layers[i].layer===t){n=true;this._layers[i].name=e;break}}if(!n){this.addOverlay(t,e)}if(this._layers.length>0){this._container.removeAttribute("hidden");this._map._showControls=true}return this._map?this._update():this},removeLayer:function(e){t.Control.Layers.prototype.removeLayer.call(this,e);if(this._layers.length===0){this._container.setAttribute("hidden","")}},_checkDisabledLayers:function(){},_focusFirstLayer:function(t){if(t.key==="Enter"&&this.className==="leaflet-control-layers leaflet-control leaflet-control-layers-expanded"){var e=this.children[1].children[2].children[0].children[0].children[0].children[0];if(e)setTimeout((()=>e.focus()),0)}},_update:function(){if(!this._container){return this}t.DomUtil.empty(this._baseLayersList);t.DomUtil.empty(this._overlaysList);this._layerControlInputs=[];var e,n,i,r,s=0;if(this.options.sortLayers){this._layers.sort(((t,e)=>this.options.sortFunction(t.layer,e.layer,t.name,e.name)))}for(i=0;i<this._layers.length;i++){r=this._layers[i];this._addItem(r);n=n||r.overlay;e=e||!r.overlay;s+=!r.overlay?1:0}if(this.options.hideSingleBase){e=e&&s>1;this._baseLayersList.style.display=e?"":"none"}this._separator.style.display=n&&e?"":"none";return this},_addItem:function(e){var n=e.layer._layerEl._layerControlHTML;e.input=n.querySelector("input.leaflet-control-layers-selector");this._layerControlInputs.push(e.input);e.input.layerId=t.stamp(e.layer);this._overlaysList.appendChild(n);return n},collapse:function(e){if(!this._container.className.includes("expanded")){return}if(!this._map.contextMenu._extentLayerMenu.hidden||!this._map.contextMenu._layerMenu.hidden){return}if(e.target.tagName==="SELECT"||e.relatedTarget&&e.relatedTarget.parentElement&&(e.relatedTarget.className==="mapml-contextmenu mapml-layer-menu"||e.relatedTarget.parentElement.className==="mapml-contextmenu mapml-layer-menu")||this._map&&this._map.contextMenu._layerMenu.style.display==="block")return this;t.DomUtil.removeClass(this._container,"leaflet-control-layers-expanded");if(e.originalEvent?.pointerType==="touch"){this._container._isExpanded=false}return this},_preventDefaultContextMenu:function(t){let e=this._map.mouseEventToLatLng(t);let n=this._map.mouseEventToContainerPoint(t);t.preventDefault();if(!this._container._isExpanded&&t.pointerType==="touch"){this._container._isExpanded=true;return}this._map.fire("contextmenu",{originalEvent:t,containerPoint:n,latlng:e})}});var Nt=function(t,e){return new Rt(t,e)};var $t=t.Control.extend({options:{position:"topleft"},_getLocale:function(t){return t.options.mapEl&&t.options.mapEl.locale?t.options.mapEl.locale:M.options.locale},onAdd:function(e){let n=this._getLocale(e);let i=t.DomUtil.create("div","mapml-reload-button leaflet-bar");let r=t.DomUtil.create("button","mapml-reload-button",i);r.innerHTML="<span aria-hidden='true'>&#x021BA</span>";r.title=n.cmReload;r.setAttribute("type","button");r.classList.add("mapml-button");r.setAttribute("aria-label","Reload");t.DomEvent.disableClickPropagation(r);t.DomEvent.on(r,"click",t.DomEvent.stop);t.DomEvent.on(r,"click",this._goReload,this);this._reloadButton=r;this._updateDisabled();e.on("moveend",this._updateDisabled,this);return i},onRemove:function(t){t.off("moveend",this._updateDisabled,this)},disable:function(){this._disabled=true;this._updateDisabled();return this},enable:function(){this._disabled=false;this._updateDisabled();return this},_goReload:function(t){if(!this._disabled&&this._map.options.mapEl._history.length>1){this._map.options.mapEl.reload()}},_updateDisabled:function(){setTimeout((()=>{t.DomUtil.removeClass(this._reloadButton,"leaflet-disabled");this._reloadButton.setAttribute("aria-disabled","false");if(this._map&&(this._disabled||this._map.options.mapEl._history.length<=1)){t.DomUtil.addClass(this._reloadButton,"leaflet-disabled");this._reloadButton.setAttribute("aria-disabled","true")}}),0)}});var qt=function(t){return new $t(t)};var Ut=t.Control.Scale.extend({options:{maxWidth:100,updateWhenIdle:true,position:"bottomleft"},onAdd:function(e){let n="<output role='status' aria-live='polite' aria-atomic='true' class='mapml-screen-reader-output-scale'></output>";e._container.insertAdjacentHTML("beforeend",n);this._container=t.DomUtil.create("div","mapml-control-scale");let i=t.Control.Scale.prototype.onAdd.call(this,e);this._container.appendChild(i);this._container.setAttribute("tabindex",0);this._scaleControl=this;setTimeout((()=>{this._updateOutput();this._focusOutput()}),0);e.on("zoomend moveend",this._updateOutput,this);this._map._container.addEventListener("focus",(()=>this._focusOutput()));return this._container},onRemove:function(t){t.off("zoomend moveend",this._updateOutput,this)},getContainer:function(){return this._container},_pixelsToDistance:function(t,e){let n=window.devicePixelRatio*96;if(e==="metric"){return t/n*2.54}return t/n},_scaleLength:function(t){let e=t.getAttribute("style");let n=parseInt(e.match(/width:\s*(\d+)px/)[1]);return n},_focusOutput:function(){setTimeout((()=>{let t=this._map._container.querySelector(".mapml-screen-reader-output-scale");t.textContent="";setTimeout((()=>{t.textContent=this._container.getAttribute("aria-label")}),100)}),0)},_updateOutput:function(){let t="";let e=this._scaleControl.getContainer().getElementsByClassName("leaflet-control-scale-line")[0];if(this.options.metric){let n=parseFloat(this._pixelsToDistance(this._scaleLength(e),"metric").toFixed(1));t=`${n} centimeters to ${e.textContent.trim()}`;t=t.replace(/(\d+)\s*m\b/g,"$1 meters");t=t.replace(/ km/g," kilometers")}else{let n=parseFloat(this._pixelsToDistance(this._scaleLength(e),"imperial").toFixed(1));t=`${n} inches to ${e.textContent.trim()}`;t=t.replace(/ft/g,"feet");t=t.replace(/mi/g,"miles")}this._container.setAttribute("aria-label",t);this._map._container.querySelector(".mapml-screen-reader-output-scale").textContent=t}});var Dt=function(t){return new Ut(t)};var Zt={exports:{}};
/*!
Copyright (c) 2016 Dominik Moritz

This file is part of the leaflet locate control. It is licensed under the MIT license.
You can find the project at: https://github.com/domoritz/leaflet-locatecontrol
*/var Ht;function Vt(){if(Ht)return Zt.exports;Ht=1;(function(t,n){(function(n,i){{if(typeof i!=="undefined"&&i.L){t.exports=n(L)}else{t.exports=n(e())}}if(typeof i!=="undefined"&&i.L){i.L.Control.Locate=n(L)}})((function(t){const e=(e,n,i)=>{i=i.split(" ");i.forEach((function(i){t.DomUtil[e].call(this,n,i)}))};const n=(t,n)=>e("addClass",t,n);const i=(t,n)=>e("removeClass",t,n);const r=t.Marker.extend({initialize(e,n){t.Util.setOptions(this,n);this._latlng=e;this.createIcon()},createIcon(){const e=this.options;let n="";if(e.color!==undefined){n+=`stroke:${e.color};`}if(e.weight!==undefined){n+=`stroke-width:${e.weight};`}if(e.fillColor!==undefined){n+=`fill:${e.fillColor};`}if(e.fillOpacity!==undefined){n+=`fill-opacity:${e.fillOpacity};`}if(e.opacity!==undefined){n+=`opacity:${e.opacity};`}const i=this._getIconSVG(e,n);this._locationIcon=t.divIcon({className:i.className,html:i.svg,iconSize:[i.w,i.h]});this.setIcon(this._locationIcon)},_getIconSVG(t,e){const n=t.radius;const i=t.weight;const r=n+i;const s=r*2;const o=`<svg xmlns="http://www.w3.org/2000/svg" width="${s}" height="${s}" version="1.1" viewBox="-${r} -${r} ${s} ${s}">`+'<circle r="'+n+'" style="'+e+'" />'+"</svg>";return{className:"leaflet-control-locate-location",svg:o,w:s,h:s}},setStyle(e){t.Util.setOptions(this,e);this.createIcon()}});const s=r.extend({initialize(e,n,i){t.Util.setOptions(this,i);this._latlng=e;this._heading=n;this.createIcon()},setHeading(t){this._heading=t},_getIconSVG(t,e){const n=t.radius;const i=t.width+t.weight;const r=(n+t.depth+t.weight)*2;const s=`M0,0 l${t.width/2},${t.depth} l-${i},0 z`;const o=`transform: rotate(${this._heading}deg)`;const l=`<svg xmlns="http://www.w3.org/2000/svg" width="${i}" height="${r}" version="1.1" viewBox="-${i/2} 0 ${i} ${r}" style="${o}">`+'<path d="'+s+'" style="'+e+'" />'+"</svg>";return{className:"leaflet-control-locate-heading",svg:l,w:i,h:r}}});const o=t.Control.extend({options:{position:"topleft",layer:undefined,setView:"untilPanOrZoom",keepCurrentZoomLevel:false,initialZoomLevel:false,getLocationBounds(t){return t.bounds},flyTo:false,clickBehavior:{inView:"stop",outOfView:"setView",inViewNotFollowing:"inView"},returnToPrevBounds:false,cacheLocation:true,drawCircle:true,drawMarker:true,showCompass:true,markerClass:r,compassClass:s,circleStyle:{className:"leaflet-control-locate-circle",color:"#136AEC",fillColor:"#136AEC",fillOpacity:.15,weight:0},markerStyle:{className:"leaflet-control-locate-marker",color:"#fff",fillColor:"#2A93EE",fillOpacity:1,weight:3,opacity:1,radius:9},compassStyle:{fillColor:"#2A93EE",fillOpacity:1,weight:0,color:"#fff",opacity:1,radius:9,width:9,depth:6},followCircleStyle:{},followMarkerStyle:{},followCompassStyle:{},icon:"leaflet-control-locate-location-arrow",iconLoading:"leaflet-control-locate-spinner",iconElementTag:"span",textElementTag:"small",circlePadding:[0,0],metric:true,createButtonCallback(e,n){const i=t.DomUtil.create("a","leaflet-bar-part leaflet-bar-part-single",e);i.title=n.strings.title;i.href="#";i.setAttribute("role","button");const r=t.DomUtil.create(n.iconElementTag,n.icon,i);if(n.strings.text!==undefined){const e=t.DomUtil.create(n.textElementTag,"leaflet-locate-text",i);e.textContent=n.strings.text;i.classList.add("leaflet-locate-text-active");i.parentNode.style.display="flex";if(n.icon.length>0){r.classList.add("leaflet-locate-icon")}}return{link:i,icon:r}},onLocationError(t,e){alert(t.message)},onLocationOutsideMapBounds(t){t.stop();alert(t.options.strings.outsideMapBoundsMsg)},showPopup:true,strings:{title:"Show me where I am",metersUnit:"meters",feetUnit:"feet",popup:"You are within {distance} {unit} from this point",outsideMapBoundsMsg:"You seem located outside the boundaries of the map"},locateOptions:{maxZoom:Infinity,watch:true,setView:false}},initialize(e){for(const n in e){if(typeof this.options[n]==="object"){t.extend(this.options[n],e[n])}else{this.options[n]=e[n]}}this.options.followMarkerStyle=t.extend({},this.options.markerStyle,this.options.followMarkerStyle);this.options.followCircleStyle=t.extend({},this.options.circleStyle,this.options.followCircleStyle);this.options.followCompassStyle=t.extend({},this.options.compassStyle,this.options.followCompassStyle)},onAdd(e){const n=t.DomUtil.create("div","leaflet-control-locate leaflet-bar leaflet-control");this._container=n;this._map=e;this._layer=this.options.layer||new t.LayerGroup;this._layer.addTo(e);this._event=undefined;this._compassHeading=null;this._prevBounds=null;const i=this.options.createButtonCallback(n,this.options);this._link=i.link;this._icon=i.icon;t.DomEvent.on(this._link,"click",(function(e){t.DomEvent.stopPropagation(e);t.DomEvent.preventDefault(e);this._onClick()}),this).on(this._link,"dblclick",t.DomEvent.stopPropagation);this._resetVariables();this._map.on("unload",this._unload,this);return n},_onClick(){this._justClicked=true;const t=this._isFollowing();this._userPanned=false;this._userZoomed=false;if(this._active&&!this._event){this.stop()}else if(this._active){const e=this.options.clickBehavior;let n=e.outOfView;if(this._map.getBounds().contains(this._event.latlng)){n=t?e.inView:e.inViewNotFollowing}if(e[n]){n=e[n]}switch(n){case"setView":this.setView();break;case"stop":this.stop();if(this.options.returnToPrevBounds){const t=this.options.flyTo?this._map.flyToBounds:this._map.fitBounds;t.bind(this._map)(this._prevBounds)}break}}else{if(this.options.returnToPrevBounds){this._prevBounds=this._map.getBounds()}this.start()}this._updateContainerStyle()},start(){this._activate();if(this._event){this._drawMarker(this._map);if(this.options.setView){this.setView()}}this._updateContainerStyle()},stop(){this._deactivate();this._cleanClasses();this._resetVariables();this._removeMarker()},stopFollowing(){this._userPanned=true;this._updateContainerStyle();this._drawMarker()},_activate(){if(this._active||!this._map){return}this._map.locate(this.options.locateOptions);this._map.fire("locateactivate",this);this._active=true;this._map.on("locationfound",this._onLocationFound,this);this._map.on("locationerror",this._onLocationError,this);this._map.on("dragstart",this._onDrag,this);this._map.on("zoomstart",this._onZoom,this);this._map.on("zoomend",this._onZoomEnd,this);if(this.options.showCompass){const e="ondeviceorientationabsolute"in window;if(e||"ondeviceorientation"in window){const n=this;const i=function(){t.DomEvent.on(window,e?"deviceorientationabsolute":"deviceorientation",n._onDeviceOrientation,n)};if(DeviceOrientationEvent&&typeof DeviceOrientationEvent.requestPermission==="function"){DeviceOrientationEvent.requestPermission().then((function(t){if(t==="granted"){i()}}))}else{i()}}}},_deactivate(){if(!this._active||!this._map){return}this._map.stopLocate();this._map.fire("locatedeactivate",this);this._active=false;if(!this.options.cacheLocation){this._event=undefined}this._map.off("locationfound",this._onLocationFound,this);this._map.off("locationerror",this._onLocationError,this);this._map.off("dragstart",this._onDrag,this);this._map.off("zoomstart",this._onZoom,this);this._map.off("zoomend",this._onZoomEnd,this);if(this.options.showCompass){this._compassHeading=null;if("ondeviceorientationabsolute"in window){t.DomEvent.off(window,"deviceorientationabsolute",this._onDeviceOrientation,this)}else if("ondeviceorientation"in window){t.DomEvent.off(window,"deviceorientation",this._onDeviceOrientation,this)}}},setView(){this._drawMarker();if(this._isOutsideMapBounds()){this._event=undefined;this.options.onLocationOutsideMapBounds(this)}else{if(this._justClicked&&this.options.initialZoomLevel!==false){var e=this.options.flyTo?this._map.flyTo:this._map.setView;e.bind(this._map)([this._event.latitude,this._event.longitude],this.options.initialZoomLevel)}else if(this.options.keepCurrentZoomLevel){var e=this.options.flyTo?this._map.flyTo:this._map.panTo;e.bind(this._map)([this._event.latitude,this._event.longitude])}else{var e=this.options.flyTo?this._map.flyToBounds:this._map.fitBounds;this._ignoreEvent=true;e.bind(this._map)(this.options.getLocationBounds(this._event),{padding:this.options.circlePadding,maxZoom:this.options.initialZoomLevel||this.options.locateOptions.maxZoom});t.Util.requestAnimFrame((function(){this._ignoreEvent=false}),this)}}},_drawCompass(){if(!this._event){return}const t=this._event.latlng;if(this.options.showCompass&&t&&this._compassHeading!==null){const e=this._isFollowing()?this.options.followCompassStyle:this.options.compassStyle;if(!this._compass){this._compass=new this.options.compassClass(t,this._compassHeading,e).addTo(this._layer)}else{this._compass.setLatLng(t);this._compass.setHeading(this._compassHeading);if(this._compass.setStyle){this._compass.setStyle(e)}}}if(this._compass&&(!this.options.showCompass||this._compassHeading===null)){this._compass.removeFrom(this._layer);this._compass=null}},_drawMarker(){if(this._event.accuracy===undefined){this._event.accuracy=0}const e=this._event.accuracy;const n=this._event.latlng;if(this.options.drawCircle){const i=this._isFollowing()?this.options.followCircleStyle:this.options.circleStyle;if(!this._circle){this._circle=t.circle(n,e,i).addTo(this._layer)}else{this._circle.setLatLng(n).setRadius(e).setStyle(i)}}let i;let r;if(this.options.metric){i=e.toFixed(0);r=this.options.strings.metersUnit}else{i=(e*3.2808399).toFixed(0);r=this.options.strings.feetUnit}if(this.options.drawMarker){const t=this._isFollowing()?this.options.followMarkerStyle:this.options.markerStyle;if(!this._marker){this._marker=new this.options.markerClass(n,t).addTo(this._layer)}else{this._marker.setLatLng(n);if(this._marker.setStyle){this._marker.setStyle(t)}}}this._drawCompass();const s=this.options.strings.popup;function o(){if(typeof s==="string"){return t.Util.template(s,{distance:i,unit:r})}else if(typeof s==="function"){return s({distance:i,unit:r})}else{return s}}if(this.options.showPopup&&s&&this._marker){this._marker.bindPopup(o())._popup.setLatLng(n)}if(this.options.showPopup&&s&&this._compass){this._compass.bindPopup(o())._popup.setLatLng(n)}},_removeMarker(){this._layer.clearLayers();this._marker=undefined;this._circle=undefined},_unload(){this.stop();if(this._map){this._map.off("unload",this._unload,this)}},_setCompassHeading(e){if(!isNaN(parseFloat(e))&&isFinite(e)){e=Math.round(e);this._compassHeading=e;t.Util.requestAnimFrame(this._drawCompass,this)}else{this._compassHeading=null}},_onCompassNeedsCalibration(){this._setCompassHeading()},_onDeviceOrientation(t){if(!this._active){return}if(t.webkitCompassHeading){this._setCompassHeading(t.webkitCompassHeading)}else if(t.absolute&&t.alpha){this._setCompassHeading(360-t.alpha)}},_onLocationError(t){if(t.code==3&&this.options.locateOptions.watch){return}this.stop();this.options.onLocationError(t,this)},_onLocationFound(t){if(this._event&&this._event.latlng.lat===t.latlng.lat&&this._event.latlng.lng===t.latlng.lng&&this._event.accuracy===t.accuracy){return}if(!this._active){return}this._event=t;this._drawMarker();this._updateContainerStyle();switch(this.options.setView){case"once":if(this._justClicked){this.setView()}break;case"untilPan":if(!this._userPanned){this.setView()}break;case"untilPanOrZoom":if(!this._userPanned&&!this._userZoomed){this.setView()}break;case"always":this.setView();break}this._justClicked=false},_onDrag(){if(this._event&&!this._ignoreEvent){this._userPanned=true;this._updateContainerStyle();this._drawMarker()}},_onZoom(){if(this._event&&!this._ignoreEvent){this._userZoomed=true;this._updateContainerStyle();this._drawMarker()}},_onZoomEnd(){if(this._event){this._drawCompass()}if(this._event&&!this._ignoreEvent){if(this._marker&&!this._map.getBounds().pad(-.3).contains(this._marker.getLatLng())){this._userPanned=true;this._updateContainerStyle();this._drawMarker()}}},_isFollowing(){if(!this._active){return false}if(this.options.setView==="always"){return true}else if(this.options.setView==="untilPan"){return!this._userPanned}else if(this.options.setView==="untilPanOrZoom"){return!this._userPanned&&!this._userZoomed}},_isOutsideMapBounds(){if(this._event===undefined){return false}return this._map.options.maxBounds&&!this._map.options.maxBounds.contains(this._event.latlng)},_updateContainerStyle(){if(!this._container){return}if(this._active&&!this._event){this._setClasses("requesting")}else if(this._isFollowing()){this._setClasses("following")}else if(this._active){this._setClasses("active")}else{this._cleanClasses()}},_setClasses(t){if(t=="requesting"){i(this._container,"active following");n(this._container,"requesting");i(this._icon,this.options.icon);n(this._icon,this.options.iconLoading)}else if(t=="active"){i(this._container,"requesting following");n(this._container,"active");i(this._icon,this.options.iconLoading);n(this._icon,this.options.icon)}else if(t=="following"){i(this._container,"requesting");n(this._container,"active following");i(this._icon,this.options.iconLoading);n(this._icon,this.options.icon)}},_cleanClasses(){t.DomUtil.removeClass(this._container,"requesting");t.DomUtil.removeClass(this._container,"active");t.DomUtil.removeClass(this._container,"following");i(this._icon,this.options.iconLoading);n(this._icon,this.options.icon)},_resetVariables(){this._active=false;this._justClicked=false;this._userPanned=false;this._userZoomed=false}});t.control.locate=e=>new t.Control.Locate(e);return o}),window)})(Zt);return Zt.exports}var Gt=Vt();var Wt=a(Gt);var Yt=t.Control.extend({options:{position:"bottomright"},_getLocale:function(t){return t.options.mapEl&&t.options.mapEl.locale?t.options.mapEl.locale:M.options.locale},onAdd:function(e){t.Control.CustomLocate=Wt.extend({start:function(){Wt.prototype.start.call(this);e.getContainer().focus()},stop:function(){Wt.prototype.stop.call(this);e.getContainer().focus()}});let n=this._getLocale(e);this.locateControl=new t.Control.CustomLocate({showPopup:false,strings:{title:n.btnLocTrackOff},position:this.options.position,locateOptions:{maxZoom:16}}).addTo(e);var i=this.locateControl._container;var r=this.locateControl;var s=new MutationObserver((function(t){if(i.classList.contains("active")&&i.classList.contains("following")){i.firstChild.title=n.btnLocTrackOn;r._marker.bindTooltip(n.btnMyLocTrackOn,{permanent:true})}else if(i.classList.contains("active")){i.firstChild.title=n.btnLocTrackLastKnown;r._marker.bindTooltip(n.btnMyLastKnownLocTrackOn)}else{i.firstChild.title=n.btnLocTrackOff}}));var o={attributes:true,attributeFilter:["class"]};s.observe(i,o);return i},stop:function(){return this.locateControl.stop()}});var Jt=function(t){return new Yt(t)};var Xt=t.Control.extend({options:{position:"topleft",title:{false:M.options.locale.btnFullScreen,true:M.options.locale.btnExitFullScreen}},_getLocale:function(t){return t.options.mapEl&&t.options.mapEl.locale?t.options.mapEl.locale:M.options.locale},onAdd:function(e){let n=this._getLocale(e);this.options.title={false:n.btnFullScreen,true:n.btnExitFullScreen};var i=t.DomUtil.create("div","leaflet-control-fullscreen leaflet-bar leaflet-control");this.link=t.DomUtil.create("a","leaflet-control-fullscreen-button leaflet-bar-part",i);this.link.href="#";this.link.setAttribute("role","button");this._map=e;this._map.on("fullscreenchange",this._toggleTitle,this);this._toggleTitle();t.DomEvent.on(this.link,"click",this._click,this);return i},onRemove:function(t){t.off("fullscreenchange",this._toggleTitle,this)},_click:function(e){t.DomEvent.stopPropagation(e);t.DomEvent.preventDefault(e);this._map.toggleFullscreen(this.options)},_toggleTitle:function(){this.link.title=this.options.title[this._map.isFullscreen()]}});t.Map.include({isFullscreen:function(){return this._isFullscreen||false},toggleFullscreen:function(t){var e=n.getClosest(this.getContainer(),"gcds-map");if(this.isFullscreen()){if(t&&t.pseudoFullscreen){this._disablePseudoFullscreen(e)}else if(document.exitFullscreen){document.exitFullscreen()}else if(document.mozCancelFullScreen){document.mozCancelFullScreen()}else if(document.webkitCancelFullScreen){document.webkitCancelFullScreen()}else if(document.msExitFullscreen){document.msExitFullscreen()}else{this._disablePseudoFullscreen(e)}}else{if(t&&t.pseudoFullscreen){this._enablePseudoFullscreen(e)}else if(e.requestFullscreen){e.requestFullscreen()}else if(e.mozRequestFullScreen){e.mozRequestFullScreen()}else if(e.webkitRequestFullscreen){e.webkitRequestFullscreen(Element.ALLOW_KEYBOARD_INPUT)}else if(e.msRequestFullscreen){e.msRequestFullscreen()}else{this._enablePseudoFullscreen(e)}}this.getContainer().focus()},_enablePseudoFullscreen:function(e){t.DomUtil.addClass(e,"leaflet-pseudo-fullscreen");this._setFullscreen(true);this.fire("fullscreenchange")},_disablePseudoFullscreen:function(e){t.DomUtil.removeClass(e,"leaflet-pseudo-fullscreen");this._setFullscreen(false);this.fire("fullscreenchange")},_setFullscreen:function(e){this._isFullscreen=e;var i=n.getClosest(this.getContainer(),"gcds-map");if(e){t.DomUtil.addClass(i,"mapml-fullscreen-on")}else{t.DomUtil.removeClass(i,"mapml-fullscreen-on")}this.invalidateSize()},_onFullscreenChange:function(t){var e=n.getClosest(this.getContainer(),":fullscreen"),i=n.getClosest(this.getContainer(),"gcds-map");if(e===i&&!this._isFullscreen){this._setFullscreen(true);this.fire("fullscreenchange")}else if(e!==i&&this._isFullscreen){this._setFullscreen(false);this.fire("fullscreenchange")}}});t.Map.mergeOptions({fullscreenControl:false});t.Map.addInitHook((function(){if(this.options.fullscreenControl){this.fullscreenControl=new Xt(this.options.fullscreenControl);this.addControl(this.fullscreenControl)}var e;if("onfullscreenchange"in document){e="fullscreenchange"}else if("onmozfullscreenchange"in document){e="mozfullscreenchange"}else if("onwebkitfullscreenchange"in document){e="webkitfullscreenchange"}else if("onmsfullscreenchange"in document){e="MSFullscreenChange"}if(e){var n=t.Util.bind(this._onFullscreenChange,this);this.whenReady((function(){t.DomEvent.on(document,e,n)}));this.on("unload",(function(){t.DomEvent.off(document,e,n)}))}}));var Kt=function(t){return new Xt(t)};var Qt=t.Layer.extend({onAdd:function(e){let n=e.getSize();if(n.x>400||n.y>300){this._container=t.DomUtil.create("table","mapml-debug",e._container);this._panel=ne({className:"mapml-debug-panel",pane:this._container});e.addLayer(this._panel)}this._grid=re({className:"mapml-debug-grid",pane:e._panes.mapPane,zIndex:400,tileSize:e.options.crs.options.crs.tile.bounds.max.x});e.addLayer(this._grid);this._vectors=oe({className:"mapml-debug-vectors",pane:e._panes.mapPane,toolPane:this._container});e.addLayer(this._vectors)},onRemove:function(e){e.removeLayer(this._grid);e.removeLayer(this._vectors);if(this._panel){e.removeLayer(this._panel);t.DomUtil.remove(this._container)}}});var te=function(){return new Qt};var ee=t.Layer.extend({initialize:function(e){t.setOptions(this,e)},onAdd:function(e){this._title=t.DomUtil.create("caption","mapml-debug-banner",this.options.pane);this._title.innerHTML="Debug mode";e.debug={};e.debug._infoContainer=this._debugContainer=t.DomUtil.create("tbody","mapml-debug-panel",this.options.pane);let n=e.debug._infoContainer;e.debug._tileCoord=t.DomUtil.create("tr","mapml-debug-coordinates",n);e.debug._tileMatrixCoord=t.DomUtil.create("tr","mapml-debug-coordinates",n);e.debug._mapCoord=t.DomUtil.create("tr","mapml-debug-coordinates",n);e.debug._tcrsCoord=t.DomUtil.create("tr","mapml-debug-coordinates",n);e.debug._pcrsCoord=t.DomUtil.create("tr","mapml-debug-coordinates",n);e.debug._gcrsCoord=t.DomUtil.create("tr","mapml-debug-coordinates",n);this._map.on("mousemove",this._updateCoords)},onRemove:function(){t.DomUtil.remove(this._title);if(this._debugContainer){t.DomUtil.remove(this._debugContainer);this._map.off("mousemove",this._updateCoords)}},_updateCoords:function(t){if(this.contextMenu._visible)return;let e=this.options.mapEl,n=e._map.project(t.latlng),i=e._map.options.crs.scale(+e.zoom),r=e._map.options.crs.transformation.untransform(n,i),s=e._map.options.crs.options.crs.tile.bounds.max.x,o=n.x%s,l=n.y%s;if(o<0)o+=s;if(l<0)l+=s;this.debug._tileCoord.innerHTML=`\n      <th scope="row">tile: </th>\n      <td>i: ${Math.trunc(o)}, </td>\n      <td>j: ${Math.trunc(l)}</td>\n      `;this.debug._mapCoord.innerHTML=`\n      <th scope="row">map: </th>\n      <td>i: ${Math.trunc(t.containerPoint.x)}, </td>\n      <td>j: ${Math.trunc(t.containerPoint.y)}</td>\n      `;this.debug._gcrsCoord.innerHTML=`\n      <th scope="row">gcrs: </th>\n      <td>lon: ${t.latlng.lng.toFixed(6)}, </td>\n      <td>lat: ${t.latlng.lat.toFixed(6)}</td>\n      `;this.debug._tcrsCoord.innerHTML=`\n      <th scope="row">tcrs: </th>\n      <td>x: ${Math.trunc(n.x)}, </td>\n      <td>y: ${Math.trunc(n.y)}</td>\n      `;this.debug._tileMatrixCoord.innerHTML=`\n      <th scope="row">tilematrix: </th>\n      <td>column: ${Math.trunc(n.x/s)}, </td>\n      <td>row: ${Math.trunc(n.y/s)}</td>\n      `;this.debug._pcrsCoord.innerHTML=`\n      <th scope="row">pcrs: </th>\n      <td>easting: ${r.x.toFixed(2)}, </td>\n      <td>northing: ${r.y.toFixed(2)}</td>\n      `}});var ne=function(t){return new ee(t)};var ie=t.GridLayer.extend({initialize:function(e){t.setOptions(this,e);t.GridLayer.prototype.initialize.call(this,this._map)},createTile:function(e){let n=t.DomUtil.create("div","mapml-debug-tile");n.setAttribute("col",e.x);n.setAttribute("row",e.y);n.setAttribute("zoom",e.z);n.innerHTML=[`col: ${e.x}`,`row: ${e.y}`,`zoom: ${e.z}`].join(", ");n.style.outline="1px dashed red";return n}});var re=function(t){return new ie(t)};var se=t.LayerGroup.extend({initialize:function(e){t.setOptions(this,e);t.LayerGroup.prototype.initialize.call(this,this._map,e)},onAdd:function(e){e.on("overlayremove",this._mapLayerUpdate,this);e.on("overlayadd",this._mapLayerUpdate,this);let n=e.options.crs.transformation.transform(t.point(0,0),e.options.crs.scale(0));this._centerVector=t.circle(e.options.crs.pointToLatLng(n,0),{radius:250,className:"mapml-debug-vectors projection-centre"});this._centerVector.bindTooltip("Projection Center");this._addBounds(e)},onRemove:function(t){this.clearLayers()},_addBounds:function(e){setTimeout((()=>{let n=Object.keys(e._layers),i=e._layers,r=["#FF5733","#8DFF33","#3397FF","#E433FF","#F3FF33"],s=0;this.addLayer(this._centerVector);for(let e of n){if(i[e].layerBounds||i[e].extentBounds){let n;if(i[e].layerBounds){n=[i[e].layerBounds.min,t.point(i[e].layerBounds.max.x,i[e].layerBounds.min.y),i[e].layerBounds.max,t.point(i[e].layerBounds.min.x,i[e].layerBounds.max.y)]}else{n=[i[e].extentBounds.min,t.point(i[e].extentBounds.max.x,i[e].extentBounds.min.y),i[e].extentBounds.max,t.point(i[e].extentBounds.min.x,i[e].extentBounds.max.y)]}let o=i[e].extentBounds&&i[e].options.linkEl.getLayerEl().hasAttribute("data-testid")?i[e].options.linkEl.getLayerEl().getAttribute("data-testid"):i[e].layerBounds&&i[e].options?._leafletLayer?._layerEl?.hasAttribute("data-testid")?i[e].options._leafletLayer._layerEl.getAttribute("data-testid"):"";let l=ae(n,{className:this.options.className.concat(" ",o),color:r[s%r.length],weight:2,opacity:1,fillOpacity:.01,fill:true});if(i[e].options._leafletLayer)l.bindTooltip(i[e].options._leafletLayer._title,{sticky:true});this.addLayer(l);s++}}if(e.totalLayerBounds){let n=[e.totalLayerBounds.min,t.point(e.totalLayerBounds.max.x,e.totalLayerBounds.min.y),e.totalLayerBounds.max,t.point(e.totalLayerBounds.min.x,e.totalLayerBounds.max.y)];let i=ae(n,{className:"mapml-debug-vectors mapml-total-bounds",color:"#808080",weight:5,opacity:.5,fill:false});this.addLayer(i)}}),0)},_mapLayerUpdate:function(t){this.clearLayers();this._addBounds(t.target)}});var oe=function(t){return new se(t)};var le=t.Path.extend({getCenter:function(e){let n=this._map.options.crs;return n.unproject(t.bounds(this._locations).getCenter())},options:{className:"mapml-debug-extent"},initialize:function(e,n){this._locations=e;t.setOptions(this,n)},_project:function(){this._rings=[];let e=this._map.options.crs.scale(this._map.getZoom()),n=this._map;for(let i=0;i<this._locations.length;i++){let r=n.options.crs.transformation.transform(this._locations[i],e);this._rings.push(t.point(r.x,r.y)._subtract(n.getPixelOrigin()))}this._parts=[this._rings]},_update:function(){if(!this._map)return;this._renderer._updatePoly(this,true)}});var ae=function(t,e){return new le(t,e)};var he=t.Layer.extend({onAdd:function(e){let n=`<svg xmlns="http://www.w3.org/2000/svg" xml:space="preserve" viewBox="0 0 100 100"><g stroke="#fff" stroke-linecap="round" stroke-linejoin="round"><circle cx="50.028" cy="50.219" r="3.923" stroke-width="2" color="currentColor" overflow="visible"/><path stroke-width="3" d="M4.973 54.424h31.768a4.204 4.204 0 1 0 0-8.409H4.973A4.203 4.203 0 0 0 .77 50.22a4.203 4.203 0 0 0 4.204 4.205z" color="currentColor" overflow="visible"/><path stroke-width="3" d="M54.232 5.165a4.204 4.204 0 1 0-8.408 0v31.767a4.204 4.204 0 1 0 8.408 0V5.165z"/><path stroke-width="3" d="M99.288 50.22a4.204 4.204 0 0 0-4.204-4.205H63.317a4.204 4.204 0 1 0 0 8.409h31.767a4.205 4.205 0 0 0 4.204-4.205zM45.823 95.274a4.204 4.204 0 1 0 8.409 0V63.506a4.204 4.204 0 1 0-8.409 0v31.768z" color="currentColor" overflow="visible"/></g></svg>`;this._container=t.DomUtil.create("div","mapml-crosshair",e._container);this._container.innerHTML=n;e.isFocused=false;this._isQueryable=false;e.on("layerchange layeradd layerremove overlayremove",this._toggleEvents,this);e.on("popupopen",this._isMapFocused,this);t.DomEvent.on(e._container,"keydown keyup mousedown",this._isMapFocused,this);this._addOrRemoveCrosshair()},onRemove:function(e){e.off("layerchange layeradd layerremove overlayremove",this._toggleEvents);e.off("popupopen",this._isMapFocused);t.DomEvent.off(e._container,"keydown keyup mousedown",this._isMapFocused)},_toggleEvents:function(){if(this._hasQueryableLayer()){this._map.on("viewreset move moveend",this._addOrRemoveCrosshair,this)}else{this._map.off("viewreset move moveend",this._addOrRemoveCrosshair,this)}this._addOrRemoveCrosshair()},_addOrRemoveCrosshair:function(t){if(this._hasQueryableLayer()){this._container.removeAttribute("hidden")}else{this._container.setAttribute("hidden","")}},_addOrRemoveMapOutline:function(e){let n=this._map._container;if(this._map.isFocused&&!this._outline){this._outline=t.DomUtil.create("div","mapml-outline",n)}else if(!this._map.isFocused&&this._outline){t.DomUtil.remove(this._outline);delete this._outline}},_hasQueryableLayer:function(){let t=this._map.options.mapEl.layers;if(this._map.isFocused){for(let e of t){if(e.queryable&&e.queryable()){return true}}}return false},_isMapFocused:function(t){if(!this._map._container.parentNode.activeElement){this._map.isFocused=false;return}let e=this._map._container.parentNode.activeElement.classList.contains("leaflet-container");if(e&&["keydown"].includes(t.type)&&t.shiftKey&&t.keyCode===9){this._map.isFocused=false}else this._map.isFocused=e&&["keyup","keydown"].includes(t.type);if(this._map.isFocused)this._map.fire("mapkeyboardfocused");this._addOrRemoveMapOutline();this._addOrRemoveCrosshair()}});var ce=function(t){return new he(t)};var fe=t.Layer.extend({onAdd:function(e){let n=`<svg xmlns="http://www.w3.org/2000/svg" xml:space="preserve" viewBox="0 0 100 100"><path fill="none" stroke="#000" stroke-linecap="round" stroke-linejoin="round" stroke-width="3" d="M0 0h100v100H0z" color="#000" overflow="visible"/></svg>`;this._container=t.DomUtil.create("div","mapml-feature-index-box",e._container);this._container.innerHTML=n;this._output=t.DomUtil.create("output","mapml-feature-index",e._container);this._output.setAttribute("role","status");this._output.setAttribute("aria-live","polite");this._output.setAttribute("aria-atomic","true");this._body=t.DomUtil.create("span","mapml-feature-index-content",this._output);this._body.index=0;this._output.initialFocus=false;e.on("focus blur popupclose",this._addOrRemoveFeatureIndex,this);e.on("moveend focus templatedfeatureslayeradd",this._checkOverlap,this);e.on("keydown",this._onKeyDown,this);this._addOrRemoveFeatureIndex()},_calculateReticleBounds:function(){let e=this._map.getPixelBounds();let i=e.getCenter();let r=Math.abs(e.min.x-e.max.x)/this._map.options.mapEl.width;let s=Math.abs(e.min.y-e.max.y)/this._map.options.mapEl.height;let o=getComputedStyle(this._container).width.replace(/[^\d.]/g,"");if(getComputedStyle(this._container).width.slice(-1)==="%"){o=o*this._map.options.mapEl.width/100}let l=r*o/2;let a=s*o/2;let h=t.point(i.x-l,i.y+a);let c=t.point(i.x+l,i.y-a);let f=t.bounds(h,c);return n.pixelToPCRSBounds(f,this._map.getZoom(),this._map.options.projection)},_checkOverlap:function(e){if(e.type==="focus")this._output.initialFocus=true;if(!this._output.initialFocus)return;if(this._output.popupClosed){this._output.popupClosed=false;return}this._map.fire("mapkeyboardfocused");let n=this._calculateReticleBounds();let i=this._map.featureIndex.inBoundFeatures;let r=1;let s=Object.keys(i);let o=this._body;let l=document.createElement("span");l.innerHTML=this._map.options.mapEl.locale.fIndexNoFeatures;o.innerHTML="";o.index=0;o.allFeatures=[];s.forEach((e=>{let s=i[e].layer;let l=i[e].layer._layers;let a=t.bounds();if(l){let e=Object.keys(l);e.forEach((e=>{if(!a)a=t.bounds(s._layers[e]._bounds.min,s._layers[e]._bounds.max);a.extend(s._layers[e]._bounds.min);a.extend(s._layers[e]._bounds.max)}))}else if(s._bounds){a=t.bounds(s._bounds.min,s._bounds.max)}if(n.overlaps(a)){let t=i[e].path.getAttribute("aria-label");if(r<8){o.appendChild(this._updateOutput(t,r,r))}if(r%7===0||r===1){o.allFeatures.push([])}o.allFeatures[Math.floor((r-1)/7)].push({label:t,index:r,layer:s});if(o.allFeatures[1]&&o.allFeatures[1].length===1){o.appendChild(this._updateOutput("More results",0,9))}r+=1}}));this._addToggleKeys();if(r===1){o.appendChild(l)}},_updateOutput:function(t,e,n){let i=document.createElement("span");i.setAttribute("data-index",e);i.innerHTML=`<kbd>${n}</kbd>`+" "+t+"<span>, </span>";return i},_addToggleKeys:function(){let t=this._body.allFeatures;for(let e=0;e<t.length;e++){if(t[e].length===0)return;if(t[e-1]){let n="Previous results";t[e].push({label:n})}if(t[e+1]&&t[e+1].length>0){let n="More results";t[e].push({label:n})}}},_onKeyDown:function(t){let e=this._body;let n=t.originalEvent.keyCode;if(n>=49&&n<=55){if(!e.allFeatures[e.index])return;let t=e.allFeatures[e.index][n-49];if(!t)return;let i=t.layer;if(i){this._map.featureIndex.currentIndex=t.index-1;if(i._popup){this._map.closePopup();i.openPopup()}else i.options.group.focus()}}else if(n===56){this._newContent(e,-1)}else if(n===57){this._newContent(e,1)}},_newContent:function(t,e){let n=t.firstChild.getAttribute("data-index");let i=t.allFeatures[Math.floor((n-1)/7+e)];if(i&&i.length>0){t.innerHTML="";t.index+=e;for(let e=0;e<i.length;e++){let n=i[e];let r=n.index?n.index:0;let s=e+1;if(n.label==="More results")s=9;if(n.label==="Previous results")s=8;t.appendChild(this._updateOutput(n.label,r,s))}}},_addOrRemoveFeatureIndex:function(t){if(!this._output.initialFocus){this._output.setAttribute("aria-hidden","true")}else if(this._output.hasAttribute("aria-hidden")){let t=this;setTimeout((function(){t._output.removeAttribute("aria-hidden")}),100)}if(t&&t.type==="popupclose"){this._output.setAttribute("aria-hidden","true");this._output.popupClosed=true}else if(t&&t.type==="focus"){this._container.removeAttribute("hidden");this._output.classList.remove("mapml-screen-reader-output")}else if(t&&t.target._popup){this._container.setAttribute("hidden","")}else if(t&&t.type==="blur"){this._container.setAttribute("hidden","");this._output.classList.add("mapml-screen-reader-output");this._output.initialFocus=false;this._addOrRemoveFeatureIndex()}else{this._container.setAttribute("hidden","");this._output.classList.add("mapml-screen-reader-output")}}});var ue=function(t){return new fe(t)};const de="/*\n * GCDS Map Component CSS\n * \n * This file composes the complete map styling by importing:\n * 1. Leaflet core CSS (essential for map layout)\n * 2. Leaflet.locatecontrol CSS (geolocation control)\n * 3. Original MapML CSS (MapML-specific features)\n * 4. GCDS-specific overrides (design system integration)\n * \n * This mirrors the original mapml.js Gruntfile.js CSS composition.\n */\n\n/* Import Leaflet core CSS - ESSENTIAL for proper map display */\n/* required styles */\r\n\r\n.leaflet-pane,\r\n.leaflet-tile,\r\n.leaflet-marker-icon,\r\n.leaflet-marker-shadow,\r\n.leaflet-tile-container,\r\n.leaflet-pane > svg,\r\n.leaflet-pane > canvas,\r\n.leaflet-zoom-box,\r\n.leaflet-image-layer,\r\n.leaflet-layer {\r\n\tposition: absolute;\r\n\tleft: 0;\r\n\ttop: 0;\r\n\t}\r\n.leaflet-container {\r\n\toverflow: hidden;\r\n\t}\r\n.leaflet-tile,\r\n.leaflet-marker-icon,\r\n.leaflet-marker-shadow {\r\n\t-webkit-user-select: none;\r\n\t   -moz-user-select: none;\r\n\t        user-select: none;\r\n\t  -webkit-user-drag: none;\r\n\t}\r\n/* Prevents IE11 from highlighting tiles in blue */\r\n.leaflet-tile::selection {\r\n\tbackground: transparent;\r\n}\r\n/* Safari renders non-retina tile on retina better with this, but Chrome is worse */\r\n.leaflet-safari .leaflet-tile {\r\n\timage-rendering: -webkit-optimize-contrast;\r\n\t}\r\n/* hack that prevents hw layers \"stretching\" when loading new tiles */\r\n.leaflet-safari .leaflet-tile-container {\r\n\twidth: 1600px;\r\n\theight: 1600px;\r\n\t-webkit-transform-origin: 0 0;\r\n\t}\r\n.leaflet-marker-icon,\r\n.leaflet-marker-shadow {\r\n\tdisplay: block;\r\n\t}\r\n/* .leaflet-container svg: reset svg max-width decleration shipped in Joomla! (joomla.org) 3.x */\r\n/* .leaflet-container img: map is broken in FF if you have max-width: 100% on tiles */\r\n.leaflet-container .leaflet-overlay-pane svg {\r\n\tmax-width: none !important;\r\n\tmax-height: none !important;\r\n\t}\r\n.leaflet-container .leaflet-marker-pane img,\r\n.leaflet-container .leaflet-shadow-pane img,\r\n.leaflet-container .leaflet-tile-pane img,\r\n.leaflet-container img.leaflet-image-layer,\r\n.leaflet-container .leaflet-tile {\r\n\tmax-width: none !important;\r\n\tmax-height: none !important;\r\n\twidth: auto;\r\n\tpadding: 0;\r\n\t}\r\n\r\n.leaflet-container img.leaflet-tile {\r\n\t/* See: https://bugs.chromium.org/p/chromium/issues/detail?id=600120 */\r\n\tmix-blend-mode: plus-lighter;\r\n}\r\n\r\n.leaflet-container.leaflet-touch-zoom {\r\n\t-ms-touch-action: pan-x pan-y;\r\n\ttouch-action: pan-x pan-y;\r\n\t}\r\n.leaflet-container.leaflet-touch-drag {\r\n\t-ms-touch-action: pinch-zoom;\r\n\t/* Fallback for FF which doesn't support pinch-zoom */\r\n\ttouch-action: none;\r\n\ttouch-action: pinch-zoom;\r\n}\r\n.leaflet-container.leaflet-touch-drag.leaflet-touch-zoom {\r\n\t-ms-touch-action: none;\r\n\ttouch-action: none;\r\n}\r\n.leaflet-container {\r\n\t-webkit-tap-highlight-color: transparent;\r\n}\r\n.leaflet-container a {\r\n\t-webkit-tap-highlight-color: rgba(51, 181, 229, 0.4);\r\n}\r\n.leaflet-tile {\r\n\tfilter: inherit;\r\n\tvisibility: hidden;\r\n\t}\r\n.leaflet-tile-loaded {\r\n\tvisibility: inherit;\r\n\t}\r\n.leaflet-zoom-box {\r\n\twidth: 0;\r\n\theight: 0;\r\n\t-moz-box-sizing: border-box;\r\n\t     box-sizing: border-box;\r\n\tz-index: 800;\r\n\t}\r\n/* workaround for https://bugzilla.mozilla.org/show_bug.cgi?id=888319 */\r\n.leaflet-overlay-pane svg {\r\n\t-moz-user-select: none;\r\n\t}\r\n\r\n.leaflet-pane         { z-index: 400; }\r\n\r\n.leaflet-tile-pane    { z-index: 200; }\r\n.leaflet-overlay-pane { z-index: 400; }\r\n.leaflet-shadow-pane  { z-index: 500; }\r\n.leaflet-marker-pane  { z-index: 600; }\r\n.leaflet-tooltip-pane   { z-index: 650; }\r\n.leaflet-popup-pane   { z-index: 700; }\r\n\r\n.leaflet-map-pane canvas { z-index: 100; }\r\n.leaflet-map-pane svg    { z-index: 200; }\r\n\r\n.leaflet-vml-shape {\r\n\twidth: 1px;\r\n\theight: 1px;\r\n\t}\r\n.lvml {\r\n\tbehavior: url(#default#VML);\r\n\tdisplay: inline-block;\r\n\tposition: absolute;\r\n\t}\r\n\r\n\r\n/* control positioning */\r\n\r\n.leaflet-control {\r\n\tposition: relative;\r\n\tz-index: 800;\r\n\tpointer-events: visiblePainted; /* IE 9-10 doesn't have auto */\r\n\tpointer-events: auto;\r\n\t}\r\n.leaflet-top,\r\n.leaflet-bottom {\r\n\tposition: absolute;\r\n\tz-index: 1000;\r\n\tpointer-events: none;\r\n\t}\r\n.leaflet-top {\r\n\ttop: 0;\r\n\t}\r\n.leaflet-right {\r\n\tright: 0;\r\n\t}\r\n.leaflet-bottom {\r\n\tbottom: 0;\r\n\t}\r\n.leaflet-left {\r\n\tleft: 0;\r\n\t}\r\n.leaflet-control {\r\n\tfloat: left;\r\n\tclear: both;\r\n\t}\r\n.leaflet-right .leaflet-control {\r\n\tfloat: right;\r\n\t}\r\n.leaflet-top .leaflet-control {\r\n\tmargin-top: 10px;\r\n\t}\r\n.leaflet-bottom .leaflet-control {\r\n\tmargin-bottom: 10px;\r\n\t}\r\n.leaflet-left .leaflet-control {\r\n\tmargin-left: 10px;\r\n\t}\r\n.leaflet-right .leaflet-control {\r\n\tmargin-right: 10px;\r\n\t}\r\n\r\n\r\n/* zoom and fade animations */\r\n\r\n.leaflet-fade-anim .leaflet-popup {\r\n\topacity: 0;\r\n\t-webkit-transition: opacity 0.2s linear;\r\n\t   -moz-transition: opacity 0.2s linear;\r\n\t        transition: opacity 0.2s linear;\r\n\t}\r\n.leaflet-fade-anim .leaflet-map-pane .leaflet-popup {\r\n\topacity: 1;\r\n\t}\r\n.leaflet-zoom-animated {\r\n\t-webkit-transform-origin: 0 0;\r\n\t    -ms-transform-origin: 0 0;\r\n\t        transform-origin: 0 0;\r\n\t}\r\nsvg.leaflet-zoom-animated {\r\n\twill-change: transform;\r\n}\r\n\r\n.leaflet-zoom-anim .leaflet-zoom-animated {\r\n\t-webkit-transition: -webkit-transform 0.25s cubic-bezier(0,0,0.25,1);\r\n\t   -moz-transition:    -moz-transform 0.25s cubic-bezier(0,0,0.25,1);\r\n\t        transition:         transform 0.25s cubic-bezier(0,0,0.25,1);\r\n\t}\r\n.leaflet-zoom-anim .leaflet-tile,\r\n.leaflet-pan-anim .leaflet-tile {\r\n\t-webkit-transition: none;\r\n\t   -moz-transition: none;\r\n\t        transition: none;\r\n\t}\r\n\r\n.leaflet-zoom-anim .leaflet-zoom-hide {\r\n\tvisibility: hidden;\r\n\t}\r\n\r\n\r\n/* cursors */\r\n\r\n.leaflet-interactive {\r\n\tcursor: pointer;\r\n\t}\r\n.leaflet-grab {\r\n\tcursor: -webkit-grab;\r\n\tcursor:    -moz-grab;\r\n\tcursor:         grab;\r\n\t}\r\n.leaflet-crosshair,\r\n.leaflet-crosshair .leaflet-interactive {\r\n\tcursor: crosshair;\r\n\t}\r\n.leaflet-popup-pane,\r\n.leaflet-control {\r\n\tcursor: auto;\r\n\t}\r\n.leaflet-dragging .leaflet-grab,\r\n.leaflet-dragging .leaflet-grab .leaflet-interactive,\r\n.leaflet-dragging .leaflet-marker-draggable {\r\n\tcursor: move;\r\n\tcursor: -webkit-grabbing;\r\n\tcursor:    -moz-grabbing;\r\n\tcursor:         grabbing;\r\n\t}\r\n\r\n/* marker & overlays interactivity */\r\n.leaflet-marker-icon,\r\n.leaflet-marker-shadow,\r\n.leaflet-image-layer,\r\n.leaflet-pane > svg path,\r\n.leaflet-tile-container {\r\n\tpointer-events: none;\r\n\t}\r\n\r\n.leaflet-marker-icon.leaflet-interactive,\r\n.leaflet-image-layer.leaflet-interactive,\r\n.leaflet-pane > svg path.leaflet-interactive,\r\nsvg.leaflet-image-layer.leaflet-interactive path {\r\n\tpointer-events: visiblePainted; /* IE 9-10 doesn't have auto */\r\n\tpointer-events: auto;\r\n\t}\r\n\r\n/* visual tweaks */\r\n\r\n.leaflet-container {\r\n\tbackground: #ddd;\r\n\toutline-offset: 1px;\r\n\t}\r\n.leaflet-container a {\r\n\tcolor: #0078A8;\r\n\t}\r\n.leaflet-zoom-box {\r\n\tborder: 2px dotted #38f;\r\n\tbackground: rgba(255,255,255,0.5);\r\n\t}\r\n\r\n\r\n/* general typography */\r\n.leaflet-container {\r\n\tfont-family: \"Helvetica Neue\", Arial, Helvetica, sans-serif;\r\n\tfont-size: 12px;\r\n\tfont-size: 0.75rem;\r\n\tline-height: 1.5;\r\n\t}\r\n\r\n\r\n/* general toolbar styles */\r\n\r\n.leaflet-bar {\r\n\tbox-shadow: 0 1px 5px rgba(0,0,0,0.65);\r\n\tborder-radius: 4px;\r\n\t}\r\n.leaflet-bar a {\r\n\tbackground-color: #fff;\r\n\tborder-bottom: 1px solid #ccc;\r\n\twidth: 26px;\r\n\theight: 26px;\r\n\tline-height: 26px;\r\n\tdisplay: block;\r\n\ttext-align: center;\r\n\ttext-decoration: none;\r\n\tcolor: black;\r\n\t}\r\n.leaflet-bar a,\r\n.leaflet-control-layers-toggle {\r\n\tbackground-position: 50% 50%;\r\n\tbackground-repeat: no-repeat;\r\n\tdisplay: block;\r\n\t}\r\n.leaflet-bar a:hover,\r\n.leaflet-bar a:focus {\r\n\tbackground-color: #f4f4f4;\r\n\t}\r\n.leaflet-bar a:first-child {\r\n\tborder-top-left-radius: 4px;\r\n\tborder-top-right-radius: 4px;\r\n\t}\r\n.leaflet-bar a:last-child {\r\n\tborder-bottom-left-radius: 4px;\r\n\tborder-bottom-right-radius: 4px;\r\n\tborder-bottom: none;\r\n\t}\r\n.leaflet-bar a.leaflet-disabled {\r\n\tcursor: default;\r\n\tbackground-color: #f4f4f4;\r\n\tcolor: #bbb;\r\n\t}\r\n\r\n.leaflet-touch .leaflet-bar a {\r\n\twidth: 30px;\r\n\theight: 30px;\r\n\tline-height: 30px;\r\n\t}\r\n.leaflet-touch .leaflet-bar a:first-child {\r\n\tborder-top-left-radius: 2px;\r\n\tborder-top-right-radius: 2px;\r\n\t}\r\n.leaflet-touch .leaflet-bar a:last-child {\r\n\tborder-bottom-left-radius: 2px;\r\n\tborder-bottom-right-radius: 2px;\r\n\t}\r\n\r\n/* zoom control */\r\n\r\n.leaflet-control-zoom-in,\r\n.leaflet-control-zoom-out {\r\n\tfont: bold 18px 'Lucida Console', Monaco, monospace;\r\n\ttext-indent: 1px;\r\n\t}\r\n\r\n.leaflet-touch .leaflet-control-zoom-in, .leaflet-touch .leaflet-control-zoom-out  {\r\n\tfont-size: 22px;\r\n\t}\r\n\r\n\r\n/* layers control */\r\n\r\n.leaflet-control-layers {\r\n\tbox-shadow: 0 1px 5px rgba(0,0,0,0.4);\r\n\tbackground: #fff;\r\n\tborder-radius: 5px;\r\n\t}\r\n.leaflet-control-layers-toggle {\r\n\tbackground-image: url(images/layers.png);\r\n\twidth: 36px;\r\n\theight: 36px;\r\n\t}\r\n.leaflet-retina .leaflet-control-layers-toggle {\r\n\tbackground-image: url(images/layers-2x.png);\r\n\tbackground-size: 26px 26px;\r\n\t}\r\n.leaflet-touch .leaflet-control-layers-toggle {\r\n\twidth: 44px;\r\n\theight: 44px;\r\n\t}\r\n.leaflet-control-layers .leaflet-control-layers-list,\r\n.leaflet-control-layers-expanded .leaflet-control-layers-toggle {\r\n\tdisplay: none;\r\n\t}\r\n.leaflet-control-layers-expanded .leaflet-control-layers-list {\r\n\tdisplay: block;\r\n\tposition: relative;\r\n\t}\r\n.leaflet-control-layers-expanded {\r\n\tpadding: 6px 10px 6px 6px;\r\n\tcolor: #333;\r\n\tbackground: #fff;\r\n\t}\r\n.leaflet-control-layers-scrollbar {\r\n\toverflow-y: scroll;\r\n\toverflow-x: hidden;\r\n\tpadding-right: 5px;\r\n\t}\r\n.leaflet-control-layers-selector {\r\n\tmargin-top: 2px;\r\n\tposition: relative;\r\n\ttop: 1px;\r\n\t}\r\n.leaflet-control-layers label {\r\n\tdisplay: block;\r\n\tfont-size: 13px;\r\n\tfont-size: 1.08333em;\r\n\t}\r\n.leaflet-control-layers-separator {\r\n\theight: 0;\r\n\tborder-top: 1px solid #ddd;\r\n\tmargin: 5px -10px 5px -6px;\r\n\t}\r\n\r\n/* Default icon URLs */\r\n.leaflet-default-icon-path { /* used only in path-guessing heuristic, see L.Icon.Default */\r\n\tbackground-image: url(images/marker-icon.png);\r\n\t}\r\n\r\n\r\n/* attribution and scale controls */\r\n\r\n.leaflet-container .leaflet-control-attribution {\r\n\tbackground: #fff;\r\n\tbackground: rgba(255, 255, 255, 0.8);\r\n\tmargin: 0;\r\n\t}\r\n.leaflet-control-attribution,\r\n.leaflet-control-scale-line {\r\n\tpadding: 0 5px;\r\n\tcolor: #333;\r\n\tline-height: 1.4;\r\n\t}\r\n.leaflet-control-attribution a {\r\n\ttext-decoration: none;\r\n\t}\r\n.leaflet-control-attribution a:hover,\r\n.leaflet-control-attribution a:focus {\r\n\ttext-decoration: underline;\r\n\t}\r\n.leaflet-attribution-flag {\r\n\tdisplay: inline !important;\r\n\tvertical-align: baseline !important;\r\n\twidth: 1em;\r\n\theight: 0.6669em;\r\n\t}\r\n.leaflet-left .leaflet-control-scale {\r\n\tmargin-left: 5px;\r\n\t}\r\n.leaflet-bottom .leaflet-control-scale {\r\n\tmargin-bottom: 5px;\r\n\t}\r\n.leaflet-control-scale-line {\r\n\tborder: 2px solid #777;\r\n\tborder-top: none;\r\n\tline-height: 1.1;\r\n\tpadding: 2px 5px 1px;\r\n\twhite-space: nowrap;\r\n\t-moz-box-sizing: border-box;\r\n\t     box-sizing: border-box;\r\n\tbackground: rgba(255, 255, 255, 0.8);\r\n\ttext-shadow: 1px 1px #fff;\r\n\t}\r\n.leaflet-control-scale-line:not(:first-child) {\r\n\tborder-top: 2px solid #777;\r\n\tborder-bottom: none;\r\n\tmargin-top: -2px;\r\n\t}\r\n.leaflet-control-scale-line:not(:first-child):not(:last-child) {\r\n\tborder-bottom: 2px solid #777;\r\n\t}\r\n\r\n.leaflet-touch .leaflet-control-attribution,\r\n.leaflet-touch .leaflet-control-layers,\r\n.leaflet-touch .leaflet-bar {\r\n\tbox-shadow: none;\r\n\t}\r\n.leaflet-touch .leaflet-control-layers,\r\n.leaflet-touch .leaflet-bar {\r\n\tborder: 2px solid rgba(0,0,0,0.2);\r\n\tbackground-clip: padding-box;\r\n\t}\r\n\r\n\r\n/* popup */\r\n\r\n.leaflet-popup {\r\n\tposition: absolute;\r\n\ttext-align: center;\r\n\tmargin-bottom: 20px;\r\n\t}\r\n.leaflet-popup-content-wrapper {\r\n\tpadding: 1px;\r\n\ttext-align: left;\r\n\tborder-radius: 12px;\r\n\t}\r\n.leaflet-popup-content {\r\n\tmargin: 13px 24px 13px 20px;\r\n\tline-height: 1.3;\r\n\tfont-size: 13px;\r\n\tfont-size: 1.08333em;\r\n\tmin-height: 1px;\r\n\t}\r\n.leaflet-popup-content p {\r\n\tmargin: 17px 0;\r\n\tmargin: 1.3em 0;\r\n\t}\r\n.leaflet-popup-tip-container {\r\n\twidth: 40px;\r\n\theight: 20px;\r\n\tposition: absolute;\r\n\tleft: 50%;\r\n\tmargin-top: -1px;\r\n\tmargin-left: -20px;\r\n\toverflow: hidden;\r\n\tpointer-events: none;\r\n\t}\r\n.leaflet-popup-tip {\r\n\twidth: 17px;\r\n\theight: 17px;\r\n\tpadding: 1px;\r\n\r\n\tmargin: -10px auto 0;\r\n\tpointer-events: auto;\r\n\r\n\t-webkit-transform: rotate(45deg);\r\n\t   -moz-transform: rotate(45deg);\r\n\t    -ms-transform: rotate(45deg);\r\n\t        transform: rotate(45deg);\r\n\t}\r\n.leaflet-popup-content-wrapper,\r\n.leaflet-popup-tip {\r\n\tbackground: white;\r\n\tcolor: #333;\r\n\tbox-shadow: 0 3px 14px rgba(0,0,0,0.4);\r\n\t}\r\n.leaflet-container a.leaflet-popup-close-button {\r\n\tposition: absolute;\r\n\ttop: 0;\r\n\tright: 0;\r\n\tborder: none;\r\n\ttext-align: center;\r\n\twidth: 24px;\r\n\theight: 24px;\r\n\tfont: 16px/24px Tahoma, Verdana, sans-serif;\r\n\tcolor: #757575;\r\n\ttext-decoration: none;\r\n\tbackground: transparent;\r\n\t}\r\n.leaflet-container a.leaflet-popup-close-button:hover,\r\n.leaflet-container a.leaflet-popup-close-button:focus {\r\n\tcolor: #585858;\r\n\t}\r\n.leaflet-popup-scrolled {\r\n\toverflow: auto;\r\n\t}\r\n\r\n.leaflet-oldie .leaflet-popup-content-wrapper {\r\n\t-ms-zoom: 1;\r\n\t}\r\n.leaflet-oldie .leaflet-popup-tip {\r\n\twidth: 24px;\r\n\tmargin: 0 auto;\r\n\r\n\t-ms-filter: \"progid:DXImageTransform.Microsoft.Matrix(M11=0.70710678, M12=0.70710678, M21=-0.70710678, M22=0.70710678)\";\r\n\tfilter: progid:DXImageTransform.Microsoft.Matrix(M11=0.70710678, M12=0.70710678, M21=-0.70710678, M22=0.70710678);\r\n\t}\r\n\r\n.leaflet-oldie .leaflet-control-zoom,\r\n.leaflet-oldie .leaflet-control-layers,\r\n.leaflet-oldie .leaflet-popup-content-wrapper,\r\n.leaflet-oldie .leaflet-popup-tip {\r\n\tborder: 1px solid #999;\r\n\t}\r\n\r\n\r\n/* div icon */\r\n\r\n.leaflet-div-icon {\r\n\tbackground: #fff;\r\n\tborder: 1px solid #666;\r\n\t}\r\n\r\n\r\n/* Tooltip */\r\n/* Base styles for the element that has a tooltip */\r\n.leaflet-tooltip {\r\n\tposition: absolute;\r\n\tpadding: 6px;\r\n\tbackground-color: #fff;\r\n\tborder: 1px solid #fff;\r\n\tborder-radius: 3px;\r\n\tcolor: #222;\r\n\twhite-space: nowrap;\r\n\t-webkit-user-select: none;\r\n\t-moz-user-select: none;\r\n\t-ms-user-select: none;\r\n\tuser-select: none;\r\n\tpointer-events: none;\r\n\tbox-shadow: 0 1px 3px rgba(0,0,0,0.4);\r\n\t}\r\n.leaflet-tooltip.leaflet-interactive {\r\n\tcursor: pointer;\r\n\tpointer-events: auto;\r\n\t}\r\n.leaflet-tooltip-top:before,\r\n.leaflet-tooltip-bottom:before,\r\n.leaflet-tooltip-left:before,\r\n.leaflet-tooltip-right:before {\r\n\tposition: absolute;\r\n\tpointer-events: none;\r\n\tborder: 6px solid transparent;\r\n\tbackground: transparent;\r\n\tcontent: \"\";\r\n\t}\r\n\r\n/* Directions */\r\n\r\n.leaflet-tooltip-bottom {\r\n\tmargin-top: 6px;\r\n}\r\n.leaflet-tooltip-top {\r\n\tmargin-top: -6px;\r\n}\r\n.leaflet-tooltip-bottom:before,\r\n.leaflet-tooltip-top:before {\r\n\tleft: 50%;\r\n\tmargin-left: -6px;\r\n\t}\r\n.leaflet-tooltip-top:before {\r\n\tbottom: 0;\r\n\tmargin-bottom: -12px;\r\n\tborder-top-color: #fff;\r\n\t}\r\n.leaflet-tooltip-bottom:before {\r\n\ttop: 0;\r\n\tmargin-top: -12px;\r\n\tmargin-left: -6px;\r\n\tborder-bottom-color: #fff;\r\n\t}\r\n.leaflet-tooltip-left {\r\n\tmargin-left: -6px;\r\n}\r\n.leaflet-tooltip-right {\r\n\tmargin-left: 6px;\r\n}\r\n.leaflet-tooltip-left:before,\r\n.leaflet-tooltip-right:before {\r\n\ttop: 50%;\r\n\tmargin-top: -6px;\r\n\t}\r\n.leaflet-tooltip-left:before {\r\n\tright: 0;\r\n\tmargin-right: -12px;\r\n\tborder-left-color: #fff;\r\n\t}\r\n.leaflet-tooltip-right:before {\r\n\tleft: 0;\r\n\tmargin-left: -12px;\r\n\tborder-right-color: #fff;\r\n\t}\r\n\r\n/* Printing */\r\n\r\n@media print {\r\n\t/* Prevent printers from removing background-images of controls. */\r\n\t.leaflet-control {\r\n\t\t-webkit-print-color-adjust: exact;\r\n\t\tprint-color-adjust: exact;\r\n\t\t}\r\n\t}\r\n\n\n/* Import Leaflet locate control CSS */\n.leaflet-control-locate a {\n  cursor: pointer;\n}\n.leaflet-control-locate a .leaflet-control-locate-location-arrow {\n  display: inline-block;\n  width: 16px;\n  height: 16px;\n  margin: 7px;\n  background-image: url('data:image/svg+xml;charset=UTF-8,<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\"><path fill=\"black\" d=\"M445 4 29 195c-48 23-32 93 19 93h176v176c0 51 70 67 93 19L508 67c16-38-25-79-63-63z\"/></svg>');\n}\n.leaflet-control-locate a .leaflet-control-locate-spinner {\n  display: inline-block;\n  width: 16px;\n  height: 16px;\n  margin: 7px;\n  background-image: url('data:image/svg+xml;charset=UTF-8,<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\"><path fill=\"black\" d=\"M304 48a48 48 0 1 1-96 0 48 48 0 0 1 96 0zm-48 368a48 48 0 1 0 0 96 48 48 0 0 0 0-96zm208-208a48 48 0 1 0 0 96 48 48 0 0 0 0-96zM96 256a48 48 0 1 0-96 0 48 48 0 0 0 96 0zm13 99a48 48 0 1 0 0 96 48 48 0 0 0 0-96zm294 0a48 48 0 1 0 0 96 48 48 0 0 0 0-96zM109 61a48 48 0 1 0 0 96 48 48 0 0 0 0-96z\"/></svg>');\n  animation: leaflet-control-locate-spin 2s linear infinite;\n}\n.leaflet-control-locate.active a .leaflet-control-locate-location-arrow {\n  background-image: url('data:image/svg+xml;charset=UTF-8,<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\"><path fill=\"rgb(32, 116, 182)\" d=\"M445 4 29 195c-48 23-32 93 19 93h176v176c0 51 70 67 93 19L508 67c16-38-25-79-63-63z\"/></svg>');\n}\n.leaflet-control-locate.following a .leaflet-control-locate-location-arrow {\n  background-image: url('data:image/svg+xml;charset=UTF-8,<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\"><path fill=\"rgb(252, 132, 40)\" d=\"M445 4 29 195c-48 23-32 93 19 93h176v176c0 51 70 67 93 19L508 67c16-38-25-79-63-63z\"/></svg>');\n}\n\n.leaflet-touch .leaflet-bar .leaflet-locate-text-active {\n  width: 100%;\n  max-width: 200px;\n  text-overflow: ellipsis;\n  white-space: nowrap;\n  overflow: hidden;\n  padding: 0 10px;\n}\n.leaflet-touch .leaflet-bar .leaflet-locate-text-active .leaflet-locate-icon {\n  padding: 0 5px 0 0;\n}\n\n.leaflet-control-locate-location circle {\n  animation: leaflet-control-locate-throb 4s ease infinite;\n}\n\n@keyframes leaflet-control-locate-throb {\n  0% {\n    stroke-width: 1;\n  }\n  50% {\n    stroke-width: 3;\n    transform: scale(0.8, 0.8);\n  }\n  100% {\n    stroke-width: 1;\n  }\n}\n@keyframes leaflet-control-locate-spin {\n  0% {\n    transform: rotate(0deg);\n  }\n  100% {\n    transform: rotate(360deg);\n  }\n}\n\n/*# sourceMappingURL=L.Control.Locate.css.map */\n\n\n/* copy of original mapml.css from MapML.js submodule */\n\n.leaflet-container {\n  /* Override the `background-color` set by leaflet.css, enables inheritance from\n     the map or <body> element (same as iframes) to give the author more control. */\n  background-color: transparent;\n  max-height: 100%;\n  max-width: 100%;\n  min-height: 100%;\n  min-width: 100%;\n  width: 100% !important;\n  height: 100% !important;\n}\n\n/* this is required by tiles which are actually divs with multiple images in them */\n.leaflet-tile img {\n        position: absolute;\n        left: 0;\n        top: 0;\n\t}\n/* MapML treats images like map layers, so far as fade animation is concerned */\n.leaflet-fade-anim .leaflet-image-layer {\n        will-change: opacity;\n\t}\n        \n.leaflet-image-layer {\n        visibility: hidden;\n}\n.leaflet-image-loaded {\n        visibility: inherit;\n}\n\n/* Use legible font-sizes (Leaflet upstream PR: https://github.com/Leaflet/Leaflet/pull/7346). */\n.leaflet-control-scale-line,\n.leaflet-container .leaflet-control-scale,\n.leaflet-container .leaflet-control-attribution {\n  font-size: 12px;\n}\n\n/*\n * Controls.\n */\n.leaflet-container {\n    container: leafletmap / size;\n} \n/* Scale bar */\n .mapml-control-scale {\n  bottom: 8px; /* Make room for map-a links */\n  left: 0px; \n}\n@container leafletmap (max-height: 250px) {\n    .mapml-control-scale {\n        left: 45px; \n    }\n}\n\n/* for extents that don't overlap the viewport, the  extent and it's layer\ncontrol fieldset become disabled.  The descendant fieldsets also become \ndisabled (but they / their descendant content are not explicitly italicized by \nthe browser)' */\n.leaflet-control-layers-overlays fieldset:disabled span.mapml-layer-item-name {\n    font-style: italic;\n}\n\n /* Generic class for seamless buttons */\n .mapml-button {\n  background-color: transparent;\n  border: none;\n  border-radius: 0;\n  color: inherit;\n  font: inherit;\n  line-height: inherit;\n  margin: 0;\n  padding: 0;\n  overflow: hidden;\n  text-align: inherit;\n  text-transform: none;\n  -webkit-appearance: none;\n     -moz-appearance: none;\n          appearance: none;\n}\n\n/* Remove opinionated link colors set by Leaflet. */\n.leaflet-container a {\n  color: revert;\n}\n/* Don't use UA styles for links that are controls\n  (and don't inherit color from map into the reload button for consistency). */\n.mapml-reload-button,\n.leaflet-control-container a,\n.leaflet-container a.leaflet-popup-close-button,\n.leaflet-container a.leaflet-popup-close-button:hover {\n  color: #000;\n}\n/* Revert above `color: #000` for legendlinks. */\n.mapml-layer-item-name a {\n  color: revert;\n}\n\n .leaflet-top .leaflet-control {\n   margin-top: 5px;\n }\n \n .leaflet-left .leaflet-control {\n   margin-left: 5px;\n }\n\n.leaflet-bar a,\n.mapml-reload-button {\n  background-color: #fff;\n  box-sizing: border-box;\n  width: 44px !important;\n  height: 44px !important;\n  line-height: 44px !important;\n  font-size: 34px !important;\n  font-weight: normal;\n  text-align: center;\n}\n\n.mapml-reload-button:hover,\n.mapml-reload-button[aria-disabled=\"true\"] {\n  background-color: #f4f4f4;\n}\n\n.mapml-reload-button[aria-disabled=\"true\"] {\n  cursor: default;\n}\n\nbutton.mapml-button:disabled,\n.mapml-button[aria-disabled=\"true\"] {\n  color: #bbb;\n}\n\nbutton.mapml-contextmenu-item:disabled {\n  opacity: .3;\n}\n\n.leaflet-control-layers-toggle {\n  width: 44px !important;\n  height: 44px !important;\n}\n\n.leaflet-bar a,\n.leaflet-control-layers,\n.mapml-reload-button {\n  border-color: #e3e3e3 !important;\n}\n\n.leaflet-control-layers,\n.mapml-reload-button {\n  border-radius: 4px !important;\n}\n.leaflet-touch .leaflet-bar a:last-child {\n  border-bottom-left-radius: 4px !important;\n  border-bottom-right-radius: 4px !important;\n}\n.leaflet-touch .leaflet-bar a:first-child {\n  border-top-left-radius: 4px !important;\n  border-top-right-radius: 4px !important;\n}\n.leaflet-touch .leaflet-control-layers,\n.leaflet-touch .leaflet-bar {\n  border-style: inherit;\n}\n\n/* Less opinionated box-shadows. */\n.mapml-contextmenu,\n.mapml-debug,\n.leaflet-bar,\n.leaflet-control-layers,\n.leaflet-popup-content-wrapper,\n.leaflet-tooltip-pane .leaflet-tooltip,\n.leaflet-touch .leaflet-control-layers,\n.leaflet-touch .leaflet-bar,\n.leaflet-popup-tip,\n.leaflet-container .leaflet-control-attribution {\n  box-shadow: rgb(0 0 0 / 30%) 0px 1px 4px -1px;\n}\n\n/* Remove opinionated styles of attribution links. */\n.leaflet-control-attribution a {\n  color: revert;\n  text-decoration: revert;\n}\n\n\n/*\n * Attribution.\n */\n\n.leaflet-container .leaflet-control-attribution {\n  background-color: #fff;\n  border-radius: 1.5em;\n  color: currentColor;\n  margin: 5px;\n  min-height: 30px;\n  min-width: 30px;\n  padding: 0;\n}\n\n.leaflet-control-attribution summary {\n  display: block;\n  list-style: none;\n  border-radius: 100%;\n  position: absolute;\n  bottom: 0;\n  left: calc(100% - 30px);\n  line-height: 0;\n  width: 30px;\n  height: 30px;\n}\n\n.leaflet-control-attribution summary svg {\n  border-radius: 100%;\n  width: inherit;\n  height: inherit;\n}\n\n.mapml-attribution-container {\n  padding: 5px 35px 5px 10px;\n}\n\n/*\n * Zoom controls.\n */\n\n.leaflet-control-zoom-in,\n.leaflet-control-zoom-out {\n  text-indent: unset;\n}\n\n/*\n * Fullscreen control. Image contains the on and off images, toggled via\n * the background-position property\n */\n\n.leaflet-control-fullscreen a {  \n  background-image: url(\"data:image/svg+xml,%0A%3Csvg width='26' height='52' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'%3E%3Cg transform='translate(0 -1000.4)'%3E%3Cuse transform='translate(0 26)' width='100%25' height='100%25' xlink:href='%23a'/%3E%3Cuse transform='translate(0 26)' width='100%25' height='100%25' xlink:href='%23b'/%3E%3Cuse transform='translate(0 26)' width='100%25' height='100%25' xlink:href='%23c'/%3E%3Cuse transform='translate(0 26)' width='100%25' height='100%25' xlink:href='%23d'/%3E%3Cpath id='a' transform='translate(0 1000.4)' d='M5 15v6h6v-2H7v-4z' color='%23000' fill='%23404040'/%3E%3Cpath id='b' transform='translate(0 1000.4)' d='M21 15v6h-6v-2h4v-4z' color='%23000' fill='%23404040'/%3E%3Cpath d='M10 1037.4v4l1 1h4l1-1v-4l-1-1h-4z' color='%23000' fill='%23404040'/%3E%3Cpath id='d' d='M5 1011.4v-6h6v2H7v4z' color='%23000' fill='%23404040'/%3E%3Cpath id='c' d='M21 1011.4v-6h-6v2h4v4z' color='%23000' fill='%23404040'/%3E%3C/g%3E%3C/svg%3E\");\n  background-repeat: no-repeat;\n  background-size: 38px 76px;\n  background-position: 3px 3px;\n}\n\n/*\n* See: https://developer.mozilla.org/en-US/docs/Web/CSS/:host_function\nand: https://developer.mozilla.org/en-US/docs/Web/CSS/:fullscreen */\n:host(:fullscreen) .leaflet-control-fullscreen a {\n  background-position: 3px -35px;\n}\n\n:host(:-webkit-full-screen) {\n  width: 100%!important;\n  height: 100%!important;\n}\n\n:host(.leaflet-pseudo-fullscreen) {\n  position: fixed!important;\n  width: 100%!important;\n  height: 100%!important;\n  top: 0!important;\n  left: 0!important;\n  z-index: 99999;\n}\n\n/*\n * Layer controls.\n */\n\n.leaflet-control-layers.leaflet-control {\n  margin-right: 5px;\n  margin-left: 5px;\n  padding: 0;\n}\n\n.leaflet-control-layers-list {\n  padding: 0;\n}\n\n.leaflet-control-layers fieldset {\n  margin: 0;\n  padding: 0;\n  min-height: 44px;\n}\n\n.leaflet-control-layers label {\n  display: inline;\n}\n\n.mapml-control-layers > :not(summary) {\n  display: block;\n  margin-block-start: 5px;\n  margin-inline-start: 15px;\n  width: calc(100% - 15px);\n}\n\n.mapml-layer-item-style > div {\n  display: flex;\n}\n\n.mapml-layer-item-style input {\n  margin-inline-start: 0;\n}\n\n.leaflet-control .leaflet-control-layers-toggle {\n  background-image: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' height='24' width='24'%3E%3Cpath d='M0 0h24v24H0V0z' fill='none'/%3E%3Cpath d='m11.99 18.54-7.37-5.73L3 14.07l9 7 9-7-1.63-1.27zM12 16l7.36-5.73L21 9l-9-7-9 7 1.63 1.27L12 16zm0-11.47L17.74 9 12 13.47 6.26 9 12 4.53z'/%3E%3C/svg%3E\");\n  background-size: 34px;\n}\n\n/* Revert Leaflet styles that are causing misalignment. */\n.leaflet-control-layers-selector {\n  margin-top: revert;\n  position: revert;\n}\n\n/*\n * Context menu.\n */\n\n.mapml-contextmenu {\n  border-radius: 4px;\n  padding: 4px 0;\n  background-color: #fff;\n  cursor: default;\n  position: absolute;\n  width: fit-content;\n  display: inline-block;\n  z-index: 10001;\n}\n\n.mapml-contextmenu button.mapml-contextmenu-item {\n  color: #222;\n  font-size: 12px;\n  line-height: 20px;\n  text-decoration: none;\n  padding: 0 12px;\n  border-top: 1px solid transparent;\n  border-bottom: 1px solid transparent;\n  cursor: default;\n  width: 100%;\n  display: block;\n}\n\n.mapml-contextmenu button.mapml-contextmenu-item.over {\n  background-color: #f4f4f4;\n  border-top: 1px solid #f0f0f0;\n  border-bottom: 1px solid #f0f0f0;\n}\n      \n.mapml-contextmenu-separator {\n  border-bottom: 1px solid #e3e3e3;\n  margin: 5px 0;\n}\n\n.mapml-contextmenu.mapml-submenu {\n  width: 80px;\n  margin-bottom: -2rem;\n  width: fit-content;\n}\n\n@supports (contain: layout) {\n  .mapml-contextmenu {\n    position: fixed;\n  }\n  .mapml-contextmenu.mapml-submenu {\n    position: absolute;\n  }\n}\n\n.mapml-contextmenu-item[aria-controls] span::after {\n  content:\">\";\n}\n@supports (list-style-type: disclosure-open) {\n  .mapml-contextmenu-item[aria-controls] span {\n    display: inline-block;\n  }\n  .mapml-contextmenu-item[aria-controls] span::after {\n    content:\"\";\n    display: list-item;\n    list-style-type: disclosure-closed;\n    margin-inline-start: 20px;\n  }\n}\n\n/*\n * Debug mode.\n */\n\n.mapml-debug {\n  contain: content;\n  max-height: 100%;\n  max-width: 100%;\n  border-radius: 4px;\n  padding: 5px 10px;\n  background-color: #fff;\n  cursor: default;\n  z-index: 1000;\n  position: absolute;\n  display: block;\n  top: auto;\n  right: 5px;\n  bottom: 5px;\n  left: 5px;\n  width: -webkit-fit-content;\n  width: -moz-fit-content;\n  width: fit-content;\n  font: inherit;\n}\n\n.mapml-debug-banner {\n  font-weight: bold;\n  text-transform: uppercase;\n  display: inline-block;\n  text-align: left;\n  text-align: inline-start;\n  line-height: 2;\n}\n\n.mapml-debug-panel,\n.mapml-debug-grid {\n  font-family: monospace;\n}\n\n.mapml-debug-tile {\n  text-indent: 6px;\n  line-height: 1.8;\n}\n\n.mapml-debug-coordinates {\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n.mapml-debug,\n.mapml-debug * {\n  border-collapse: collapse;\n  border-spacing: 0;\n}\n\n.mapml-debug-coordinates:empty {\n  display: none;\n}\n\n.mapml-debug-coordinates > * {\n  display: inline;\n}\n\n:host(.mapml-fullscreen-on) .mapml-debug-grid {\n  color: #fff;\n  text-shadow: 1px 1px 1px #000, 1px 1px 1px #000;\n}\n\n/*\n * User interaction.\n */\n \n :host(.leaflet-drag-target) .leaflet-grab {\n   cursor: move;\n   cursor: -webkit-grabbing;\n   cursor:    -moz-grabbing;\n   cursor:         grabbing;\n }\n \n /* Prevent `:hover` styles from applying to controls when the user is panning\n the map display and the cursor happens to move over a control. */\n:host(.leaflet-drag-target) .leaflet-control {\n  pointer-events: none;\n}\n\n/* Disable dragging of controls. */\n.mapml-popup-button,\n.leaflet-popup-close-button,\n.leaflet-control :not([draggable=\"true\"]),\n.mapml-contextmenu :not([draggable=\"true\"]) {\n  -webkit-user-drag: none;\n}\n\n/* Disable text selection in controls. */\n.leaflet-control,\n.mapml-contextmenu,\n.mapml-debug,\n.mapml-focus-buttons,\n.mapml-layer-item-settings summary {\n  -webkit-user-select: none;\n  -moz-user-select: none;\n  -ms-user-select: none;\n  user-select: none;\n}\n\n/* Hide unintended highlighting of controls from clicking the map display in\n   quick succession. This is a workaround for `user-select: contain`, since it has\n   virtually no browser support: https://www.chromestatus.com/feature/5730263904550912. */\n.leaflet-control a::selection,\n.leaflet-popup-close-button::selection,\n.leaflet-control-attribution::selection {\n  background-color: transparent;\n}\n\n/* Disable pointer events where they'd interfere with the intended action. */\n.mapml-feature-index-box,\n.leaflet-tooltip,\n.leaflet-crosshair *,\n.mapml-layer-item-settings .mapml-control-layers summary label,\n.mapml-contextmenu-item > *,\n.mapml-link-preview {\n  pointer-events: none!important;\n}\n\n/* Restore the default focus outline of UA stylesheets,\n   which Leaflet unfortunately removes (https://github.com/Leaflet/Leaflet/issues/6986). */\n.leaflet-container :focus {\n  outline-color: -webkit-focus-ring-color !important;\n  outline-style: auto !important;\n  outline-width: thin !important;\n  outline: revert !important;\n}\n/* Unset the outline that Leaflet occasionally sets on controls without also\n   delegating focus. */\n.leaflet-active:not(:focus) {\n  outline: unset !important;\n}\n.leaflet-container:not(:focus-within) .mapml-outline {\n  outline: 0;\n}\n.leaflet-container:not(:focus-within) .mapml-crosshair {\n  display: none;\n}\n\n/* Restore the default UA tap highlight color by overriding the opinionated tap\n   highlight color inherited from leaflet.css. */\n.leaflet-control a {\n  -webkit-tap-highlight-color: initial;\n}\n\n/* Less opinionated styles for the zoom box than inherited from leaflet.css. */\n.leaflet-zoom-box {\n  border: thin dotted;\n  background-color: rgba(255,255,255,0.33);\n}\n\nlabel,\ninput,\nbutton,\nsummary {\n  cursor: pointer;\n}\n\n.mapml-draggable,\n.mapml-draggable * {\n  cursor: row-resize;\n}\n\n.leaflet-crosshair {\n  cursor: crosshair;\n}\n\n[hidden] {\n  display: none!important;\n}\n\n/*\n * Visibility hack  mitigates FOUC.\n * (https://github.com/Maps4HTML/MapML.js/issues/154)\n */\n\n/* Unset `visibility: hidden` (inherited from mapml.js). */\n.leaflet-container .mapml-contextmenu,\n.leaflet-container .leaflet-control-container {\n  visibility: unset!important;\n}\n\n.mapml-crosshair {\n  margin: -36px 0 0 -36px;\n  width: 72px;\n  height: 72px;\n  left: 50%;\n  top: 50%;\n  position: absolute;\n  z-index: 10000;\n}\n\n.mapml-popup-button {\n\tpadding: 0 4px 0 4px;\n\tborder: none;\n\ttext-align: center;\n\tfont: 16px/14px Tahoma, Verdana, sans-serif;\n\tcolor: inherit;\n\ttext-decoration: none;\n\tfont-weight: bold;\n  background: transparent;\n  white-space: nowrap;\n  box-sizing: border-box;\n  width: 44px;\n  height: 44px;\n  line-height: 44px;\n}\n\n.mapml-zoom-link {\n  display: block;\n  text-align: center;\n}\n\n.mapml-focus-buttons {\n  white-space: nowrap;\n}\n\n.mapml-feature-count {\n  display:inline;\n  white-space: nowrap;\n  text-align: center;\n  padding: 2px;\n}\n\n.mapml-focus-buttons button,\n.leaflet-container a.leaflet-popup-close-button {\n  width: 44px;\n  height: 44px;\n  min-width: 44px;\n  min-height: 44px;\n  line-height: 44px;\n}\n.leaflet-popup-content {\n  margin: 0;\n  min-width: min-content;\n  scrollbar-width: thin;\n}\n.mapml-popup-content {\n  padding-top: 44px;\n}\n.mapml-focus-buttons {\n  display: block;\n  text-align: center;\n}\n.mapml-focus-buttons button {\n  display: inline-block;\n  padding: 0;\n}\n.leaflet-container a.leaflet-popup-close-button {\n  padding: 0;\n  font-size: 20px;\n}\n.leaflet-popup-content .mapml-feature-count {\n  margin: 0;\n  padding: 0 5px;\n  line-height: 44px;\n}\n.mapml-popup-content hr:last-of-type {\n  margin-bottom: 0;\n  border-bottom: 0;\n  border-top: 1px solid #e3e3e3;\n}\n.mapml-popup-content :first-child {\n  margin-top: 0;\n  padding-top: 0;\n}\n.mapml-popup-content > :not(.mapml-focus-buttons) {\n  padding: 0 1rem;\n}\n.leaflet-popup-tip-container {\n  margin-top: -1px;\n}\n\n.mapml-outline {\n  outline-style: auto;\n  outline-offset: -2px;\n  z-index: 1000;\n  pointer-events: none;\n  position: absolute;\n  height: 100%;\n  width: 100%;\n  color: initial;\n}\n \n /* Force printers to include background-images of controls for printing.\n   (https://github.com/Maps4HTML/MapML.js/issues/294) */\n@media print {\n  .leaflet-control {\n    -webkit-print-color-adjust: exact;\n    print-color-adjust: exact;\n  }\n}\n\n.leaflet-pane > svg g.leaflet-interactive,\nsvg.leaflet-image-layer.leaflet-interactive g {\n  pointer-events: visiblePainted; /* IE 9-10 doesn't have auto */\n  pointer-events: auto;\n}\n\n.mapml-link-preview {\n  position: absolute;\n  left: 0;\n  bottom: 0;\n  background-color: rgb(222,225,230);\n  border-radius: 0 5px 0 0 ;\n  z-index: 1050;  \n  max-width: 60%;\n}\n\n.mapml-link-preview > p {\n  margin: 3px 5px 2px 3px;\n  color: rgb(60,64,67);\n  text-overflow: ellipsis;\n  overflow-x: hidden;\n  white-space: nowrap;\n}\n\n/**\n* layer item controls\n*/\n\n.mapml-button-icon {\n  pointer-events: none;\n}\n\n.mapml-button-icon svg {\n  fill: currentColor;\n}\n\n.mapml-layer-item,\n.mapml-layer-item * {\n  box-sizing: border-box;\n}\n\n.mapml-layer-item,\n.mapml-layer-grouped-extents,\n.mapml-layer-extent {\n  background-color: #fff;\n  border: 1px solid #fff;\n  margin: 0;\n  padding: 0;\n}\n\n.mapml-layer-item:not(:last-of-type) {\n  border-bottom: 1px solid #e3e3e3;\n}\n.mapml-layer-item[aria-grabbed=\"true\"],\n.mapml-layer-extent[aria-grabbed=\"true\"] {\n  border: 1px solid #e3e3e3;\n  border-radius: 0;\n}\n.mapml-layer-item:first-of-type,\n.mapml-layer-extent:first-of-type {\n  border-top-left-radius: 4px;\n  border-top-right-radius: 4px;\n}\n.mapml-layer-item:last-of-type,\n.mapml-layer-extent:last-of-type {\n  border-bottom-left-radius: 4px;\n  border-bottom-right-radius: 4px;\n}\n\n.mapml-layer-item-properties {\n  align-items: center;\n  display: flex;\n  justify-content: space-between;\n  padding-inline-start: .5rem;\n}\n.mapml-layer-item-controls {\n  margin-inline-start: auto;\n}\n\n\n.mapml-layer-item-controls button span {\n  font-size: large;\n  font-weight: 900;\n  vertical-align: middle;\n}\n\n.mapml-layer-item-controls button svg {\n  vertical-align: text-bottom;\n}\n\n.mapml-layer-item-controls,\n.mapml-layer-item-remove-control,\n.mapml-layer-item-settings-control {\n  align-items: center;\n  display: flex;\n  justify-content: center;\n}\n\n\n.mapml-layer-item-remove-control,\n.mapml-layer-item-settings-control {\n  min-height: 44px;\n  min-width: 44px;\n  height: 44px;\n  width: 44px;\n}\n\nlabel.mapml-layer-item-toggle {\n  display: inline-flex;\n  align-items: center;\n  width: 100%; /* have the clickable area take up all available width */\n  min-height: 44px;\n}\n\n.mapml-layer-item-name {\n  word-break: break-word;\n  padding-block-start: .25rem;\n  padding-block-end: .25rem;\n  padding-inline-start: .25rem;\n  padding-inline-end: 1rem;\n}\n\n.mapml-layer-item-settings > * {\n  display: block;\n  padding-block-start: .25rem;\n  padding-block-end: .25rem;\n  padding-inline-start: 2rem;\n  padding-inline-end: 1rem;\n}\n\n.mapml-screen-reader-output {\n  clip: rect(0 0 0 0);\n  clip-path: inset(50%);\n  height: 1px;\n  overflow: hidden;\n  position: absolute;\n  white-space: nowrap;\n  width: 1px;\n}\n\n.mapml-screen-reader-output-scale {\n  clip: rect(0 0 0 0);\n  clip-path: inset(50%);\n  height: 1px;\n  overflow: hidden;\n  position: absolute;\n  white-space: nowrap;\n  width: 1px\n}\n/*\n * Feature styles.\n */\n\n.mapml-vector-container svg :is(\n  [role=\"link\"]:focus,\n  [role=\"link\"]:hover,\n  [role=\"link\"]:focus path,\n  [role=\"link\"]:hover path,\n  [role=\"link\"] path:focus,\n  [role=\"link\"] path:hover,\n  [role=\"button\"]:focus,\n  [role=\"button\"]:hover,\n  [role=\"button\"]:focus path,\n  [role=\"button\"]:hover path,\n  [role=\"button\"] path:focus,\n  [role=\"button\"] path:hover,\n  path[tabindex=\"0\"]:focus\n  ) {\n  stroke: #0000EE;\n  stroke: LinkText;\n}\n.mapml-vector-container svg :is(\n  [role=\"link\"]:focus:not(:focus-visible),\n  [role=\"link\"]:focus:not(:focus-visible) path,\n  [role=\"link\"] path:focus:not(:focus-visible),\n  [role=\"button\"]:focus:not(:focus-visible),\n  [role=\"button\"]:focus:not(:focus-visible) path,\n  [role=\"button\"] path:focus:not(:focus-visible),\n  path[tabindex=\"0\"]:focus:not(:focus-visible)\n  ) {\n  outline: 0!important;\n}\n\n/*\n* Extent Elements in the Layer Control\n*/\n\n.mapml-layer-item-settings .mapml-layer-extent {\n  padding-inline-start: 1.8rem;\n}\n\n.mapml-layer-item-settings .mapml-layer-extent .mapml-layer-item-properties{\n  padding-inline-start: 0;\n}\n\n.mapml-layer-item-settings .mapml-layer-extent .mapml-layer-item-details {\n  padding-inline-start: 1.6rem;\n}\n\n/**\n* Feature Index\n */\n.mapml-feature-index-box {\n  margin: -8% 0 0 -8%;\n  width: 16%;\n  left: 50%;\n  top: 50%;\n  position: absolute;\n  z-index: 10000;\n  outline: 2px solid #fff;\n}\n\n.mapml-feature-index-box:after{\n  display: block;\n  content: '';\n  padding-top: 100%;\n}\n\n.mapml-feature-index-box > svg {\n  position: absolute;\n  width: 100%;\n  height: 100%;\n}\n\n.mapml-feature-index {\n  outline: 1px solid #000000;\n  contain: content;\n  border-radius: 4px;\n  background-color: #fff;\n  cursor: default;\n  z-index: 1000;\n  position: absolute;\n  top: auto;\n  left: 50%;\n  -ms-transform: translateX(-50%);\n  transform: translateX(-50%);\n  bottom: 30px;\n  padding-top: 5px;\n  height: 92px;\n  width: 450px;\n  font-size: 16px;\n}\n@container leafletmap (max-width: 650px ) {\n    .mapml-feature-index {\n        width: 70cqw; \n    }\n}\n@container leafletmap (max-width: 390px ) {\n    .mapml-feature-index {\n        bottom: 100px; \n    }\n}\n.mapml-feature-index-content > span{\n  width: 140px;\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  display: inline-block;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n.shortcuts-dialog > ul > li > kbd,\n.mapml-feature-index-content > span > kbd{\n  background-color: lightgrey;\n  padding-right: 4px;\n  padding-left: 4px;\n  border-radius: 4px;\n}\n\n.mapml-feature-index-content > span > span{\n  clip: rect(0 0 0 0);\n  clip-path: inset(50%);\n  height: 1px;\n  overflow: hidden;\n  position: absolute;\n  white-space: pre;\n  width: 1px;\n}\n\n.shortcuts-dialog > button{\n  font-size: inherit;\n}\n\n.shortcuts-dialog > ul {\n  padding: 0;\n  list-style-type:none;\n}\n\n.mapml-tile-group > svg { \n    overflow: visible;\n}\n/* ===== ESSENTIAL HOST DEFAULTS (immediate application for getBoundingClientRect) ===== */\n:host {\n  /* Reset first, then apply critical MapML defaults */\n  all: initial;\n  \n  /* Critical MapML defaults that must be available immediately */\n  display: inline-block;\n  background-color: white;\n  /* Default dimensions - will be overridden by JavaScript based on CSS rules or attributes */\n  height: 150px;        \n  width: 300px;         \n  contain: layout size;\n  border-width: 2px;\n  border-style: inset;\n}\n\n/* Ensure white background persists in fullscreen */\n:host(.mapml-fullscreen-on) {\n  background-color: white;\n}\n/* Ensure container fills the host element */\n.mapml-map-container {\n  width: 100%;\n  height: 100%;\n  display: block;\n}\n\n/* ===== GCDS LAYER ARCHITECTURE ===== */\n@layer reset, default, display, size, variant, hover, visited, focus;\n\n@layer reset {\n  :host {\n    /* GCDS responsive overrides (when CSS loads) */\n    position: relative;\n    \n    /* Aspect ratio support for responsive design */\n    aspect-ratio: var(--map-aspect);\n  }\n}\n\n@layer default {\n  :host {\n    /* Visual styling */\n    border: 2px inset;\n    cursor: pointer;\n    transition: all 0.35s;\n  }\n  \n  /* Attribute-based styling */\n  :host([frameborder=\"0\"]) {\n    border-width: 0;\n  }\n  \n  :host([hidden]) {\n    display: none !important;\n  }\n}/* Remaining layers: size, variant, hover, visited, focus remain unchanged */\n/* Optional: Add any gcds-specific styling here */\n/* You may want to import gcds design tokens if available */\n";const pe=class{constructor(t){i(this,t)}get el(){return r(this)}lat=0;lon=0;zoom=0;projection="OSMTILE";controls=false;static=false;_controlslist;locale;_controlsList;_source;_history=[];_historyIndex=-1;_traversalCall=false;_map;_container;mapCaptionObserver;_featureIndexOverlay;_zoomControl;_layerControl;_reloadButton;_fullScreenControl;_geolocationButton;_scaleBar;_isInitialized=false;_debug;_crosshair;_boundDropHandler;_boundDragoverHandler;controlsChanged(t){if(this._map){if(t){this._showControls()}else{this._hideControls()}}}controlsListChanged(t){if(this._controlsList){this._controlsList.value=t;if(this._map){this._toggleControls()}}}get controlsList(){return this._controlsList}set controlsList(t){if(this._controlsList&&(typeof t==="string"||t===null)){if(t){this.el.setAttribute("controlslist",t)}else{this.el.removeAttribute("controlslist")}if(this._map){this._toggleControls()}}}async projectionChanged(t,e){if(t&&this._map&&this._map.options.projection!==t){const n=()=>{let e=this.lat;let n=this.lon;let i=this.zoom;this._map.options.crs=window.M[t];this._map.options.projection=t;let r=[];this._map.announceMovement?.disable();const s=this.el.querySelectorAll("map-layer,layer-");for(let t of Array.from(s)){t.removeAttribute("disabled");let e=this.el.removeChild(t);this.el.appendChild(e);if(e.whenReady){r.push(e.whenReady())}}return Promise.allSettled(r).then((()=>{const t=this.el.layers;if(t.length===1){const e=t[0];if(e.extent){this._map.setMinZoom(e.extent.zoom.minZoom);this._map.setMaxZoom(e.extent.zoom.maxZoom)}}this.zoomTo(e,n,i);if(window.M.options.announceMovement)this._map.announceMovement?.enable();setTimeout((()=>{this.el.dispatchEvent(new CustomEvent("map-projectionchange"))}),0)}))};const i=n.bind(this);try{await this.whenProjectionDefined(t);await i();if(this._map&&this._map.options.projection!==e){this._resetHistory()}if(this._debug){for(let t=0;t<2;t++)this.toggleDebug()}}catch{throw new Error("Undefined projection: "+t)}}}get extent(){let t=this._map,e=n.pixelToPCRSBounds(t.getPixelBounds(),t.getZoom(),t.options.projection);let i=n._convertAndFormatPCRS(e,t.options.crs,this.projection);let r=Infinity,s=-Infinity;const o=this.el.layers;for(let t=0;t<o.length;t++){if(o[t].extent){if(o[t].extent.zoom.minZoom<r)r=o[t].extent.zoom.minZoom;if(o[t].extent.zoom.maxZoom>s)s=o[t].extent.zoom.maxZoom}}i.zoom={minZoom:r!==Infinity?r:t.getMinZoom(),maxZoom:s!==-Infinity?s:t.getMaxZoom()};return i}getWidth(){return+window.getComputedStyle(this.el).width.replace("px","")}getHeight(){return+window.getComputedStyle(this.el).height.replace("px","")}staticChanged(){if(this._map){this._toggleStatic()}}componentWillLoad(){this._source=this.el.outerHTML;this._history=[];this._historyIndex=-1;this._traversalCall=false}async connectedCallback(){try{this.el._history=this._history;this.el._historyIndex=this._historyIndex;Object.defineProperty(this.el,"width",{get:()=>+window.getComputedStyle(this.el).width.replace("px",""),set:t=>{this.el.setAttribute("width",t)},enumerable:true,configurable:true});Object.defineProperty(this.el,"height",{get:()=>+window.getComputedStyle(this.el).height.replace("px",""),set:t=>{this.el.setAttribute("height",t)},enumerable:true,configurable:true});await this._ensureControlsLoaded();await this.whenProjectionDefined(this.projection);this._setLocale();this._initShadowRoot();this._controlsList=new f(this.el.getAttribute("controlslist"),this.el,"controlslist",["noreload","nofullscreen","nozoom","nolayer","noscale","geolocation"]);var t=window.getComputedStyle(this.el),e=t.width,n=t.height,i=this.el.hasAttribute("width")?this.el.getAttribute("width"):parseInt(e.replace("px","")),r=this.el.hasAttribute("height")?this.el.getAttribute("height"):parseInt(n.replace("px",""));this._changeWidth(i);this._changeHeight(r);this._createMap();this._isInitialized=true;const s=new MutationObserver((t=>{t.forEach((t=>{if(t.type==="attributes"&&t.attributeName){const e=this.el.getAttribute(t.attributeName);if(t.attributeName==="width"&&e){this._changeWidth(e)}else if(t.attributeName==="height"&&e){this._changeHeight(e)}}}))}));s.observe(this.el,{attributes:true,attributeFilter:["width","height"]});this.el._attributeObserver=s;this.el.setAttribute("role","application");this._toggleStatic();let o=this.el.querySelector("map-caption");if(o!==null){setTimeout((()=>{let t=this.el.getAttribute("aria-label");if(t===o.innerHTML){this.mapCaptionObserver=new MutationObserver((t=>{let e=this.el.querySelector("map-caption");if(e!==o){this.el.removeAttribute("aria-label")}}));this.mapCaptionObserver.observe(this.el,{childList:true})}}),0)}}catch(t){console.log(t);throw new Error("Error: "+t)}}_setLocale(){if(this.el.closest(":lang(fr)")===this.el){this.locale=s}else if(this.el.closest(":lang(en)")===this.el){this.locale=o}else{const t=document.head.querySelector("map-options");if(t&&t.textContent){try{const e=JSON.parse(t.textContent);if(e.locale){this.locale=e.locale;return}}catch(t){console.warn("Failed to parse map-options:",t)}}this.locale=o}}_initShadowRoot(){let t=this.el.shadowRoot;if(t.querySelector('[aria-label="Interactive map"]'))return;const e=()=>{if(t.styleSheets.length===0){requestAnimationFrame(e);return}let n=document.createElement("style");n.innerHTML=`:host {`+`all: initial;`+`display: inline-block;`+`background-color: white;`+`height: 150px;`+`width: 300px;`+`contain: layout size;`+`border-width: 2px;`+`border-style: inset;`+`}`;t.appendChild(n)};e();this._container=document.createElement("div");let n="<output role='status' aria-live='polite' aria-atomic='true' class='mapml-screen-reader-output'></output>";this._container.insertAdjacentHTML("beforeend",n);this._container.setAttribute("role","region");this._container.setAttribute("aria-label","Interactive map");t.appendChild(this._container);this.el._container=this._container;let i=document.createElement("style");i.innerHTML=`gcds-map > * { display: none!important; }`;this.el.appendChild(i)}_createMap(){if(!this._map){this._map=t.map(this._container,{center:new t.LatLng(this.lat,this.lon),minZoom:0,maxZoom:window.M[this.projection].options.resolutions.length-1,projection:this.projection,query:true,contextMenu:true,announceMovement:true,featureIndex:true,mapEl:this.el,crs:window.M[this.projection],zoom:this.zoom,zoomControl:false});this.el._map=this._map;window._debugMap=this._map;this.el._history=this._history;this.el._historyIndex=this._historyIndex;Object.defineProperty(this.el,"controlsList",{get:()=>this._controlsList,set:t=>{if(this._controlsList&&(typeof t==="string"||t===null)){this._controlsList.value=t||"";if(this._map){this._toggleControls()}}},configurable:true,enumerable:true});Object.defineProperty(this.el,"layers",{get:()=>this.el.getElementsByTagName("map-layer"),configurable:true,enumerable:true});Object.defineProperty(this.el,"locale",{get:()=>this.locale,configurable:true,enumerable:true});Object.defineProperty(this.el,"extent",{get:()=>this.extent,configurable:true,enumerable:true});Object.defineProperty(this.el,"width",{get:()=>this.getWidth(),set:t=>{this.el.setAttribute("width",t);if(this._isInitialized){this._changeWidth(t)}},configurable:true,enumerable:true});Object.defineProperty(this.el,"height",{get:()=>this.getHeight(),set:t=>{this.el.setAttribute("height",t);if(this._isInitialized){this._changeHeight(t)}},configurable:true,enumerable:true});Object.defineProperty(this.el,"zoomTo",{value:(t,e,n)=>this.zoomTo(t,e,n),writable:true,configurable:true});Object.defineProperty(this.el,"back",{value:()=>this.back(),writable:true,configurable:true});Object.defineProperty(this.el,"forward",{value:()=>this.forward(),writable:true,configurable:true});Object.defineProperty(this.el,"reload",{value:()=>this.reload(),writable:true,configurable:true});Object.defineProperty(this.el,"toggleDebug",{value:()=>this.toggleDebug(),writable:true,configurable:true});Object.defineProperty(this.el,"viewSource",{value:()=>this.viewSource(),writable:true,configurable:true});Object.defineProperty(this.el,"matchMedia",{value:(...t)=>Ft.apply(this.el,t),writable:true,configurable:true});Object.defineProperty(this.el,"geojson2mapml",{value:(t,e)=>this.geojson2mapml(t,e),writable:true,configurable:true});Object.defineProperty(this.el,"defineCustomProjection",{value:t=>this.defineCustomProjection(t),writable:true,configurable:true});this.el._toggleFullScreen=()=>this._toggleFullScreen();this.el._toggleControls=()=>this._toggleControls();this._addToHistory();this._createControls();this._toggleControls();this._crosshair=ce().addTo(this._map);if(window.M.options.featureIndexOverlayOption)this._featureIndexOverlay=ue().addTo(this._map);this._setUpEvents()}}disconnectedCallback(){this._removeEvents();if(this.el._attributeObserver){this.el._attributeObserver.disconnect();delete this.el._attributeObserver}delete this._map;this._deleteControls()}async _ensureControlsLoaded(){try{await import("./p-LYfn_27I.js");await import("./p-PZrWUcjo.js").then((function(t){return t.C}));await import("./p-PZrWUcjo.js").then((function(t){return t.A}));await import("./p-PZrWUcjo.js").then((function(t){return t.k}));await import("./p-PZrWUcjo.js").then((function(t){return t.j}))}catch(t){console.error("Failed to load MapML controls:",t)}}_createControls(){let e=this._map.getSize().y,n=0;this._layerControl=Nt(null,{collapsed:true,mapEl:this.el}).addTo(this._map);this._map.on("movestart",this._layerControl.collapse,this._layerControl);this.el._layerControl=this._layerControl;let i=window.M.options.announceScale;if(i==="metric"){i={metric:true,imperial:false}}if(i==="imperial"){i={metric:false,imperial:true}}if(!this._scaleBar){this._scaleBar=Dt(i).addTo(this._map);this.el._scaleBar=this._scaleBar}if(!this._zoomControl&&n+93<=e){n+=93;this._zoomControl=t.control.zoom({zoomInTitle:this.locale.btnZoomIn,zoomOutTitle:this.locale.btnZoomOut}).addTo(this._map);this.el._zoomControl=this._zoomControl}if(!this._reloadButton&&n+49<=e){n+=49;this._reloadButton=qt().addTo(this._map);this.el._reloadButton=this._reloadButton}if(!this._fullScreenControl&&n+49<=e){n+=49;this._fullScreenControl=Kt().addTo(this._map);this.el._fullScreenControl=this._fullScreenControl}if(!this._geolocationButton){this._geolocationButton=Jt().addTo(this._map);this.el._geolocationButton=this._geolocationButton}this.el.locate=this.locate.bind(this)}_toggleControls(){if(this.controls===false){this._hideControls();this._map.contextMenu.toggleContextMenuItem("Controls","disabled")}else{this._showControls();this._map.contextMenu.toggleContextMenuItem("Controls","enabled")}}_hideControls(){this._setControlsVisibility("fullscreen",true);this._setControlsVisibility("layercontrol",true);this._setControlsVisibility("reload",true);this._setControlsVisibility("zoom",true);this._setControlsVisibility("geolocation",true);this._setControlsVisibility("scale",true)}_showControls(){this._setControlsVisibility("fullscreen",false);this._setControlsVisibility("layercontrol",false);this._setControlsVisibility("reload",false);this._setControlsVisibility("zoom",false);this._setControlsVisibility("geolocation",true);this._setControlsVisibility("scale",false);if(this._controlsList){this._controlsList.forEach((t=>{switch(t.toLowerCase()){case"nofullscreen":this._setControlsVisibility("fullscreen",true);break;case"nolayer":this._setControlsVisibility("layercontrol",true);break;case"noreload":this._setControlsVisibility("reload",true);break;case"nozoom":this._setControlsVisibility("zoom",true);break;case"geolocation":this._setControlsVisibility("geolocation",false);break;case"noscale":this._setControlsVisibility("scale",true);break}}))}if(this._layerControl&&this._layerControl._layers.length===0){this._layerControl._container.setAttribute("hidden","")}}_deleteControls(){delete this._layerControl;delete this._zoomControl;delete this._reloadButton;delete this._fullScreenControl;delete this._geolocationButton;delete this._scaleBar}_setControlsVisibility(t,e){let n;switch(t){case"zoom":if(this._zoomControl){n=this._zoomControl._container}break;case"reload":if(this._reloadButton){n=this._reloadButton._container}break;case"fullscreen":if(this._fullScreenControl){n=this._fullScreenControl._container}break;case"layercontrol":if(this._layerControl){n=this._layerControl._container}break;case"geolocation":if(this._geolocationButton){n=this._geolocationButton._container}break;case"scale":if(this._scaleBar){n=this._scaleBar._container}break}if(n){if(e){[...n.children].forEach((t=>{t.setAttribute("hidden","")}));n.setAttribute("hidden","")}else{[...n.children].forEach((t=>{t.removeAttribute("hidden")}));n.removeAttribute("hidden")}}}_toggleStatic(){if(this._map){if(this.static){this._map.dragging.disable();this._map.touchZoom.disable();this._map.doubleClickZoom.disable();this._map.scrollWheelZoom.disable();this._map.boxZoom.disable();this._map.keyboard.disable();this._zoomControl.disable()}else{this._map.dragging.enable();this._map.touchZoom.enable();this._map.doubleClickZoom.enable();this._map.scrollWheelZoom.enable();this._map.boxZoom.enable();this._map.keyboard.enable();this._zoomControl.enable()}}}_removeEvents(){if(this._map){this._map.off()}if(this._boundDropHandler){this.el.removeEventListener("drop",this._boundDropHandler,false)}if(this._boundDragoverHandler){this.el.removeEventListener("dragover",this._boundDragoverHandler,false)}}_setUpEvents(){this._boundDropHandler=this._dropHandler.bind(this);this._boundDragoverHandler=this._dragoverHandler.bind(this);this.el.addEventListener("drop",this._boundDropHandler,false);this.el.addEventListener("dragover",this._boundDragoverHandler,false);this._map.on("moveend",(function(){this._updateMapCenter();this._addToHistory();this.el.dispatchEvent(new CustomEvent("map-moveend",{detail:{target:this}}))}),this);this._map.on("zoom",(function(){this.el.dispatchEvent(new CustomEvent("map-zoom",{detail:{target:this}}))}),this);this._map.on("zoomend",(function(){this._updateMapCenter();this.el.dispatchEvent(new CustomEvent("zoomend",{detail:{target:this}}))}),this);this._map.on("locationfound",(function(t){this.el.dispatchEvent(new CustomEvent("maplocationfound",{detail:{latlng:t.latlng,accuracy:t.accuracy}}))}),this);this._map.on("locationerror",(function(t){this.el.dispatchEvent(new CustomEvent("maplocationerror",{detail:{message:t.message,code:t.code}}))}),this);const t=(t=>{this.whenLayersReady().then((()=>{if(t&&t.layer._layerEl){this._map.setMaxZoom(this.extent.zoom.maxZoom);this._map.setMinZoom(this.extent.zoom.minZoom)}}))}).bind(this);this.whenLayersReady().then((()=>{this._map.setMaxZoom(this.extent.zoom.maxZoom);this._map.setMinZoom(this.extent.zoom.minZoom);this._map.on("layeradd layerremove",t,this)}));this.el.addEventListener("keydown",(t=>{if(t.keyCode===86&&t.ctrlKey){navigator.clipboard.readText().then((t=>{n._pasteLayer(this.el,t)}))}else if(t.keyCode===32&&this.el.shadowRoot.activeElement?.nodeName!=="INPUT"){t.preventDefault();this._map.fire("keypress",{originalEvent:t})}}))}_dropHandler(t){t.preventDefault();let e=t.dataTransfer.getData("text");n._pasteLayer(this.el,e)}_dragoverHandler(t){t.preventDefault();t.dataTransfer.dropEffect="copy"}toggleDebug(){if(this._debug){this._debug.remove();this._debug=undefined}else{this._debug=te().addTo(this._map)}}locate(t){if(this._geolocationButton){this._geolocationButton.stop()}if(t){if(t.zoomTo){t.setView=t.zoomTo;delete t.zoomTo}this._map.locate(t)}else{this._map.locate({setView:true,maxZoom:16})}}_changeWidth(t){if(this._container){this._container.style.width=t+"px";const e=this.el.shadowRoot.styleSheets;if(e.length>0){e[e.length-1].cssRules[0].style.width=t+"px"}}if(this._map){this._map.invalidateSize(false)}}_changeHeight(t){if(this._container){this._container.style.height=t+"px";const e=this.el.shadowRoot.styleSheets;if(e.length>0){e[e.length-1].cssRules[0].style.height=t+"px"}}if(this._map){this._map.invalidateSize(false)}}_updateMapCenter(){if(this._map){const t=this._map.getCenter();this.lat=t.lat;this.lon=t.lng;this.zoom=this._map.getZoom();this.el.setAttribute("lat",this.lat.toString());this.el.setAttribute("lon",this.lon.toString());this.el.setAttribute("zoom",this.zoom.toString())}}_resetHistory(){this._history=[];this._historyIndex=-1;this._traversalCall=false;this._addToHistory()}_addToHistory(){if(this._traversalCall&&this._traversalCall>0){this._traversalCall--;return}let t=this._map.getPixelBounds().getCenter();let e={zoom:this._map.getZoom(),x:t.x,y:t.y};this._historyIndex++;this._history.splice(this._historyIndex,0,e);if(this._historyIndex+1!==this._history.length){this._history.length=this._historyIndex+1}this._updateNavigationControls();this.el._history=this._history;this.el._historyIndex=this._historyIndex}_updateNavigationControls(){const t=this._historyIndex>0;const e=this._historyIndex<this._history.length-1;const n=this._historyIndex>0;this._map.contextMenu.toggleContextMenuItem("Back",t?"enabled":"disabled");this._map.contextMenu.toggleContextMenuItem("Forward",e?"enabled":"disabled");this._map.contextMenu.toggleContextMenuItem("Reload",n?"enabled":"disabled");if(n){this._reloadButton?.enable()}else{this._reloadButton?.disable()}}back(){if(this._historyIndex<=0)return;let t=this._history[this._historyIndex];this._historyIndex--;let e=this._history[this._historyIndex];if(e.zoom!==t.zoom){this._traversalCall=2;let n=this._map.options.crs.scale(t.zoom);let i=this._map.options.crs.scale(e.zoom);let r=n/i;this._map.panBy([e.x*r-t.x,e.y*r-t.y],{animate:false});this._map.setZoom(e.zoom)}else{this._traversalCall=1;this._map.panBy([e.x-t.x,e.y-t.y])}this._updateNavigationControls();this.el._historyIndex=this._historyIndex}forward(){let t=this._history;let e=t[this._historyIndex];if(this._historyIndex<t.length-1){this._map.contextMenu.toggleContextMenuItem("Back","enabled");this._historyIndex++;let n=t[this._historyIndex];if(this._historyIndex===t.length-1){this._map.contextMenu.toggleContextMenuItem("Forward","disabled")}if(n.zoom!==e.zoom){this._traversalCall=2;let t=this._map.options.crs.scale(e.zoom);let i=this._map.options.crs.scale(n.zoom);let r=t/i;this._map.panBy([n.x*r-e.x,n.y*r-e.y],{animate:false});this._map.setZoom(n.zoom)}else{this._traversalCall=1;this._map.panBy([n.x-e.x,n.y-e.y])}this._updateNavigationControls();this.el._historyIndex=this._historyIndex}}reload(){if(this._history.length===0)return;let t=this._history[0];let e={zoom:this._map.getZoom(),x:this._map.getPixelBounds().getCenter().x,y:this._map.getPixelBounds().getCenter().y};this._history=[t];this._historyIndex=0;if(t.zoom!==e.zoom){this._traversalCall=2;let n=this._map.options.crs.scale(e.zoom);let i=this._map.options.crs.scale(t.zoom);let r=n/i;this._map.panBy([t.x*r-e.x,t.y*r-e.y],{animate:false});this._map.setZoom(t.zoom)}else{this._traversalCall=1;this._map.panBy([t.x-e.x,t.y-e.y])}this._updateNavigationControls();this.el._history=this._history;this.el._historyIndex=this._historyIndex;this._map.getContainer().focus()}_toggleFullScreen(){this._map.toggleFullscreen()}viewSource(){let t=new Blob([this._source],{type:"text/plain"}),e=URL.createObjectURL(t);window.open(e);URL.revokeObjectURL(e)}zoomTo(e,n,i){if(!this._map){console.warn("Map is not initialized. Cannot zoom to location.");return}const r=i!==undefined&&Number.isInteger(+i)?+i:this.zoom;const s=new t.LatLng(+e,+n);this._map.setView(s,r)}async whenProjectionDefined(t){return new Promise(((e,n)=>{if(window.M[t]){e(window.M[t])}else{n(new Error("Projection "+t+" is not defined"))}}))}defineCustomProjection(t){if(window.M&&window.M.defineCustomProjection){window.M.defineCustomProjection(t);const e=JSON.parse(t);return e.projection}else{throw new Error("MapML API not loaded")}}async whenReady(){return new Promise(((t,e)=>{let n,i;if(this.el._map){t()}else{let t=this.el;n=setInterval(r,200,t);i=setTimeout(s,5e3)}function r(e){if(e._map){clearInterval(n);clearTimeout(i);t()}}function s(){clearInterval(n);clearTimeout(i);e("Timeout reached waiting for map to be ready")}}))}async whenLayersReady(){let t=[];const e=this.el.querySelectorAll("map-layer");for(let n=0;n<e.length;n++){const i=e[n];if(i.whenReady){t.push(i.whenReady())}}return Promise.allSettled(t)}geojson2mapml(t,e={}){if(e.projection===undefined){e.projection=this.projection}let i=n.geojson2mapml(t,e);this.el.appendChild(i);return i}render(){return null}static get watchers(){return{controls:["controlsChanged"],_controlslist:["controlsListChanged"],projection:["projectionChanged"],static:["staticChanged"]}}};pe.style=de;var me=t.LayerGroup.extend({options:{zIndex:0,opacity:"1.0"},initialize:function(e,n,i){t.LayerGroup.prototype.initialize.call(this,null,i);if(e){this._href=e}this._layerEl=n;this._content=n.src?n.shadowRoot:n;t.setOptions(this,i);this._container=t.DomUtil.create("div","leaflet-layer");this.changeOpacity(this.options.opacity);t.DomUtil.addClass(this._container,"mapml-layer");this._initialize(this._content)},getContainer:function(){return this._container},setZIndex:function(t){this.options.zIndex=t;this._updateZIndex();return this},getHref:function(){return this._href??""},_updateZIndex:function(){if(this._container&&this.options.zIndex!==undefined&&this.options.zIndex!==null){this._container.style.zIndex=this.options.zIndex}},changeOpacity:function(t){this._container.style.opacity=t;this._layerEl._opacity=t;if(this._layerEl._opacitySlider)this._layerEl._opacitySlider.value=t},titleIsReadOnly(){return!!this._titleIsReadOnly},setName(t){if(!this.titleIsReadOnly()){this._title=t;this._layerEl._layerControlHTML.querySelector(".mapml-layer-item-name").innerHTML=t}},getName(){return this._title},onAdd:function(e){this.getPane().appendChild(this._container);t.LayerGroup.prototype.onAdd.call(this,e);this.setZIndex(this.options.zIndex);e.on("popupopen",this._attachSkipButtons,this)},_calculateBounds:function(){delete this.bounds;delete this.zoomBounds;let e,i;let r=["_staticTileLayer","_mapmlvectors","_extentLayer"];e=this._layerEl.src&&this._layerEl.shadowRoot.querySelector(":host > map-meta[name=extent][content]")?n.getBoundsFromMeta(this._layerEl.shadowRoot):this._layerEl.querySelector(":scope > map-meta[name=extent][content]")?n.getBoundsFromMeta(this._layerEl):undefined;i=this._layerEl.src&&this._layerEl.shadowRoot.querySelector(":host > map-meta[name=zoom][content]")?n.getZoomBoundsFromMeta(this._layerEl.shadowRoot):this._layerEl.querySelector(":scope > map-meta[name=zoom][content]")?n.getZoomBoundsFromMeta(this._layerEl):undefined;const s=this._layerEl.src?this._layerEl.shadowRoot.querySelectorAll("map-extent"):this._layerEl.querySelectorAll("map-extent");r.forEach((n=>{let r,o,a,c;if(i){r=i.maxZoom;o=i.minZoom;c=i.maxNativeZoom?i.maxNativeZoom:-Infinity;a=i.minNativeZoom?i.minNativeZoom:Infinity}if(n==="_extentLayer"&&s.length){for(let n=0;n<s.length;n++){if(s[n]._extentLayer?.bounds){let l=s[n]._extentLayer;if(!e){e=t.bounds(l.bounds.min,l.bounds.max)}else{e.extend(l.bounds)}if(l.zoomBounds){if(!i){i=l.zoomBounds}else{r=Math.max(r,l.zoomBounds.maxZoom);o=Math.min(o,l.zoomBounds.minZoom);c=Math.max(c,l.zoomBounds.maxNativeZoom);a=Math.min(a,l.zoomBounds.minNativeZoom);i.minZoom=o;i.maxZoom=r;i.minNativeZoom=a;i.maxNativeZoom=c}}}}}else if(n==="_mapmlvectors"){this.eachLayer((function(t){if(t instanceof l&&t.layerBounds){if(!e){e=t.layerBounds}else{e.extend(t.layerBounds)}}if(t instanceof l&&t.zoomBounds){if(!i){i=t.zoomBounds}else{r=Math.max(r,t.zoomBounds.maxZoom);o=Math.min(o,t.zoomBounds.minZoom);c=Math.max(c,t.zoomBounds.maxNativeZoom);a=Math.min(a,t.zoomBounds.minNativeZoom);i.minZoom=o;i.maxZoom=r;i.minNativeZoom=a;i.maxNativeZoom=c}}}))}else{this.eachLayer((t=>{if(t instanceof h){if(t.layerBounds){if(!e){e=t.layerBounds}else{e.extend(t.layerBounds)}}if(t.zoomBounds){r=Math.max(r,t.zoomBounds.maxZoom);o=Math.min(o,t.zoomBounds.minZoom);c=Math.max(c,t.zoomBounds.maxNativeZoom);a=Math.min(a,t.zoomBounds.minNativeZoom);i.minZoom=o;i.maxZoom=r;i.minNativeZoom=a;i.maxNativeZoom=c}}}))}}));if(e){this.bounds=e}else{let e=M[this.options.projection].options.bounds;this.bounds=t.bounds(e.min,e.max)}if(!i)i={};if(!i.minZoom){i.minZoom=0}if(!i.maxZoom){i.maxZoom=M[this.options.projection].options.resolutions.length-1}if(i.minNativeZoom===Infinity){i.minNativeZoom=i.minZoom}if(i.maxNativeZoom===-Infinity){i.maxNativeZoom=i.maxZoom}this.zoomBounds=i},onRemove:function(e){t.LayerGroup.prototype.onRemove.call(this,e);t.DomUtil.remove(this._container);e.off("popupopen",this._attachSkipButtons)},getAttribution:function(){return this.options.attribution},getBase:function(){return new URL(this._content.querySelector("map-base")?this._content.querySelector("map-base").getAttribute("href"):this._content.nodeName==="MAP-LAYER"||this._content.nodeName==="LAYER-"?this._content.baseURI:this._href,this._href).href},renderStyles:c,_initialize:function(){var e=this;e.getBase();var n=this._content;r();i();if(e._layerEl.parentElement){e._layerEl.parentElement._toggleControls()}function i(){if(n.querySelector("map-title")){e._title=n.querySelector("map-title").textContent.trim();e._titleIsReadOnly=true}else if(e._layerEl&&e._layerEl.hasAttribute("label")){e._title=e._layerEl.getAttribute("label").trim()}}function r(){var i=n.querySelector("map-link[rel=license]"),r,s,o;if(i){r=i.getAttribute("title");s=i.getAttribute("href");o='<a href="'+s+'" title="'+r+'">'+r+"</a>"}t.setOptions(e,{attribution:o});var l=n.querySelector("map-link[rel=legend]");if(l){e._legendUrl=l.getAttribute("href")}if(e._map){if(e._map.hasLayer(e)){e._map.attributionControl.addAttribution(e.getAttribution())}}}},getQueryTemplates:function(t,e){const n=this._layerEl.querySelectorAll("map-extent[checked] map-link[rel=query]").length?this._layerEl.querySelectorAll("map-extent[checked] map-link[rel=query]"):this._layerEl.shadowRoot.querySelectorAll("map-extent[checked] map-link[rel=query]").length?this._layerEl.shadowRoot.querySelectorAll("map-extent[checked] map-link[rel=query]"):null;if(n){var i=[];for(let r=0;r<n.length;r++){const s=n[r].extent.zoom.minZoom,o=n[r].extent.zoom.maxZoom,l=t=>s<=t&&t<=o,a=n[r].getBounds();if(a.contains(t)&&l(e)){i.push(n[r]._templateVars)}}return i}},_attachSkipButtons:function(e){let n=e.popup,i=e.target,r,s,o=n._container.getElementsByClassName("mapml-popup-content")[0];n._container.setAttribute("role","dialog");o.setAttribute("tabindex","-1");o.setAttribute("role","document");n._count=0;if(n._source._eventParents){r=n._source._eventParents[Object.keys(n._source._eventParents)[0]];s=n._source.group;b.call(n)}else{const t=n._source._layerEl.querySelector("map-extent")||n._source._layerEl.shadowRoot.querySelector("map-extent");r=t._extentLayer;i.on("attachZoomLink",b,n)}if(n._container.querySelector('nav[class="mapml-focus-buttons"]')){t.DomUtil.remove(n._container.querySelector('nav[class="mapml-focus-buttons"]'));t.DomUtil.remove(n._container.querySelector("hr"))}let l=t.DomUtil.create("nav","mapml-focus-buttons");let a=t.DomUtil.create("button","mapml-popup-button",l);a.type="button";a.title=i.options.mapEl.locale.kbdFocusMap;a.innerHTML="<span aria-hidden='true'>|&#10094;</span>";t.DomEvent.on(a,"click",(e=>{t.DomEvent.stop(e);i.featureIndex._sortIndex();i.closePopup();i._container.focus()}),n);let h=t.DomUtil.create("button","mapml-popup-button",l);h.type="button";h.title=i.options.mapEl.locale.kbdPrevFeature;h.innerHTML="<span aria-hidden='true'>&#10094;</span>";t.DomEvent.on(h,"click",r._previousFeature,n);let c=t.DomUtil.create("p","mapml-feature-count",l),f=this._totalFeatureCount?this._totalFeatureCount:1;c.innerText=n._count+1+"/"+f;let u=t.DomUtil.create("button","mapml-popup-button",l);u.type="button";u.title=i.options.mapEl.locale.kbdNextFeature;u.innerHTML="<span aria-hidden='true'>&#10095;</span>";t.DomEvent.on(u,"click",r._nextFeature,n);let d=t.DomUtil.create("button","mapml-popup-button",l);d.type="button";d.title=i.options.mapEl.locale.kbdFocusControls;d.innerHTML="<span aria-hidden='true'>&#10095;|</span>";t.DomEvent.on(d,"click",(e=>{i.featureIndex._sortIndex();i.featureIndex.currentIndex=i.featureIndex.inBoundFeatures.length-1;i.featureIndex.inBoundFeatures[0]?.path.setAttribute("tabindex",-1);i.featureIndex.inBoundFeatures[i.featureIndex.currentIndex]?.path.setAttribute("tabindex",0);t.DomEvent.stop(e);i.closePopup();i._controlContainer.querySelector("A:not([hidden])").focus()}),n);let p=t.DomUtil.create("hr","mapml-popup-divider");n._navigationBar=l;n._content.parentElement.parentElement.appendChild(p);n._content.parentElement.parentElement.appendChild(l);o.focus();if(s&&!M.options.featureIndexOverlayOption){s.setAttribute("aria-expanded","true");i.on("keydown",m)}else{i.on("keydown",g)}function m(e){let r=e.originalEvent.path||e.originalEvent.composedPath();let o=e.originalEvent.keyCode===9,l=e.originalEvent.shiftKey;if(r[0].classList.contains("leaflet-popup-close-button")&&o&&!l||e.originalEvent.keyCode===27||r[0].classList.contains("leaflet-popup-close-button")&&e.originalEvent.keyCode===13){setTimeout((()=>{i.closePopup(n);s.focus();t.DomEvent.stop(e)}),0)}else if(r[0].classList.contains("mapml-popup-content")&&o&&l){setTimeout((()=>{i.closePopup(n);s.focus();t.DomEvent.stop(e)}),0)}else if(r[0]===n._content.querySelector("a")&&o&&l){setTimeout((()=>{i.closePopup(n);s.focus();t.DomEvent.stop(e)}),0)}}function g(e){let r=e.originalEvent.path||e.originalEvent.composedPath();let s=e.originalEvent.keyCode===9,o=e.originalEvent.shiftKey;if(e.originalEvent.keyCode===13&&r[0].classList.contains("leaflet-popup-close-button")||e.originalEvent.keyCode===27){t.DomEvent.stopPropagation(e);i.closePopup(n);i._container.focus();if(e.originalEvent.keyCode!==27)i._popupClosed=true}else if(s&&r[0].classList.contains("leaflet-popup-close-button")){i.closePopup(n)}else if(r[0].classList.contains("mapml-popup-content")&&s&&o){i.closePopup(n);setTimeout((()=>{t.DomEvent.stop(e);i._container.focus()}),0)}else if(r[0]===n._content.querySelector("a")&&s&&o){i.closePopup(n);setTimeout((()=>{t.DomEvent.stop(e);i.getContainer.focus()}),0)}}function b(e){let n=this._wrapper,r=e?e.currFeature:this._source._groupLayer._featureEl;if(n.querySelector("a.mapml-zoom-link")){n.querySelector("a.mapml-zoom-link").remove()}if(!r.querySelector("map-geometry"))return;let s=r.extent.topLeft.gcrs,o=r.extent.bottomRight.gcrs,l=t.latLngBounds(t.latLng(s.horizontal,s.vertical),t.latLng(o.horizontal,o.vertical)).getCenter(true);let a=document.createElement("a");a.href=`#${r.getZoomToZoom()},${l.lng},${l.lat}`;a.innerHTML=`${i.options.mapEl.locale.popupZoom}`;a.className="mapml-zoom-link";a.onclick=a.onkeydown=function(t){if(!(t instanceof MouseEvent)&&t.keyCode!==13)return;t.preventDefault();r.zoomTo();i.closePopup();i.getContainer().focus()};let h=n.querySelector(".mapml-zoom-link");if(h)h.remove();n.insertBefore(a,n.querySelector("hr.mapml-popup-divider"))}i.on("popupclose",v);function v(t){if(t.popup===n){i.off("keydown",m);i.off("keydown",g);i.off("popupopen",b);i.off("popupclose",v);if(s)s.setAttribute("aria-expanded","false")}}}});var ge=function(t,e,n){if(!t&&!e)return null;return new me(t,e,n)};var be=async function(){var e=t.DomUtil.create("fieldset","mapml-layer-item"),n=t.DomUtil.create("input"),i=t.DomUtil.create("span","mapml-layer-item-name"),r=t.DomUtil.create("span"),s=t.DomUtil.create("div","mapml-layer-item-properties",e),o=t.DomUtil.create("div","mapml-layer-item-settings",e),l=t.DomUtil.create("label","mapml-layer-item-toggle",s),a=t.DomUtil.create("div","mapml-layer-item-controls",s),h=t.DomUtil.create("details","mapml-layer-item-opacity mapml-control-layers",o),c=t.DomUtil.create("input"),f=t.DomUtil.create("summary"),u=t.SVG.create("svg"),d=t.SVG.create("path"),p=t.SVG.create("path"),m=t.DomUtil.create("fieldset","mapml-layer-grouped-extents"),g=this.parentNode;c.setAttribute("data-testid","layer-item-opacity");u.setAttribute("viewBox","0 0 24 24");u.setAttribute("height","22");u.setAttribute("width","22");u.setAttribute("fill","currentColor");d.setAttribute("d","M0 0h24v24H0z");d.setAttribute("fill","none");p.setAttribute("d","M12 8c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zm0 2c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm0 6c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z");u.appendChild(d);u.appendChild(p);o.hidden=true;r.setAttribute("aria-hidden",true);let b=t.DomUtil.create("button","mapml-layer-item-remove-control",a);b.type="button";b.title=g.locale.lmRemoveLayer;b.innerHTML="<span aria-hidden='true'>&#10005;</span>";b.classList.add("mapml-button");t.DomEvent.on(b,"click",t.DomEvent.stop);t.DomEvent.on(b,"click",(t=>{let e=0,n,i;i=g.tagName==="GCDS-MAP"?g.shadowRoot:g.querySelector(".mapml-web-map").shadowRoot;if(t.target.closest("fieldset").nextElementSibling&&!t.target.closest("fieldset").nextElementSibling.disbaled){n=t.target.closest("fieldset").previousElementSibling;while(n){e+=2;n=n.previousElementSibling}}else{n="link"}g.removeChild(t.target.closest("fieldset").querySelector("span").layer._layerEl);n=n?i.querySelector(".leaflet-control-attribution").firstElementChild:n=i.querySelectorAll("input")[e];n.focus()}),this._layer);let v=t.DomUtil.create("button","mapml-layer-item-settings-control",a);v.type="button";v.title=g.locale.lmLayerSettings;v.setAttribute("aria-expanded",false);v.classList.add("mapml-button");t.DomEvent.on(v,"click",(t=>{let e=this._layer._layerEl._layerControl._container;if(!e._isExpanded&&t.pointerType==="touch"){e._isExpanded=true;return}if(o.hidden===true){v.setAttribute("aria-expanded",true);o.hidden=false}else{v.setAttribute("aria-expanded",false);o.hidden=true}}),this._layer);n.defaultChecked=this.checked;n.type="checkbox";n.setAttribute("class","leaflet-control-layers-selector");n.setAttribute("data-testid","layer-item-checkbox");i.layer=this._layer;const w=function(){this.checked=!this.checked;this.dispatchEvent(new CustomEvent("map-change"));this._layerControlCheckbox.focus()};n.addEventListener("change",w.bind(this));if(this._layer._legendUrl){var x=document.createElement("a");x.text=" "+this._layer._title;x.href=this._layer._legendUrl;x.target="_blank";x.draggable=false;i.appendChild(x)}else{i.innerHTML=this._layer._title}i.id="mapml-layer-item-name-{"+t.stamp(i)+"}";f.innerText=g.locale.lcOpacity;f.id="mapml-layer-item-opacity-"+t.stamp(f);h.appendChild(f);h.appendChild(c);c.setAttribute("type","range");c.setAttribute("min","0");c.setAttribute("max","1.0");c.setAttribute("value",this._opacity||"1.0");c.setAttribute("step","0.1");c.setAttribute("aria-labelledby","mapml-layer-item-opacity-"+t.stamp(f));const y=function(t){if(t&&t.target&&t.target.value>=0&&t.target.value<=1){this._layer.changeOpacity(t.target.value)}};c.value=this._opacity||"1.0";c.addEventListener("change",y.bind(this));e.setAttribute("aria-grabbed","false");e.setAttribute("aria-labelledby",i.id);e.ontouchstart=e.onmousedown=t=>{if(t.target.parentElement.tagName.toLowerCase()==="label"&&t.target.tagName.toLowerCase()!=="input"||t.target.tagName.toLowerCase()==="label"){t=t instanceof TouchEvent?t.touches[0]:t;let n=e,i=e.parentNode,r=false,s=t.clientY,o=Array.from(i.querySelectorAll("fieldset")).indexOf(e);document.body.ontouchmove=document.body.onmousemove=t=>{t.preventDefault();t=t instanceof TouchEvent?t.touches[0]:t;let e=t.clientY-s;r=Math.abs(e)>15||r;if(i&&!r||i&&i.childElementCount<=1||i.getBoundingClientRect().top>n.getBoundingClientRect().bottom||i.getBoundingClientRect().bottom<n.getBoundingClientRect().top){return}i.classList.add("mapml-draggable");n.style.transform="translateY("+e+"px)";n.style.pointerEvents="none";let o=t.clientX,l=t.clientY,a=g.tagName==="GCDS-MAP"?g.shadowRoot:g.querySelector(".mapml-web-map").shadowRoot,h=a.elementFromPoint(o,l),c=!h||!h.closest("fieldset")?n:h.closest("fieldset");c=Math.abs(e)<=c.offsetHeight?n:c;n.setAttribute("aria-grabbed","true");n.setAttribute("aria-dropeffect","move");if(c&&i===c.parentNode){c=c!==n.nextSibling?c:c.nextSibling;if(n!==c){s=t.clientY;n.style.transform=null}i.insertBefore(n,c)}};document.body.ontouchend=document.body.onmouseup=()=>{let t=Array.from(i.querySelectorAll("fieldset")).indexOf(e);n.setAttribute("aria-grabbed","false");n.removeAttribute("aria-dropeffect");n.style.pointerEvents=null;n.style.transform=null;if(o!==t){let t=i.children,e=1;for(let e of t){let t=e.querySelector("span").layer._layerEl;t.setAttribute("data-moving","");g.insertAdjacentElement("beforeend",t);t.removeAttribute("data-moving")}let n=g.querySelectorAll("map-layer,layer-");for(let t=0;t<n.length;t++){let i=n[t]._layer;if(i.options.zIndex!==e){i.setZIndex(e)}e++}}i.classList.remove("mapml-draggable");document.body.ontouchmove=document.body.onmousemove=document.body.onmouseup=null}}};l.appendChild(n);l.appendChild(i);v.appendChild(r);r.appendChild(u);let k=this.src?this.shadowRoot:this;var _=k.querySelectorAll('map-link[rel=style],map-link[rel="self style"],map-link[rel="style self"]');let z;if(_){z=this.getAlternateStyles(_);if(z){o.appendChild(z)}}this._layerControlCheckbox=n;this._layerControlLabel=l;this._opacityControl=h;this._opacitySlider=c;this._layerControlHTML=e;this._layerItemSettingsHTML=o;this._propertiesGroupAnatomy=m;this._styles=z;m.setAttribute("aria-label","Sublayers");m.setAttribute("hidden","");let M=k.querySelectorAll("map-extent:not([hidden])");let C=[];for(let t=0;t<M.length;t++){C.push(M[t].whenReady());m.removeAttribute("hidden")}await Promise.all(C);for(let t=0;t<M.length;t++){m.appendChild(M[t].getLayerControlHTML())}o.appendChild(m);return this._layerControlHTML};const ve=class{constructor(t){i(this,t)}get el(){return r(this)}src;checked;hidden=false;opacity=1;_opacity;media;get opacityValue(){return this._opacity??this.opacity??1}_layer;_layerControl;_layerControlHTML;_layerItemSettingsHTML;_propertiesGroupAnatomy;disabled=false;_fetchError=false;_layerRegistry=new Map;srcChanged(t,e){if(e!==t){this._onRemove();if(this.el.isConnected){this._onAdd()}}}checkedChanged(t){if(this._layer){const e=this.getMapEl();if(e&&e._map){const n=e._map;if(t){n.addLayer(this._layer)}else{n.removeLayer(this._layer)}}if(this._layerControlCheckbox){this._layerControlCheckbox.checked=t}}}opacityChanged(t,e){if(e!==t&&this._layer){this._opacity=t;this._layer.changeOpacity(t);if(this._opacitySlider){this._opacitySlider.value=t.toString()}}}mediaChanged(t,e){if(e!==t){this._registerMediaQuery(t)}}hiddenChanged(t,e){if(e!==t&&this._layer&&this._layerControl){this._applyHiddenState(t)}}_applyHiddenState(t){if(!this._layer||!this._layerControl)return;if(t){this._layerControl.removeLayer(this._layer)}else{this._layerControl.addOrUpdateOverlay(this._layer,this.label);this._validateDisabled()}}loggedMessages;_observer;_mql;_changeHandler;_boundCreateLayerControlHTML;_layerControlCheckbox;_layerControlLabel;_opacityControl;_opacitySlider;_styles;get label(){if(this._layer)return this._layer.getName();else return this.el.hasAttribute("label")?this.el.getAttribute("label"):""}set label(t){if(t){this.el.setAttribute("label",t);if(this._layer)this._layer.setName(t)}}get extent(){if(this._layer){this._layer._calculateBounds()}return this._layer?Object.assign(n._convertAndFormatPCRS(this._layer.bounds,window.M[this.getProjection()],this.getProjection()),{zoom:this._layer.zoomBounds}):null}_registerMediaQuery(t){if(!this._changeHandler){this._changeHandler=()=>{this._onRemove();if(this._mql.matches){this._onAdd()}this._validateDisabled()}}if(t){let e=this.getMapEl();if(!e)return;if(this._mql){this._mql.removeEventListener("change",this._changeHandler)}this._mql=e.matchMedia(t);this._changeHandler();this._mql.addEventListener("change",this._changeHandler)}else if(this._mql){this._mql.removeEventListener("change",this._changeHandler);delete this._mql;this._onRemove();this._onAdd();this._validateDisabled()}}getMapEl(){return n.getClosest(this.el,"gcds-map")}componentWillLoad(){this.loggedMessages=new Set;Object.defineProperty(this.el,"queryable",{value:()=>this.queryable(),writable:true,configurable:true})}disconnectedCallback(){if(this.el.hasAttribute("data-moving"))return;this._onRemove();if(this._mql){if(this._changeHandler){this._mql.removeEventListener("change",this._changeHandler)}delete this._mql}}_onRemove(){if(this._observer){this._observer.disconnect()}let t=this._layer,e=this._layerControl;if(t){t.off()}if(t&&t._map){t._map.removeLayer(t)}if(e&&!this.el.hasAttribute("hidden")){e.removeLayer(t)}delete this._layer;delete this._layerControl;delete this._layerControlHTML;delete this._fetchError;delete this.el._layer;delete this.el._layerControl;delete this.el._layerControlHTML;delete this.el._fetchError;this._layerControlCheckbox=undefined;this._layerControlLabel=undefined;this._opacityControl=undefined;this._opacitySlider=undefined;this._styles=undefined;this.el.shadowRoot.innerHTML="";if(this.src)this.el.innerHTML="";this._layerRegistry.clear()}connectedCallback(){if(this.el.hasAttribute("data-moving"))return;this._boundCreateLayerControlHTML=be.bind(this.el);this.el._validateDisabled=this._validateDisabled.bind(this);Object.defineProperty(this.el,"disabled",{get:()=>this.disabled,set:t=>{this.disabled=t},configurable:true,enumerable:true});Object.defineProperty(this.el,"_opacity",{get:()=>this._opacity,set:t=>{if(t!==this._opacity){this._opacity=t}},configurable:true,enumerable:true});Object.defineProperty(this.el,"opacity",{get:()=>this.opacityValue,set:t=>{if(+t>1||+t<0)return;this._opacity=t;this._layer?.changeOpacity(t)},configurable:true,enumerable:true});Object.defineProperty(this.el,"whenElemsReady",{value:()=>this.whenElemsReady(),writable:true,configurable:true});Object.defineProperty(this.el,"zoomTo",{value:()=>this.zoomTo(),writable:true,configurable:true});Object.defineProperty(this.el,"mapml2geojson",{value:(t={})=>this.mapml2geojson(t),writable:true,configurable:true});Object.defineProperty(this.el,"pasteFeature",{value:t=>this.pasteFeature(t),writable:true,configurable:true});Object.defineProperty(this.el,"getAlternateStyles",{value:t=>this.getAlternateStyles(t),writable:true,configurable:true});Object.defineProperty(this.el,"getOuterHTML",{value:()=>this.getOuterHTML(),writable:true,configurable:true});Object.defineProperty(this.el,"getMapEl",{value:()=>this.getMapEl(),writable:true,configurable:true});Object.defineProperty(this.el,"getProjection",{value:()=>this.getProjection(),writable:true,configurable:true});Object.defineProperty(this.el,"label",{get:()=>this.label,set:t=>this.label=t,configurable:true,enumerable:true});Object.defineProperty(this.el,"hidden",{get:()=>this.el.hasAttribute("hidden"),set:t=>{if(t){this.el.setAttribute("hidden","")}else{this.el.removeAttribute("hidden")}},configurable:true,enumerable:true});Object.defineProperty(this.el,"extent",{get:()=>this.extent,configurable:true,enumerable:true});this.el._layerRegistry=this._layerRegistry;const t=this._onAdd.bind(this);const e=this._onRemove.bind(this);const n=this._registerMediaQuery.bind(this);let i=this.media;this.getMapEl().whenReady().then((()=>{e();if(i){n(i)}else{t()}})).catch((t=>{throw new Error("Map never became ready: "+t)}))}_onAdd(){new Promise(((t,e)=>{this.el.addEventListener("changestyle",(t=>{t.stopPropagation();if(t.detail){this.src=t.detail.src}}),{once:true});let n=this.el.baseURI?this.el.baseURI:document.baseURI;const i=new Headers;i.append("Accept","text/mapml");if(this.src){fetch(this.src,{headers:i}).then((t=>{if(!t.ok){throw new Error(`HTTP error! Status: ${t.status}`)}const e=t.url;return t.text().then((t=>({text:t,url:e})))})).then((({text:t,url:e})=>{let n=(new DOMParser).parseFromString(t,"text/xml");if(n.querySelector("parsererror")||!n.querySelector("mapml-")){this._fetchError=true;this.el._fetchError=this._fetchError;console.log("Error fetching layer content:\n\n"+t+"\n");throw new Error("Parser error")}n._sourceUrl=e;return n})).then((t=>{this._copyRemoteContentToShadowRoot(t.querySelector("mapml-"),t._sourceUrl);this._copyRemoteContentToShadowRoot(t.querySelector("mapml-"));let e=this.el.shadowRoot.querySelectorAll("*");let n=[];for(let t=0;t<e.length;t++){if(e[t].whenReady){n.push(e[t].whenReady().catch((n=>{console.warn(`Element ${e[t].tagName} failed to become ready:`,n);return null})))}}return Promise.allSettled(n)})).then((()=>{this._selectAlternateOrChangeProjection()})).then((()=>{this._layer=ge(new URL(this.src,n).href,this.el,{projection:this.getProjection(),opacity:this.opacityValue});this.el._layer=this._layer;this._createLayerControlHTML();this._setLocalizedDefaultLabel();this._attachedToMap();this._runMutationObserver(this.el.shadowRoot.children);this._bindMutationObserver();this._validateDisabled();this.el.dispatchEvent(new CustomEvent("loadedmetadata",{detail:{target:this.el}}));t(undefined)})).catch((t=>{e(t)}))}else{let n=this.el.querySelectorAll("*");let i=[];for(let t=0;t<n.length;t++){if(n[t].whenReady)i.push(n[t].whenReady())}Promise.allSettled(i).then((()=>{this._selectAlternateOrChangeProjection()})).then((()=>{this._layer=ge(null,this.el,{projection:this.getProjection(),opacity:this.opacityValue});this.el._layer=this._layer;this._createLayerControlHTML();this._setLocalizedDefaultLabel();this._attachedToMap();this._runMutationObserver(this.el.children);this._bindMutationObserver();this._validateDisabled();this.el.dispatchEvent(new CustomEvent("loadedmetadata",{detail:{target:this.el}}));t(undefined)})).catch((t=>{e(t)}))}})).catch((t=>{if(t.message==="changeprojection"){if(t.cause.href){console.log("Changing layer src to: "+t.cause.href);this.src=t.cause.href}else if(t.cause.mapprojection){console.log("Changing map projection to match layer: "+t.cause.mapprojection);const e=this.getMapEl();if(e){e.projection=t.cause.mapprojection}}}else if(t.message==="Failed to fetch"){this._fetchError=true;this.el._fetchError=this._fetchError}else{console.log(t);this.el.dispatchEvent(new CustomEvent("error",{detail:{target:this.el}}))}}))}_setLocalizedDefaultLabel(){if(!this._layer?._titleIsReadOnly&&!this._layer?._title){const t=this.getMapEl();if(t&&t.locale?.dfLayer){this.label=t.locale.dfLayer}}}_selectAlternateOrChangeProjection(){const t=this.src?this.el.shadowRoot:this.el;const e=this.getMapEl();if(!t||!e)return;const n=this.getProjection()!==e.projection&&t.querySelector("map-link[rel=alternate][projection="+e.projection+"][href]");if(n){let e;const i=t.querySelector("map-base[href]");if(i){e=i.getAttribute("href")}else if(this.src){e=new URL(this.src,this.el.baseURI||document.baseURI).href}else{e=this.el.baseURI||document.baseURI}const r=new URL(n.getAttribute("href"),e).href;throw new Error("changeprojection",{cause:{href:r}})}const i=this.getProjection();if(i!==e.projection&&e.layers?.length===1){throw new Error("changeprojection",{cause:{mapprojection:i}})}}_copyRemoteContentToShadowRoot(t,e){const n=this.el.shadowRoot;if(!n||!t)return;const i=document.createDocumentFragment();const r=t.querySelectorAll("map-head > *, map-body > *");let s=Array.from(r).find((t=>t.nodeName==="MAP-BASE"));if(!s&&e){s=document.createElement("map-base");s.setAttribute("href",e);i.appendChild(s)}else if(s&&e){const t=new URL(s.getAttribute("href")||"",e).href;s.setAttribute("href",t)}for(let t=0;t<r.length;t++){i.appendChild(r[t])}n.appendChild(i)}getProjection(){let t=this.src?this.el.shadowRoot:this.el;let e=this.getMapEl().projection;if(t.querySelector("map-meta[name=projection][content]")){e=n._metaContentToObject(t.querySelector("map-meta[name=projection]").getAttribute("content")).content||e}else if(t.querySelector("map-extent[units]")){const n=t=>{let e=t[0].attributes.units.value;let n=true;for(let i=0;i<t.length;i++){if(e!==t[i].attributes.units.value){n=false}}return n?e:null};e=n(Array.from(t.querySelectorAll("map-extent[units]")))||e}else{const t=this.el.querySelector("map-title");const e=this.label||(t?t.textContent:"Unnamed");const n=`A projection was not assigned to the '${e}' Layer. \nPlease specify a projection for that layer using a map-meta element. \nSee more here - https://maps4html.org/web-map-doc/docs/elements/meta/`;if(!this.loggedMessages.has(n)){console.log(n);this.loggedMessages.add(n)}}return e}_attachedToMap(){const e=this.getMapEl();if(!e||!this._layer)return;let n=0;let i=1;const r=e.children;for(n=0;n<r.length;n++){if(r[n].nodeName==="MAP-LAYER"||r[n].nodeName==="LAYER-"){if(r[n]===this.el){i=n+1}else if(r[n]._layer){r[n]._layer.setZIndex(n+1)}}}const s=e.projection?e.projection:"OSMTILE";t.setOptions(this._layer,{zIndex:i,mapprojection:s,opacity:window.getComputedStyle(this.el).opacity});if(this.checked){this._layer.addTo(e._map)}e._map.on("moveend layeradd",this._validateDisabled,this);this._layer.on("add remove",this._validateDisabled,this);if(e._layerControl){this._layerControl=e._layerControl;this.el._layerControl=this._layerControl}if(e._layerControl&&!this.hidden){this._layerControl.addOrUpdateOverlay(this._layer,this.label)}if(this._layer._legendUrl){this.el.legendLinks=[{type:"application/octet-stream",href:this._layer._legendUrl,rel:"legend",lang:null,hreflang:null,sizes:null}]}}_runMutationObserver(t){const e=t=>{this.whenReady().then((()=>{this._layer.renderStyles(t)}))};const n=t=>{this.whenReady().then((()=>{this._layer.renderStyles(t)}))};const i=t=>{this.whenReady().then((()=>{if(typeof t.whenReady==="function"){t.whenReady().then((()=>{delete this._layer.bounds;this._layer._calculateBounds();this._validateDisabled()}))}else{delete this._layer.bounds;this._layer._calculateBounds();this._validateDisabled()}}))};const r=this.src?this.el.shadowRoot:this.el;const s=r instanceof ShadowRoot?":host":":scope";const o=t=>{this.whenReady().then((()=>{this._layer._calculateBounds();this._validateDisabled()}))};for(let l=0;l<t.length;++l){const a=t[l];switch(a.nodeName){case"MAP-LINK":if(a.link&&!a.link.isConnected)e(a);break;case"MAP-STYLE":if(a.styleElement&&!a.styleElement.isConnected){n(a)}break;case"MAP-EXTENT":i(a);break;case"MAP-META":const t=a.hasAttribute("name")&&(a.getAttribute("name").toLowerCase()==="zoom"||a.getAttribute("name").toLowerCase()==="extent");if(t&&a===r.querySelector(`${s} > [name=${a.getAttribute("name")}]`)&&a.hasAttribute("content")){o()}break}}}_bindMutationObserver(){this._observer=new MutationObserver((t=>{for(let e of t){if(e.type==="childList"){this._runMutationObserver(e.addedNodes)}}}));this._observer.observe(this.src?this.el.shadowRoot:this.el,{childList:true})}_validateDisabled(){const t=()=>{let t=0;let e=0;this._layer.eachLayer((n=>{if(n instanceof h){t++;if(!n.isVisible())e++}}));return{totalCount:t,disabledCount:e}};const e=()=>{let t=0;let e=0;this._layer.eachLayer((n=>{if(n instanceof l){t++;if(!n.isVisible())e++}}));return{totalCount:t,disabledCount:e}};setTimeout((()=>{let n=this._layer,i=n?._map;if(this._mql&&!this._mql.matches){this.el.setAttribute("disabled","");this.disabled=true;return}if(i){const n=this.src?this.el.shadowRoot?.querySelectorAll("map-extent"):this.el.querySelectorAll("map-extent");let i=[];if(n){for(let t=0;t<n.length;t++){if(n[t].whenLinksReady){i.push(n[t].whenLinksReady())}}}Promise.allSettled(i).then((()=>{let i=0,r=0,s=["_staticTileLayer","_mapmlvectors","_extentLayer"];for(let o=0;o<s.length;o++){let l=s[o];if(this.checked){if(l==="_extentLayer"&&n&&n.length>0){for(let t=0;t<n.length;t++){r++;if(n[t]._validateDisabled&&n[t]._validateDisabled())i++}}else if(l==="_mapmlvectors"){const t=e();r+=t.totalCount;i+=t.disabledCount}else{const e=t();r+=e.totalCount;i+=e.disabledCount}}}if(i===r&&i!==0){this.el.setAttribute("disabled","");this.disabled=true}else{this.el.removeAttribute("disabled");this.disabled=false}this.toggleLayerControlDisabled()})).catch((t=>{console.log(t)}))}}),0)}toggleLayerControlDisabled(){let t=this._layerControlCheckbox,e=this._layerControlLabel,n=this._opacityControl,i=this._opacitySlider,r=this._styles;if(this.disabled){if(t)t.disabled=true;if(i)i.disabled=true;if(e)e.style.fontStyle="italic";if(n)n.style.fontStyle="italic";if(r){r.style.fontStyle="italic";r.querySelectorAll("input").forEach((t=>{t.disabled=true}))}}else{if(t)t.disabled=false;if(i)i.disabled=false;if(e)e.style.fontStyle="normal";if(n)n.style.fontStyle="normal";if(r){r.style.fontStyle="normal";r.querySelectorAll("input").forEach((t=>{t.disabled=false}))}}}queryable(){let t=this.src?this.el.shadowRoot:this.el;return!!(t?.querySelector("map-extent[checked] > map-link[rel=query]:not([disabled])")&&this.checked&&this._layer&&!this.el.hasAttribute("hidden"))}getAlternateStyles(e){if(e.length>1){const n=document.createElement("details");const i=document.createElement("summary");const r=this.getMapEl();i.innerText=r?.locale?.lmStyle||"Style";n.appendChild(i);for(let i=0;i<e.length;i++){n.appendChild(e[i].getLayerControlOption());t.DomUtil.addClass(n,"mapml-layer-item-style mapml-control-layers")}return n}return null}getOuterHTML(){let t=this.el.cloneNode(true);if(this.el.hasAttribute("src")){let e=this._layer.getHref();t.setAttribute("src",e)}if(this.el.querySelector("map-link")){let e=t.querySelectorAll("map-link");e.forEach((t=>{if(t.hasAttribute("href")){t.setAttribute("href",decodeURI(new URL(t.getAttribute("href"),this.el.baseURI?this.el.baseURI:document.baseURI).href))}else if(t.hasAttribute("tref")){t.setAttribute("tref",decodeURI(new URL(t.getAttribute("tref"),this.el.baseURI?this.el.baseURI:document.baseURI).href))}}))}let e=t.outerHTML;t.remove();return e}zoomTo(){this.whenReady().then((()=>{let e=this.getMapEl()?._map,i=this.extent,r=i.topLeft.pcrs,s=i.bottomRight.pcrs,o=t.bounds(t.point(r.horizontal,r.vertical),t.point(s.horizontal,s.vertical)),l=e.options.crs.unproject(o.getCenter(true));let a=i.zoom.maxZoom,h=i.zoom.minZoom;e.setView(l,n.getMaxZoom(o,e,h,a),{animate:false})}))}pasteFeature(t){switch(typeof t){case"string":t.trim();if(t.slice(0,12)==="<map-feature"&&t.slice(-14)==="</map-feature>"){this.el.insertAdjacentHTML("beforeend",t)}break;case"object":if(t.nodeName?.toUpperCase()==="MAP-FEATURE"){this.el.appendChild(t)}}}_createLayerControlHTML(){if(this._boundCreateLayerControlHTML){this._boundCreateLayerControlHTML().then((t=>{this._layerControlHTML=t;this.el._layerControlHTML=this._layerControlHTML;this._layerControlCheckbox=this.el._layerControlCheckbox;this._layerControlLabel=this.el._layerControlLabel;this._opacityControl=this.el._opacityControl;this._opacitySlider=this.el._opacitySlider;this._layerItemSettingsHTML=this.el._layerItemSettingsHTML;this._propertiesGroupAnatomy=this.el._propertiesGroupAnatomy;this._styles=this.el._styles;if(this._opacitySlider&&this._opacity!==undefined){this._opacitySlider.value=this._opacity.toString()}}))}}async whenReady(){return new Promise(((t,e)=>{let n,i;if(this.el._layer&&this._layerControlHTML&&(!this.src||this.el.shadowRoot?.childNodes.length)){t()}else{const t=this.el;n=setInterval(r,200,t);i=setTimeout(s,5e3)}function r(r){if(r._layer&&r._layerControlHTML&&(!r.src||r.shadowRoot?.childNodes.length)){clearInterval(n);clearTimeout(i);t()}else if(r._fetchError){clearInterval(n);clearTimeout(i);e("Error fetching layer content")}}function s(){clearInterval(n);clearTimeout(i);e("Timeout reached waiting for layer to be ready")}}))}async whenElemsReady(){let t=[];let e=this.src?this.el.shadowRoot:this.el;if(!e)return[];const n=Array.from(e.querySelectorAll("map-extent"));const i=Array.from(e.querySelectorAll("map-feature"));for(let e of[...n,...i]){if(typeof e.whenReady==="function"){t.push(e.whenReady())}}return Promise.allSettled(t)}mapml2geojson(t={}){return n.mapml2geojson(this.el,t)}render(){return null}static get watchers(){return{src:["srcChanged"],checked:["checkedChanged"],_opacity:["opacityChanged"],media:["mediaChanged"],hidden:["hiddenChanged"]}}};export{pe as gcds_map,ve as map_layer};
//# sourceMappingURL=p-2a3959f3.entry.js.map