"use strict";(self.webpackChunkgcds_map=self.webpackChunkgcds_map||[]).push([[301],{"./dist/esm/calculatePosition-B4YLD_Og.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{function calculatePosition(element){const tagName=element.tagName.toLowerCase(),validTags=["map-tile","map-extent","map-feature"];if(!validTags.includes(tagName))return console.warn(`calculatePosition: Invalid element type ${tagName}`),0;const parent=element.parentNode;if(!parent)return 1;const children=parent.children||Array.from(parent.childNodes).filter(node=>node.nodeType===Node.ELEMENT_NODE);if(!children||0===children.length)return 1;let position=0,lastTag=null,foundTarget=!1;for(const child of children){if(child.nodeType!==Node.ELEMENT_NODE)continue;const childTag=child.tagName.toLowerCase();if(validTags.includes(childTag)){if(child===element)return foundTarget=!0,"map-extent"===childTag?(position++,position):(lastTag===childTag||position++,position);foundTarget||("map-extent"===childTag||null!==lastTag&&lastTag!==childTag?position++:null===lastTag&&(position=1),lastTag=childTag)}}return 0}__webpack_require__.d(__webpack_exports__,{c:()=>calculatePosition})},"./dist/esm/map-extent.entry.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{map_extent:()=>GcdsMapExtent});var _index_PZrWUcjo_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./dist/esm/index-PZrWUcjo.js"),_renderStyles_EYVT9Efh_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./dist/esm/renderStyles-EYVT9Efh.js"),_calculatePosition_B4YLD_Og_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./dist/esm/calculatePosition-B4YLD_Og.js"),MapExtentLayer=_index_PZrWUcjo_js__WEBPACK_IMPORTED_MODULE_0__.l.LayerGroup.extend({initialize:function(options){_index_PZrWUcjo_js__WEBPACK_IMPORTED_MODULE_0__.l.LayerGroup.prototype.initialize.call(this,null,options),this._container=_index_PZrWUcjo_js__WEBPACK_IMPORTED_MODULE_0__.l.DomUtil.create("div","leaflet-layer"),this._extentEl=this.options.extentEl,this.changeOpacity(this.options.opacity),this.setZIndex(options.zIndex),_index_PZrWUcjo_js__WEBPACK_IMPORTED_MODULE_0__.l.DomUtil.addClass(this._container,"mapml-extentlayer-container")},getEvents:function(){return{zoomstart:this._onZoomStart}},_onZoomStart:function(){this.closePopup()},getContainer:function(){return this._container},onAdd:function(map){_index_PZrWUcjo_js__WEBPACK_IMPORTED_MODULE_0__.l.LayerGroup.prototype.onAdd.call(this,map),this.options.extentEl.parentLayer._layer._container.appendChild(this._container)},redraw:function(){this.eachLayer(function(layer){layer.redraw()})},setZIndex:function(zIndex){return this.options.zIndex=zIndex,this._updateZIndex(),this},_updateZIndex:function(){this._container&&void 0!==this.options.zIndex&&null!==this.options.zIndex&&(this._container.style.zIndex=this.options.zIndex)},onRemove:function(){_index_PZrWUcjo_js__WEBPACK_IMPORTED_MODULE_0__.l.LayerGroup.prototype.onRemove.call(this,this._map),_index_PZrWUcjo_js__WEBPACK_IMPORTED_MODULE_0__.l.DomUtil.remove(this._container)},_previousFeature:function(e){this._count+-1>=0&&(this._count--,this._map.fire("featurepagination",{i:this._count,popup:this}))},_nextFeature:function(e){this._count+1<this._source._totalFeatureCount&&(this._count++,this._map.fire("featurepagination",{i:this._count,popup:this}))},changeOpacity:function(opacity){this._container.style.opacity=opacity,this._extentEl._opacity=opacity,this._extentEl._opacitySlider&&(this._extentEl._opacitySlider.value=opacity)},renderStyles:_renderStyles_EYVT9Efh_js__WEBPACK_IMPORTED_MODULE_1__.r}),createLayerControlExtentHTML=function(){var extent=_index_PZrWUcjo_js__WEBPACK_IMPORTED_MODULE_0__.l.DomUtil.create("fieldset","mapml-layer-extent"),extentProperties=_index_PZrWUcjo_js__WEBPACK_IMPORTED_MODULE_0__.l.DomUtil.create("div","mapml-layer-item-properties",extent),extentSettings=_index_PZrWUcjo_js__WEBPACK_IMPORTED_MODULE_0__.l.DomUtil.create("div","mapml-layer-item-settings",extent),extentLabel=_index_PZrWUcjo_js__WEBPACK_IMPORTED_MODULE_0__.l.DomUtil.create("label","mapml-layer-item-toggle",extentProperties),input=_index_PZrWUcjo_js__WEBPACK_IMPORTED_MODULE_0__.l.DomUtil.create("input"),svgExtentControlIcon=_index_PZrWUcjo_js__WEBPACK_IMPORTED_MODULE_0__.l.SVG.create("svg"),extentControlPath1=_index_PZrWUcjo_js__WEBPACK_IMPORTED_MODULE_0__.l.SVG.create("path"),extentControlPath2=_index_PZrWUcjo_js__WEBPACK_IMPORTED_MODULE_0__.l.SVG.create("path"),extentNameIcon=_index_PZrWUcjo_js__WEBPACK_IMPORTED_MODULE_0__.l.DomUtil.create("span"),extentItemControls=_index_PZrWUcjo_js__WEBPACK_IMPORTED_MODULE_0__.l.DomUtil.create("div","mapml-layer-item-controls",extentProperties),opacityControl=_index_PZrWUcjo_js__WEBPACK_IMPORTED_MODULE_0__.l.DomUtil.create("details","mapml-layer-item-details mapml-control-layers",extentSettings),extentOpacitySummary=_index_PZrWUcjo_js__WEBPACK_IMPORTED_MODULE_0__.l.DomUtil.create("summary","",opacityControl),mapEl=this.getMapEl(),layerEl=this.getLayerEl(),opacity=_index_PZrWUcjo_js__WEBPACK_IMPORTED_MODULE_0__.l.DomUtil.create("input","",opacityControl);extentSettings.hidden=!0,extent.setAttribute("aria-grabbed","false"),svgExtentControlIcon.setAttribute("viewBox","0 0 24 24"),svgExtentControlIcon.setAttribute("height","22"),svgExtentControlIcon.setAttribute("width","22"),extentControlPath1.setAttribute("d","M0 0h24v24H0z"),extentControlPath1.setAttribute("fill","none"),extentControlPath2.setAttribute("d","M12 8c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zm0 2c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm0 6c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z"),svgExtentControlIcon.appendChild(extentControlPath1),svgExtentControlIcon.appendChild(extentControlPath2);let mapSelects=this.el.querySelectorAll("map-select");if(mapSelects.length){for(var frag=document.createDocumentFragment(),i=0;i<mapSelects.length;i++)frag.appendChild(mapSelects[i].selectdetails);extentSettings.appendChild(frag)}let removeExtentButton=_index_PZrWUcjo_js__WEBPACK_IMPORTED_MODULE_0__.l.DomUtil.create("button","mapml-layer-item-remove-control",extentItemControls);removeExtentButton.type="button",removeExtentButton.title=mapEl.locale.lmRemoveExtent,removeExtentButton.innerHTML="<span aria-hidden='true'>&#10005;</span>",removeExtentButton.classList.add("mapml-button"),removeExtentButton.addEventListener("click",e=>{e.preventDefault(),e.stopPropagation(),this.el.remove()});let extentsettingsButton=_index_PZrWUcjo_js__WEBPACK_IMPORTED_MODULE_0__.l.DomUtil.create("button","mapml-layer-item-settings-control",extentItemControls);extentsettingsButton.type="button",extentsettingsButton.title=mapEl.locale.lmExtentSettings,extentsettingsButton.setAttribute("aria-expanded",!1),extentsettingsButton.classList.add("mapml-button"),_index_PZrWUcjo_js__WEBPACK_IMPORTED_MODULE_0__.l.DomEvent.on(extentsettingsButton,"click",e=>{!0===extentSettings.hidden?(extentsettingsButton.setAttribute("aria-expanded",!0),extentSettings.hidden=!1):(extentsettingsButton.setAttribute("aria-expanded",!1),extentSettings.hidden=!0)},this),extentNameIcon.setAttribute("aria-hidden",!0),extentLabel.appendChild(input),extentsettingsButton.appendChild(extentNameIcon),extentNameIcon.appendChild(svgExtentControlIcon),extentOpacitySummary.innerText=mapEl.locale.lcOpacity,extentOpacitySummary.id="mapml-extent-item-opacity-"+_index_PZrWUcjo_js__WEBPACK_IMPORTED_MODULE_0__.l.stamp(extentOpacitySummary),opacity.setAttribute("type","range"),opacity.setAttribute("min","0"),opacity.setAttribute("max","1.0"),opacity.setAttribute("step","0.1"),opacity.setAttribute("aria-labelledby","mapml-extent-item-opacity-"+_index_PZrWUcjo_js__WEBPACK_IMPORTED_MODULE_0__.l.stamp(extentOpacitySummary));opacity.setAttribute("value",this.opacity),opacity.value=this._extentLayer._container.style.opacity||"1.0",opacity.addEventListener("change",function(e){e&&e.target&&e.target.value>=0&&e.target.value<=1&&this._extentLayer.changeOpacity(e.target.value)}.bind(this));var extentItemNameSpan=_index_PZrWUcjo_js__WEBPACK_IMPORTED_MODULE_0__.l.DomUtil.create("span","mapml-extent-item-name",extentLabel);input.type="checkbox",input.defaultChecked=this.checked,extentItemNameSpan.innerHTML=this.label;return this._layerControlCheckbox=input,input.addEventListener("change",function(){this.checked=!this.checked,this.el.dispatchEvent(new CustomEvent("map-change"))}.bind(this)),extentItemNameSpan.id="mapml-extent-item-name-{"+_index_PZrWUcjo_js__WEBPACK_IMPORTED_MODULE_0__.l.stamp(extentItemNameSpan)+"}",extent.setAttribute("aria-labelledby",extentItemNameSpan.id),extentItemNameSpan.extent=this.el,extent.ontouchstart=extent.onmousedown=downEvent=>{if("label"===downEvent.target.parentElement.tagName.toLowerCase()&&"input"!==downEvent.target.tagName.toLowerCase()||"label"===downEvent.target.tagName.toLowerCase()){downEvent.stopPropagation(),downEvent=downEvent instanceof TouchEvent?downEvent.touches[0]:downEvent;let control=extent,controls=extent.parentNode,moving=!1,yPos=downEvent.clientY,originalPosition=Array.from(extent.parentElement.querySelectorAll("fieldset")).indexOf(extent);document.body.ontouchmove=document.body.onmousemove=moveEvent=>{moveEvent.preventDefault();let offset=(moveEvent=moveEvent instanceof TouchEvent?moveEvent.touches[0]:moveEvent).clientY-yPos;if(moving=Math.abs(offset)>15||moving,controls&&!moving||controls&&controls.childElementCount<=1||controls.getBoundingClientRect().top>control.getBoundingClientRect().bottom||controls.getBoundingClientRect().bottom<control.getBoundingClientRect().top)return;controls.classList.add("mapml-draggable"),control.style.transform="translateY("+offset+"px)",control.style.pointerEvents="none";let x=moveEvent.clientX,y=moveEvent.clientY,elementAt=("GCDS-MAP"===mapEl.tagName?mapEl.shadowRoot:mapEl.querySelector(".mapml-web-map").shadowRoot).elementFromPoint(x,y),swapControl=elementAt&&elementAt.closest("fieldset")?elementAt.closest("fieldset"):control;swapControl=Math.abs(offset)<=swapControl.offsetHeight?control:swapControl,control.setAttribute("aria-grabbed","true"),control.setAttribute("aria-dropeffect","move"),swapControl&&controls===swapControl.parentNode&&(swapControl=swapControl!==control.nextSibling?swapControl:swapControl.nextSibling,control!==swapControl&&(yPos=moveEvent.clientY,control.style.transform=null),controls.insertBefore(control,swapControl))},document.body.ontouchend=document.body.onmouseup=()=>{let newPosition=Array.from(extent.parentElement.querySelectorAll("fieldset")).indexOf(extent);if(control.setAttribute("aria-grabbed","false"),control.removeAttribute("aria-dropeffect"),control.style.pointerEvents=null,control.style.transform=null,originalPosition!==newPosition){let controlsElems=controls.children,zIndex=0;for(let c of controlsElems){let extentEl=c.querySelector("span").extent;extentEl.setAttribute("data-moving","");(layerEl.src?layerEl.shadowRoot:layerEl).append(extentEl),extentEl.removeAttribute("data-moving"),extentEl.extentZIndex=zIndex,extentEl._extentLayer.setZIndex(zIndex),zIndex++}}controls.classList.remove("mapml-draggable"),document.body.ontouchmove=document.body.onmousemove=document.body.ontouchend=document.body.onmouseup=null}}},this._extentRootFieldset=extent,this._opacitySlider=opacity,this._opacityControl=opacityControl,this._layerControlLabel=extentLabel,extent};const GcdsMapExtent=class{constructor(hostRef){(0,_index_PZrWUcjo_js__WEBPACK_IMPORTED_MODULE_0__.r)(this,hostRef)}get el(){return(0,_index_PZrWUcjo_js__WEBPACK_IMPORTED_MODULE_0__.a)(this)}checked=!1;_label;opacity=1;_opacity;hidden=!1;units;disabled=!1;get label(){return this._label||this.mapEl?.locale?.dfExtent||"Sub-layer"}get opacityValue(){return this._opacity??this.opacity??1}mapEl;parentLayer;_map;_extentLayer;_layerControlHTML;_layerControlCheckbox;_layerControlLabel;_opacityControl;_opacitySlider;_selectdetails;_observer;_changeHandler;_boundsCalculated=!1;unitsChanged(newValue,oldValue){}labelChanged(){this._layerControlHTML&&(this._layerControlHTML.querySelector(".mapml-extent-item-name").textContent=this.label)}checkedChanged(){this.parentLayer&&this._extentLayer&&this.parentLayer.whenReady().then(()=>{this._handleChange(),this._calculateBounds(),this._layerControlCheckbox&&(this._layerControlCheckbox.checked=this.checked)}).catch(error=>{console.log("Error while waiting on parentLayer for map-extent checked callback: "+error)})}opacityChanged(newValue,oldValue){oldValue!==newValue&&this._extentLayer&&(this._opacity=newValue,this._extentLayer.changeOpacity(newValue),this._opacitySlider&&(this._opacitySlider.value=newValue.toString()))}hiddenChanged(newValue,oldValue){oldValue!==newValue&&this._extentLayer&&this._layerControlHTML&&this._applyHiddenState(newValue)}_applyHiddenState(isHidden){this._extentLayer&&this._layerControlHTML&&this.parentLayer&&this.parentLayer.whenReady().then(()=>{let extentsRootFieldset=this.parentLayer._propertiesGroupAnatomy;let position=(this.parentLayer.src?Array.from(this.parentLayer.shadowRoot.querySelectorAll(":host > map-extent")):Array.from(this.parentLayer.querySelectorAll(":scope > map-extent"))).filter(extent=>!extent.hidden).indexOf(this.el);isHidden?this._layerControlHTML.remove():0===position?extentsRootFieldset.insertAdjacentElement("afterbegin",this._layerControlHTML):position>0&&Array.from(this.parentLayer.src?this.parentLayer.shadowRoot.querySelectorAll(":host > map-extent:not([hidden])"):this.parentLayer.querySelectorAll(":scope > map-extent:not([hidden])"))[position-1]._layerControlHTML.insertAdjacentElement("afterend",this._layerControlHTML),this._validateLayerControlContainerHidden()}).catch(()=>{console.log("Error while waiting on parentLayer for map-extent hidden callback")})}get extent(){const getExtent=extent=>Object.assign(_index_PZrWUcjo_js__WEBPACK_IMPORTED_MODULE_0__.U._convertAndFormatPCRS(extent._extentLayer.bounds,M[extent.units],extent.units),{zoom:extent._extentLayer.zoomBounds});return this._extentLayer.bounds?getExtent(this):((extent=this)._calculateBounds(),getExtent(extent));var extent}get position(){return(0,_calculatePosition_B4YLD_Og_js__WEBPACK_IMPORTED_MODULE_2__.c)(this.el)}getOuterHTML(){let tempElement=this.el.cloneNode(!0);if(this.el.querySelector("map-link")){tempElement.querySelectorAll("map-link").forEach(mapLink=>{mapLink.hasAttribute("href")?mapLink.setAttribute("href",decodeURI(new URL(mapLink.getAttribute("href"),this.el.baseURI?this.el.baseURI:document.baseURI).href)):mapLink.hasAttribute("tref")&&mapLink.setAttribute("tref",decodeURI(new URL(mapLink.getAttribute("tref"),this.el.baseURI?this.el.baseURI:document.baseURI).href))})}let outerLayer=tempElement.outerHTML;return tempElement.remove(),outerLayer}zoomTo(){let extent=this.extent,map=this.getMapEl()._map,xmin=extent.topLeft.pcrs.horizontal,xmax=extent.bottomRight.pcrs.horizontal,ymin=extent.bottomRight.pcrs.vertical,ymax=extent.topLeft.pcrs.vertical,bounds=_index_PZrWUcjo_js__WEBPACK_IMPORTED_MODULE_0__.l.bounds(_index_PZrWUcjo_js__WEBPACK_IMPORTED_MODULE_0__.l.point(xmin,ymin),_index_PZrWUcjo_js__WEBPACK_IMPORTED_MODULE_0__.l.point(xmax,ymax)),center=map.options.crs.unproject(bounds.getCenter(!0)),maxZoom=extent.zoom.maxZoom,minZoom=extent.zoom.minZoom;map.setView(center,_index_PZrWUcjo_js__WEBPACK_IMPORTED_MODULE_0__.U.getMaxZoom(bounds,map,minZoom,maxZoom),{animate:!1})}getMapEl(){return _index_PZrWUcjo_js__WEBPACK_IMPORTED_MODULE_0__.U.getClosest(this.el,"gcds-map")}getLayerEl(){return _index_PZrWUcjo_js__WEBPACK_IMPORTED_MODULE_0__.U.getClosest(this.el,"map-layer,layer-")}async connectedCallback(){if(this._opacity=this.opacityValue,this._changeHandler=this._handleChange.bind(this),this.parentLayer=this.el.parentLayer=this.getLayerEl(),this.el.hasAttribute("data-moving")||this.parentLayer?.hasAttribute("data-moving"))return;if(this.mapEl=this.getMapEl(),this.el.getMapEl=this.getMapEl.bind(this),this.el.getLayerEl=this.getLayerEl.bind(this),this.el.getLayerControlHTML=this.getLayerControlHTML.bind(this),this.el.zoomTo=this.zoomTo.bind(this),this.el._validateDisabled=this._validateDisabled.bind(this),this.el.getMeta=this.getMeta.bind(this),this.el.getOuterHTML=this.getOuterHTML.bind(this),Object.defineProperty(this.el,"_boundsCalculated",{get:()=>this._boundsCalculated,configurable:!0,enumerable:!0}),Object.defineProperty(this.el,"extent",{get:()=>this.extent,configurable:!0}),Object.defineProperty(this.el,"label",{get:()=>this.el.hasAttribute("label")?this.el.getAttribute("label"):this.mapEl?.locale?.dfExtent||"Sub-layer",set:val=>{val&&(this.el.setAttribute("label",val),this._label=val)},configurable:!0}),this.el.hasAttribute("label")&&(this._label=this.el.getAttribute("label")),!this.mapEl)return;if(await this.mapEl.whenProjectionDefined(this.units).catch(()=>{throw new Error("Undefined projection:"+this.units)}),!this.el.isConnected)return;var options;await this.mapEl.whenReady(),this._map=this.mapEl._map,this.parentLayer?.addEventListener("map-change",this._changeHandler),this.mapEl.addEventListener("map-projectionchange",this._changeHandler),this._extentLayer=(options={opacity:this.opacityValue,crs:M[this.units],zIndex:this.position,extentEl:this.el},new MapExtentLayer(options)),this.el._extentLayer=this._extentLayer;const layerControlHTML=createLayerControlExtentHTML.call(this);this._layerControlHTML=layerControlHTML,this.el._layerControlHTML=layerControlHTML,this.el._layerControlLabel=this._layerControlLabel,this.el._layerControlCheckbox=this._layerControlCheckbox,this.el._opacityControl=this._opacityControl,this.el._opacitySlider=this._opacitySlider,this.el._selectdetails=this._selectdetails,await this._waitForTrefLinks(),this._calculateBounds(),this._handleChange(),this._runMutationObserver(this.el.children),this._bindMutationObserver()}_bindMutationObserver(){this._observer=new MutationObserver(mutationList=>{for(let mutation of mutationList)"attributes"===mutation.type&&"label"===mutation.attributeName&&(this.el.hasAttribute("label")||(this._label=this.mapEl?.locale?.dfExtent||"Sub-layer")),"childList"===mutation.type&&this._runMutationObserver(mutation.addedNodes)}),this._observer.observe(this.el,{childList:!0,attributes:!0,attributeFilter:["label"]})}_runMutationObserver(elementsGroup){const _addMetaElement=_mapMeta=>{this.whenReady().then(()=>{this._calculateBounds(),this._validateDisabled()})},_addStylesheetLink=mapLink=>{this.whenReady().then(()=>{this._extentLayer.renderStyles(mapLink)})},_addStyleElement=mapStyle=>{this.whenReady().then(()=>{this._extentLayer.renderStyles(mapStyle)})};for(let i=0;i<elementsGroup.length;++i){let element=elementsGroup[i];switch(element.nodeName){case"MAP-META":element.hasAttribute("name")&&("zoom"===element.getAttribute("name").toLowerCase()||"extent"===element.getAttribute("name").toLowerCase())&&element.hasAttribute("content")&&_addMetaElement();break;case"MAP-LINK":element.link&&!element.link.isConnected&&_addStylesheetLink(element);break;case"MAP-STYLE":element.styleElement&&!element.styleElement.isConnected&&_addStyleElement(element)}}}getLayerControlHTML(){return this._layerControlHTML}_projectionMatch(){return this.units.toUpperCase()===this._map.options.projection.toUpperCase()}_validateDisabled(){if(!this._extentLayer)return;let templates=this.el.querySelectorAll("map-link[rel=image],map-link[rel=tile],map-link[rel=features],map-link[rel=query]");return!this._projectionMatch()||(()=>{let totalTemplateCount=templates.length,disabledTemplateCount=0;for(let j=0;j<templates.length;j++)templates[j].isVisible()||disabledTemplateCount++;return disabledTemplateCount===totalTemplateCount})()?(this.el.setAttribute("disabled",""),this.disabled=!0):(this.el.removeAttribute("disabled"),this.disabled=!1),this.toggleLayerControlDisabled(),this._handleChange(),this.disabled}getMeta(metaName){let name=metaName.toLowerCase();if("extent"===name||"zoom"===name||"cs"===name)return this.parentLayer.src?this.el.querySelector(`:scope > map-meta[name=${name}]`)||this.parentLayer.shadowRoot.querySelector(`:host > map-meta[name=${name}]`):this.el.querySelector(`:scope > map-meta[name=${name}]`)||this.parentLayer.querySelector(`:scope > map-meta[name=${name}]`)}toggleLayerControlDisabled(){let input=this._layerControlCheckbox,label=this._layerControlLabel,opacityControl=this._opacityControl,opacitySlider=this._opacitySlider,selectDetails=this._selectdetails;this.disabled?(input.disabled=!0,opacitySlider.disabled=!0,label.style.fontStyle="italic",opacityControl.style.fontStyle="italic",selectDetails&&selectDetails.forEach(i=>{i.querySelectorAll("select").forEach(j=>{j.disabled=!0,j.style.fontStyle="italic"}),i.style.fontStyle="italic"})):(input.disabled=!1,opacitySlider.disabled=!1,label.style.fontStyle="normal",opacityControl.style.fontStyle="normal",selectDetails&&selectDetails.forEach(i=>{i.querySelectorAll("select").forEach(j=>{j.disabled=!1,j.style.fontStyle="normal"}),i.style.fontStyle="normal"}))}_handleChange(){this.checked&&!this.disabled&&this.parentLayer._layer?(this._extentLayer.addTo(this.parentLayer._layer),this._extentLayer.setZIndex(this.position)):this.parentLayer._layer?.removeLayer(this._extentLayer)}_validateLayerControlContainerHidden(){let extentsFieldset=this.parentLayer._propertiesGroupAnatomy;if(!extentsFieldset)return;0===(this.parentLayer.src?Array.from(this.parentLayer.shadowRoot.querySelectorAll(":host > map-extent")):Array.from(this.parentLayer.querySelectorAll(":scope > map-extent"))).filter(extent=>!extent.hidden).length?extentsFieldset.setAttribute("hidden",""):extentsFieldset.removeAttribute("hidden")}disconnectedCallback(){this.el.hasAttribute("data-moving")||this.parentLayer?.hasAttribute("data-moving")||!this._extentLayer||(this._validateLayerControlContainerHidden(),this._layerControlHTML&&this._layerControlHTML.remove(),this.parentLayer?._layer&&this.parentLayer._layer.removeLayer(this._extentLayer),this.parentLayer&&this.parentLayer.removeEventListener("map-change",this._changeHandler),this.mapEl&&this.mapEl.removeEventListener("map-projectionchange",this._changeHandler),this._boundsCalculated=!1,delete this._extentLayer,this.parentLayer?._layer&&delete this.parentLayer._layer.bounds)}async _waitForTrefLinks(){const templates=this.el.querySelectorAll("map-link[rel=image][tref],map-link[rel=tile][tref],map-link[rel=features][tref],map-link[rel=query][tref]"),linksVarsReady=[];for(let link of Array.from(templates))linksVarsReady.push(new Promise(resolve=>{if(link._templateVars)resolve();else{const checkInterval=setInterval(()=>{link._templateVars&&(clearInterval(checkInterval),resolve())},10);setTimeout(()=>{clearInterval(checkInterval),resolve()},1e3)}}));return Promise.all(linksVarsReady)}_calculateBounds(){delete this._extentLayer.bounds,delete this._extentLayer.zoomBounds,this.parentLayer._layer&&delete this.parentLayer._layer.bounds;let templates=this.el.querySelectorAll("map-link[rel=image]:not([disabled]),map-link[rel=tile]:not([disabled]),map-link[rel=features]:not([disabled]),map-link[rel=query]:not([disabled])"),bounds=this.el.querySelector(":scope > map-meta[name=extent][content]")?_index_PZrWUcjo_js__WEBPACK_IMPORTED_MODULE_0__.U.getBoundsFromMeta(this.el):void 0,zoomBounds=this.el.querySelector(":scope > map-meta[name=zoom][content]")?_index_PZrWUcjo_js__WEBPACK_IMPORTED_MODULE_0__.U.getZoomBoundsFromMeta(this.el):void 0;for(let j=0;j<templates.length;j++){const templateZoomBounds=templates[j].getZoomBounds(),templateBounds=templates[j].getBounds();let zoomMax=zoomBounds&&zoomBounds.hasOwnProperty("maxZoom")?zoomBounds.maxZoom:-1/0,zoomMin=zoomBounds&&zoomBounds.hasOwnProperty("minZoom")?zoomBounds.minZoom:1/0,minNativeZoom=zoomBounds&&zoomBounds.hasOwnProperty("minNativeZoom")?zoomBounds.minNativeZoom:1/0,maxNativeZoom=zoomBounds&&zoomBounds.hasOwnProperty("maxNativeZoom")?zoomBounds.maxNativeZoom:-1/0;zoomBounds?(zoomMax=Math.max(zoomMax,templateZoomBounds.maxZoom),zoomMin=Math.min(zoomMin,templateZoomBounds.minZoom),maxNativeZoom=Math.max(maxNativeZoom,templateZoomBounds.maxNativeZoom),minNativeZoom=Math.min(minNativeZoom,templateZoomBounds.minNativeZoom),zoomBounds.minZoom=zoomMin,zoomBounds.maxZoom=zoomMax,zoomBounds.minNativeZoom=minNativeZoom,zoomBounds.maxNativeZoom=maxNativeZoom):zoomBounds=Object.assign({},templateZoomBounds),bounds?bounds.extend(templateBounds):bounds=_index_PZrWUcjo_js__WEBPACK_IMPORTED_MODULE_0__.l.bounds(templateBounds.min,templateBounds.max)}this._extentLayer.bounds=bounds||_index_PZrWUcjo_js__WEBPACK_IMPORTED_MODULE_0__.l.bounds(M[this.units].options.bounds.min,M[this.units].options.bounds.max),zoomBounds||(zoomBounds={}),zoomBounds.hasOwnProperty("minZoom")||(zoomBounds.minZoom=0),zoomBounds.hasOwnProperty("maxZoom")||(zoomBounds.maxZoom=M[this.units].options.resolutions.length-1),zoomBounds.hasOwnProperty("minNativeZoom")&&zoomBounds.minNativeZoom!==1/0||(zoomBounds.minNativeZoom=zoomBounds.minZoom),zoomBounds.hasOwnProperty("maxNativeZoom")&&zoomBounds.maxNativeZoom!==-1/0||(zoomBounds.maxNativeZoom=zoomBounds.maxZoom),this._extentLayer.zoomBounds=zoomBounds,this._boundsCalculated=!0}async whenReady(){return new Promise((resolve,reject)=>{let interval,failureTimer;if(this._extentLayer&&this._boundsCalculated)resolve();else{let extentElement=this.el;interval=setInterval(function testForExtent(extentElement){extentElement._extentLayer&&extentElement._boundsCalculated?(clearInterval(interval),clearTimeout(failureTimer),resolve()):extentElement.isConnected||(clearInterval(interval),clearTimeout(failureTimer),reject("map-extent was disconnected while waiting to be ready"))},300,extentElement),failureTimer=setTimeout(function extentNotDefined(){clearInterval(interval),clearTimeout(failureTimer),reject("Timeout reached waiting for extent to be ready")},1e4)}})}render(){return null}async whenLinksReady(){let templates=this.el.querySelectorAll("map-link[rel=image],map-link[rel=tile],map-link[rel=features],map-link[rel=query]"),linksReady=[];for(let link of Array.from(templates))linksReady.push(link.whenReady());return Promise.allSettled(linksReady)}static get watchers(){return{units:["unitsChanged"],_label:["labelChanged"],checked:["checkedChanged"],_opacity:["opacityChanged"],hidden:["hiddenChanged"]}}}},"./dist/esm/renderStyles-EYVT9Efh.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{function renderStyles(mapStyleOrLink){let e=mapStyleOrLink.link||mapStyleOrLink.styleElement;if(void 0===e)return;let positionAndNode=(styleOrLink=>{const renderedSiblingStyles=Array.from(this._container.querySelectorAll(':scope > style, :scope > link[rel="stylesheet"]'));if(0===renderedSiblingStyles.length){const lastChild=this._container.lastChild;if(!lastChild)return{position:"afterbegin",node:this._container};const isSVG="SVG"===lastChild.nodeName,isContainer=lastChild.classList?.contains("mapml-vector-container")||lastChild.classList?.contains("mapml-extentlayer-container");return isSVG||isContainer?{position:"beforebegin",node:lastChild}:{position:"afterend",node:lastChild}}const mapStyleOrLinkLightDOMElement=styleOrLink.mapStyle||styleOrLink.mapLink;for(let i=0;i<renderedSiblingStyles.length;i++){const rendered=renderedSiblingStyles[i],siblingMapStyleOrLinkLightDOMElement=rendered.mapStyle||rendered.mapLink;if(siblingMapStyleOrLinkLightDOMElement&&mapStyleOrLinkLightDOMElement.compareDocumentPosition(siblingMapStyleOrLinkLightDOMElement)&Node.DOCUMENT_POSITION_FOLLOWING)return{position:"beforebegin",node:rendered}}return{position:"afterend",node:renderedSiblingStyles.at(-1)}})(e);positionAndNode.node.insertAdjacentElement(positionAndNode.position,e)}__webpack_require__.d(__webpack_exports__,{r:()=>renderStyles})}}]);